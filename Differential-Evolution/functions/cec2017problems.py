import numpy as np
from .Problem import Problem, ProblemType

D = 10

def generate_z_y(x, o, transformation=None, M=None):
    z = (x - o)
    if transformation == 'matrix_multiply' and M is not None:
        z = z @ M
    return np.array(z)

class CEC2017_C01(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592, -16.020692917610326, -34.267350135311162, -45.818112100198249, -18.079781146775243, 
        25.725679048043332, 24.716563914686589, 11.215719489129484, -12.136617112504744, -0.91550666086484256, 
        23.405309685666367, -31.464706528498521, -9.06629948907689, 5.735014631024718, 15.684166985022358, 
        -21.582473506193789, -43.370231388367621, 3.3536321750831348, 31.145333372275815, -29.903950910062715, 
        25.432689218671413, -18.673929717145011, 19.749230950200896, -24.427524021542226, 30.311237701994003, 
        7.076420612654921, -12.416416702879438, 31.724833079820385, -35.954704233854685, -34.300512149773809, 
        -5.9501902906060025, 41.633903368265251, 17.880178744710136, 3.6479735089184686, 10.70598804447733, 
        34.177601670123309, 23.693053658446743, 24.64509163313538, 34.380647111988964, -36.113746587886219, 
        28.479536099789854, -2.8437285416851736, 28.299856687594684, 21.010323185159891, 1.8454631264885109, 
        15.163578553120118, -5.468721733268467, 39.686700656645954, 11.713552353181925, -49.411074064536145, 
        20.73509620007701, 48.02637624118276, -42.797551152511929, -26.788215696783968, 26.485761855232326, 
        30.412375264745478, 37.742664518085419, -46.263940651260718, -18.394561484651462, -22.6840915345336, 
        37.519052419027616, 7.85553615152498, 19.268122804472299, -42.025610855963201, 48.963074725286219, 
        24.612810952743516, 40.580184957725933, 44.023668523295484, -45.318799810687793, -12.550216143748003, 
        13.795953243048906, -2.560425301742562, -40.837884746803496, -3.0298821975606955, 25.90618078359762, 
        -29.640447098043065, -20.365609406782902, -10.325012084775423, 45.273418211673359, -9.8401862971605, 
        -11.111510188972318, -18.23645637792799, -48.790684200485124, -32.308551080178148, 49.064789560759863, 
        -9.465411990247873, -17.026296952973588, 48.4447469425739, -44.03309804392174, -7.477364041826121, 
        13.3178878551537, 46.975449202092449, 23.824664552440993, 27.203921579109263, 26.77428516659927, 
        14.661678487900176, 4.063552233376214, -3.1061167265637906, -21.226342098590976, 49.804618432177662
    ])
    
    def __init__(self):
        
        rest_h = []
        rest_g = [self.CEC2017_C01_g1]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.sum([(np.sum(z[:i+1]))**2 for i in range(D)])
        return f_x
    
    @staticmethod
    def CEC2017_C01_g1(x):
        z = generate_z_y(x, CEC2017_C01.o[:D])
        return np.sum(z**2 - 5000 * np.cos(0.1 * np.pi * z) - 4000)

class CEC2017_C02(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592, -16.020692917610326, -34.267350135311162, -45.818112100198249, -18.079781146775243, 
        25.725679048043332, 24.716563914686589, 11.215719489129484, -12.136617112504744, -0.91550666086484256, 
        23.405309685666367, -31.464706528498521, -9.06629948907689, 5.735014631024718, 15.684166985022358, 
        -21.582473506193789, -43.370231388367621, 3.3536321750831348, 31.145333372275815, -29.903950910062715, 
        25.432689218671413, -18.673929717145011, 19.749230950200896, -24.427524021542226, 30.311237701994003, 
        7.076420612654921, -12.416416702879438, 31.724833079820385, -35.954704233854685, -34.300512149773809, 
        -5.9501902906060025, 41.633903368265251, 17.880178744710136, 3.6479735089184686, 10.70598804447733, 
        34.177601670123309, 23.693053658446743, 24.64509163313538, 34.380647111988964, -36.113746587886219, 
        28.479536099789854, -2.8437285416851736, 28.299856687594684, 21.010323185159891, 1.8454631264885109, 
        15.163578553120118, -5.468721733268467, 39.686700656645954, 11.713552353181925, -49.411074064536145, 
        20.73509620007701, 48.02637624118276, -42.797551152511929, -26.788215696783968, 26.485761855232326, 
        30.412375264745478, 37.742664518085419, -46.263940651260718, -18.394561484651462, -22.6840915345336, 
        37.519052419027616, 7.85553615152498, 19.268122804472299, -42.025610855963201, 48.963074725286219, 
        24.612810952743516, 40.580184957725933, 44.023668523295484, -45.318799810687793, -12.550216143748003, 
        13.795953243048906, -2.560425301742562, -40.837884746803496, -3.0298821975606955, 25.90618078359762, 
        -29.640447098043065, -20.365609406782902, -10.325012084775423, 45.273418211673359, -9.8401862971605, 
        -11.111510188972318, -18.23645637792799, -48.790684200485124, -32.308551080178148, 49.064789560759863, 
        -9.465411990247873, -17.026296952973588, 48.4447469425739, -44.03309804392174, -7.477364041826121, 
        13.3178878551537, 46.975449202092449, 23.824664552440993, 27.203921579109263, 26.77428516659927, 
        14.661678487900176, 4.063552233376214, -3.1061167265637906, -21.226342098590976, 49.804618432177662
    ])
    M10 = np.array([
        [-1.47506916, -0.5745205 , -0.00569977,  0.66482107, -0.10416346,
            -0.89788553, -0.9019942 , -0.60653241, -0.40632512,  0.15528244],
        [ 0.55921502,  0.04993663,  0.42157151,  0.86580267,  0.69479045,
            -0.18507116, -0.0221887 , -0.64921887,  0.07356092, -0.79611763],
        [ 0.6352999 ,  0.59435041,  1.10325388, -1.12851898,  0.70464944,
            0.27557575, -1.03996692,  0.11685699, -0.32902335,  0.07790036],
        [-0.35941283,  0.37082705, -0.52710465, -0.26665594, -0.51419772,
            0.5821194 , -0.04729926, -0.46312553, -0.1019633 , -0.95226395],
        [-0.58397201,  1.77148766,  0.01365008,  0.32122256,  0.79042812,
            0.40939239,  0.33744753,  0.59421282, -0.1548053 , -0.52376858],
        [-0.17838597,  0.24992501, -0.17316389, -0.00503656, -0.17668981,
            0.28238696, -1.09465107,  0.45147932,  1.05740556, -0.0074877 ],
        [-0.59132431, -0.27049755, -0.31303893,  0.63763039,  1.27416447,
            0.78112123,  0.18207116, -0.05528507,  0.27980292,  0.05572709],
        [-0.20277429,  1.00793042,  0.01437319,  0.14803053,  0.45096233,
            -0.5822593 ,  0.45211599, -0.87080363,  0.43575309,  0.36516934],
        [-0.90266896,  0.17486172, -0.27450551, -0.36615474,  0.60323483,
            -0.76235455,  0.9197863 , -0.06739962,  0.53299604, -0.94985707],
        [ 0.38090137,  0.82704718, -0.92975982, -0.57094242,  1.01588778,
            -0.39993664, -0.74071738,  0.40730998, -0.37080889, -0.19351407]])
    M30 = np.array([
        [-0.51598288, -0.4617526 , -0.47478431,  0.30906473,  0.08210925,
            0.12399426, -0.27213943, -0.6066295 ,  0.77783934, -0.05737011,
            -0.0978952 ,  0.17520767,  0.15816791,  0.11980962, -0.46815355,
            -0.36208696, -0.48862551,  0.23469981,  0.6450257 ,  0.49857302,
            0.06300037,  0.57667297,  0.09346707, -0.08820711,  0.88053384,
            0.37503612,  0.48038544,  0.60749043, -0.06333769, -0.44730036],
        [ 0.18807549, -0.2720272 ,  0.18695121,  0.04389839, -0.23549495,
            -0.61637394,  0.06050046,  0.26760857,  0.52594783,  0.77204942,
            0.21960697,  0.15824113,  0.29701513, -0.20379644,  0.64157216,
            -0.41814864,  0.22926624,  0.06124198,  0.06791074, -0.0323193 ,
            0.2629264 , -0.64801988,  0.28101037,  0.14392793, -0.00452892,
            -0.00593095,  0.13708108,  0.49689598, -0.10313185, -0.08945289],
        [ 0.0867786 , -0.13415841,  0.52772804,  0.74781224, -0.31257939,
            0.38174655,  0.01918753, -0.02240432, -0.56729891,  0.54923546,
            0.03655749, -0.3992565 ,  0.37829778, -0.2512456 , -0.328895  ,
            0.04626444, -0.17471382, -0.65084165, -0.26557166,  0.12686869,
            -0.77526323,  0.3580039 , -0.1281803 ,  0.32101909,  0.15687161,
            0.13220017, -0.49611842, -0.16172585, -0.21068272,  0.06731165],
        [-0.07252812,  0.03923364, -0.08451737,  0.91156902,  0.27124084,
            0.10678489,  0.35154106, -0.10959241, -0.35674242, -0.05139207,
            -0.64587233, -0.1789498 , -0.0792819 , -0.55349777, -0.35666086,
            -0.87757177,  0.1069956 , -0.29621525,  0.28338354, -0.5383564 ,
            0.27034197, -0.16167943,  0.51635999, -0.5075464 , -0.42222756,
            -0.15230823,  0.3179043 ,  0.15263148,  0.31867607, -0.00785143],
        [-0.3108506 ,  0.10773534,  0.21073658, -0.10389715,  0.50068114,
            0.6623147 ,  0.18396874,  0.46170166, -0.52072892, -0.45936203,
            0.22489911,  0.56806045,  0.35803882, -0.59721462, -0.10433733,
            -0.01433436,  0.21368454,  0.02439188,  0.23838452,  0.80039157,
            0.1787257 , -0.59905164,  0.07468654, -0.11529658, -0.08040488,
            -0.15763219,  0.04591979,  0.32553372,  0.03166728, -0.33177213],
        [ 0.28820489, -0.14256138, -0.01952116,  0.07084319, -0.09866229,
            -0.05483664,  0.24968096, -0.67278232,  0.45864235,  0.38407392,
            0.10221117,  0.62141372, -0.35242425, -0.51470092, -0.24324633,
            0.41179288, -0.31576287, -0.32913441,  0.12651934,  0.47878725,
            -0.14613756, -0.26570943, -0.00548571,  0.49740982, -0.74563858,
            0.237046  ,  0.31511894, -0.83876159, -0.38545467, -0.02297116],
        [-0.14020032, -0.46839634, -0.05914086, -0.11713501, -0.5481584 ,
            0.41490818, -0.48262149,  0.22391503, -0.09275195,  0.19345872,
            -0.63901357,  0.36082152,  0.71029488,  0.69547469,  0.240431  ,
            0.12588166, -0.21052279,  0.04474418,  0.52931826,  0.00418132,
            -0.0676141 , -0.21107664,  0.05833512,  0.00320202, -0.33456168,
            0.55245388, -0.37212756, -0.2637795 , -0.12107476,  0.34322663],
        [-0.71541653,  0.31528103,  0.01647641,  0.39882899, -0.14415438,
            -0.25005932, -0.16311946,  0.50673568, -0.15905605, -0.18667037,
            0.1290969 , -0.57770504,  0.38790819, -0.0345542 ,  0.25219983,
            0.25222759,  0.25097651,  0.21256365,  0.44068635, -0.07819612,
            0.07587133,  0.26321343, -0.64154403,  0.05124995, -0.17674144,
            -0.24246914, -0.33857185,  0.21483495, -0.32292559, -0.07199864],
        [-0.39160242, -0.1613453 ,  0.46555336, -0.33946236,  0.50313052,
            0.7314391 ,  0.12668835,  0.44419263, -0.28085937,  0.54179726,
            0.18439657, -0.35788259, -0.81939055, -0.10780915, -0.39656005,
            -0.27761678, -0.09398646,  0.4392856 ,  0.20775316, -0.60778851,
            -0.50230299, -0.13334657, -0.47768154,  0.17087315,  0.45435187,
            0.51002035,  0.09497498,  0.01973997, -0.00882871,  0.22328354],
        [-0.66107378,  0.21235973,  0.30368026,  0.20764505, -0.13615719,
            0.03281184,  0.45149372, -0.05486937,  0.21071412, -0.09345913,
            -0.16590689,  0.41299528,  0.4540514 ,  0.22801777, -0.6423805 ,
            -0.31985391,  0.71925247, -0.35221947, -0.56558377,  0.33414654,
            0.60682602, -0.025589  , -0.26337563,  0.00690392,  0.02778026,
            0.07485394,  0.50574363, -0.3667458 , -0.36471258,  0.7928235 ],
        [ 0.80655238, -0.36943762, -0.2131192 ,  0.4177849 ,  0.35019289,
            -0.18998622, -0.23301567,  0.31711876,  0.13703409, -0.37493463,
            -0.33730567, -0.16046637, -0.96436552,  0.24705779,  0.03645247,
            0.13329626, -0.05149119, -0.40643464, -0.16682554,  0.5730864 ,
            -0.03650358, -0.16833618, -0.35257988, -0.58531015, -0.36107628,
            0.25968848, -0.37031314,  0.31930255,  0.02776949,  0.15253503],
        [ 0.67924055, -0.18472385, -0.10861991, -0.0745163 ,  0.61754026,
            -0.61137445, -0.21621742,  0.08673952, -0.14078091, -0.00711175,
            -0.01919782,  0.06937789,  0.3699711 , -0.48185051, -0.18977606,
            -0.05232536,  0.06177396,  0.18012205, -0.11491007,  0.11009868,
            0.12117014, -0.06295978, -0.4698994 , -0.69821864, -0.02114939,
            -0.00356292, -0.29364473, -0.79798122,  0.27280829,  0.00689866],
        [-0.04316063,  0.57442052,  0.37533524,  0.1595968 ,  0.14843422,
            -0.43304577,  0.32557964, -0.34368984, -0.20653147,  0.06368473,
            0.38040753, -0.01459579,  0.38503727,  0.12731034, -0.29045275,
            -0.06237911, -0.40428656,  0.34902577,  0.25702327,  0.25949884,
            -0.8364189 , -0.14109747,  0.17775837, -0.05003925, -0.51241732,
            0.20853743, -0.1398348 ,  0.21706612, -0.02732066,  0.59196901],
        [ 0.57832133, -0.15456033,  0.42051822,  0.10676674,  0.37924534,
            0.48151775, -0.18666088, -0.34336566,  0.06489966,  0.40125368,
            0.41577131, -0.28374384,  0.37843487, -0.13105507, -0.23092611,
            0.27545407, -0.3875061 ,  0.00950271,  0.27630216, -0.4892882 ,
            0.26759687, -0.4809469 ,  0.34670145, -0.25254702, -0.15295805,
            -0.56759119,  0.76201472, -0.45262292, -0.57860798, -0.06323849],
        [-0.34283351, -0.67306363,  0.40405607, -0.59905247, -0.77822801,
            -0.13476955,  0.56040338, -0.20871972, -0.06885429,  0.1311777 ,
            0.2503727 ,  0.26225383, -0.14313507, -0.25335096, -0.44074386,
            0.03825344,  0.25271316,  0.17055315,  0.57982034,  0.2987446 ,
            -0.31029854,  0.29015203, -0.55352593, -0.35144147,  0.32195123,
            0.2517175 ,  0.67820921, -0.22640629,  0.22036536,  0.48304044],
        [ 0.5135248 , -0.00623584, -0.0483854 , -0.67219173,  0.34404986,
            0.23521675,  0.07953623, -0.0612269 ,  0.7980864 , -0.22068287,
            0.34133337, -0.12605203,  0.40637628, -0.12222111, -0.50067384,
            -0.32605975, -0.40737422, -0.97756554,  0.13296529,  0.19241666,
            0.27953096,  0.43124275,  0.03143067,  0.63008025, -0.36366019,
            -0.27314682, -0.35866117, -0.06237469,  0.31657772,  0.21376637],
        [-0.10884322,  0.07686025, -0.10582939, -0.14727606, -0.08747459,
            0.12867577,  0.77959875, -0.26603431,  0.71654411,  0.34228742,
            -0.56188873, -0.4699631 ,  0.24891927,  0.134671  ,  0.3969259 ,
            0.62932704, -0.0775465 ,  0.14428402, -0.22700497,  0.07397912,
            0.13682962,  0.72438777,  0.14778083, -0.26986389,  0.13076245,
            -0.06263253, -0.38964189, -0.08605876,  0.33245192,  0.01427772],
        [ 0.28955744,  0.10941204, -0.23345797,  0.45859411, -0.03340292,
            -0.18611489,  0.40158809,  0.33528897, -0.34058675, -0.08539936,
            -0.13534036, -0.62053148, -0.44294016,  0.30111399, -0.53795692,
            0.30465526,  0.14030993,  0.36258694,  0.21453738,  0.07498499,
            -0.43245308, -0.3286489 ,  0.56671647,  0.14476364,  0.54221856,
            0.40892589,  0.40617751, -0.72678117,  0.35166945, -0.30418104],
        [ 0.2022218 ,  0.28317763,  0.06016635, -0.58552556, -0.03447794,
            0.32445089,  0.15464973,  0.324724  , -0.45629597, -0.09816065,
            0.02091516, -0.17459557,  0.1394658 ,  0.18384009,  0.36973364,
            -0.43818092, -0.57038974,  0.33352423, -0.18797849,  0.63185916,
            0.35145602,  0.30873078, -0.25155693,  0.03944009, -0.41258704,
            0.44633263,  0.57323619,  0.39444138, -0.26512572, -0.60183521],
        [-0.52068299, -0.2313586 , -0.24296093,  0.50675486, -0.1056489 ,
            -0.24048658, -0.77724977,  0.44406442, -0.25431847,  0.1432357 ,
            -0.35662269, -0.24078912,  0.10355572, -0.00145363, -0.22707023,
            0.46821728, -0.37166535,  0.07594578, -0.50969572,  0.57557515,
            -0.01388715,  0.32515464,  0.32135602,  0.13857994,  0.23755635,
            -0.4303408 , -0.151822  , -0.250281  ,  0.14573952,  0.77630971],
        [ 0.42836253, -0.33718198,  0.21548035, -0.40507663,  0.20142748,
            -0.54337939,  0.12244153,  0.53933068,  0.27416686,  0.08263202,
            -0.78846589,  0.35251641, -0.32153409,  0.30639783, -0.35842337,
            0.15918687, -0.50661823,  0.24318494, -0.0799073 , -0.34223428,
            0.02638982, -0.01219077, -0.38440466,  0.442205  ,  0.50041883,
            -0.48797367, -0.52572942,  0.27044827,  0.06374658, -0.21055537],
        [-0.07229173, -0.01261902, -0.10306991,  0.57738225,  0.06888051,
            0.43713082,  0.58854153,  0.15509577, -0.06467167, -0.41953822,
            0.00777409,  0.25114301,  0.04587155, -0.08119451,  0.82556925,
            -0.10746168, -0.72339089, -0.28733214, -0.07042257, -0.33736998,
            -0.31615772,  0.63747124,  0.3342621 ,  0.10193483,  0.22375768,
            0.25939636,  0.28954296,  0.09386927, -0.35688342,  0.33223138],
        [-0.18699663, -0.25626959,  0.2164557 , -0.5729029 , -0.17579243,
            -0.30960758,  0.07831552,  0.15162561, -0.54202215, -0.30459248,
            0.43686578, -0.21463744, -0.45785058, -0.3066598 ,  0.27053122,
            0.20836975,  0.1380046 ,  0.36587732,  0.04237344,  0.11961653,
            0.07333227,  0.30418372,  0.80861054, -0.18812152,  0.32885486,
            0.24299859, -0.36775767, -0.57995001, -0.75819372, -0.02363707],
        [-0.18164179, -0.3975578 ,  0.90317495,  0.06435313, -0.18373218,
            0.12856849,  0.03605582, -0.22177091,  0.46766399, -0.45862241,
            0.60907042, -0.16871815, -0.05282949, -0.23775526,  0.14585375,
            0.36014991, -0.35483517,  0.11465124, -0.74087347, -0.17028473,
            0.0162115 ,  0.08555954, -0.19327077,  0.34771596,  0.14059514,
            0.67410913,  0.18351926,  0.2870938 ,  0.09649713,  0.177062  ],
        [-0.29599988, -0.31893489,  0.28843447,  0.12777786, -0.32988289,
            -0.01296815, -0.02620743, -0.31954947, -0.1383115 , -0.06202931,
            0.50383263,  0.06812821, -0.38838047,  0.421174  ,  0.67195232,
            -0.78291191, -0.25457282,  0.03043261,  0.46105781,  0.34550335,
            0.38043039,  0.01559256, -0.07822366,  0.10723364, -0.07854847,
            -0.52423569, -0.30763459, -0.54473407,  0.2082716 , -0.24714631],
        [ 0.39091731, -0.14301948, -0.41657397,  0.21058637, -0.0423927 ,
            0.96922996,  0.18067533,  0.07048924, -0.25753083, -0.02811435,
            0.40840486,  0.25263554,  0.24018893, -0.45088122, -0.37543682,
            -0.21472728, -0.201854  ,  0.64532084,  0.25181311, -0.34569454,
            0.37617075, -0.19323458, -0.09873617, -0.11693468, -0.1221199 ,
            -0.52056203, -0.3819412 , -0.02420146, -0.43322487,  0.4065998 ],
        [ 0.32490257,  0.27364194,  0.64091457,  0.01047888, -0.13968487,
            0.36348707, -0.47939361,  0.52150454, -0.0847516 , -0.38274255,
            -0.24647386,  0.09939949,  0.24046412, -0.05198427, -0.05003179,
            0.01728345,  0.67831397,  0.2212265 , -0.15006431,  0.40933454,
            -0.36048998,  0.52765355,  0.13417561,  0.2921984 , -0.42901513,
            -0.48997286,  0.0905808 , -0.14809464, -0.00751007,  0.21560239],
        [ 0.20386339,  0.49707515,  0.30499377,  0.50624077, -0.94146674,
            0.01341827, -0.50515979,  0.39248101,  0.19273243, -0.25372932,
            0.48713589,  0.42901845, -0.64195065, -0.25921528,  0.00385512,
            -0.13009808, -0.61665976, -0.36683499, -0.41225121,  0.22315105,
            0.08715997, -0.21546516, -0.01451595, -0.91972936, -0.17423641,
            0.37515237,  0.08753306, -0.36273892, -0.3862272 , -0.22233035],
        [ 0.81403281,  0.24469178,  0.78602845,  0.18734273,  0.16666057,
            0.22948097, -0.17923473, -0.16358617, -0.39894441,  0.27295775,
            -0.08143603,  0.04953936, -0.0232621 , -0.14048124,  0.11718386,
            0.11236664, -0.15958353, -0.44416704,  0.90842486,  0.37432654,
            0.76404129,  0.3574344 ,  0.06527305,  0.42585938,  0.80988588,
            0.40006405, -0.26865181, -0.17160133,  0.52676424,  0.02882298],
        [ 0.3390389 ,  0.50612728,  0.27222851, -0.0802435 ,  0.03551575,
            0.29566436, -0.19847988, -0.37025124, -0.01265529, -0.30838045,
            -0.88552886, -0.43679213, -0.03441656, -0.2333815 ,  0.25324648,
            -0.70651341, -0.27946818, -0.41001646, -0.03359812,  0.09514137,
            -0.4452295 , -0.56800234, -0.32575488,  0.43204808,  0.13389718,
            -0.22126061,  0.04406466,  0.06399777, -0.07595106,  0.29874829]
    ])
    
    def __init__(self):
        rest_h = []
        rest_g = [self.CEC2017_C02_g1]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.sum([(np.sum(z[:i+1]))**2 for i in range(D)])
        return f_x
    
    @staticmethod
    def select_matrix(D):
        if D == 10:
            return CEC2017_C02.M10
        elif D == 30:
            return CEC2017_C02.M30
        else:
            raise ValueError("Dimensión no soportada")
    
    @staticmethod
    def CEC2017_C02_g1(x):
        M = CEC2017_C02.select_matrix(D)
        y = generate_z_y(x, CEC2017_C02.o[:D], 'matrix_multiply', M)
        y = np.clip(y, CEC2017_C02.INFERIOR, CEC2017_C02.SUPERIOR)
        return np.sum(y**2 - 5000 * np.cos(0.1 * np.pi * y) - 4000)

class CEC2017_C03(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -13.37074354951774,     -16.215938463791204,     13.123420629821915,     -30.141746856739893,     -48.002209616370074,
        -2.5388350918259093,     43.566253954486925,     -21.46782237322776,     -5.93897587123999,     -15.176694241742616,
        36.86979552788709,     5.6173065441684855,     27.877139388605798,     -22.11968197908257,     48.20104645183868,
        10.472049646344203,     10.532795721779578,     33.32555988420735,     -28.553971029976488,     -17.884161794843813,
        44.11315945500202,     31.904504224096925,     43.92267235415386,     35.303409524722696,     46.86639638457906,
        15.180373006944308,     43.270166334905795,     38.878498078841844,     47.56570492962915,     -40.54425595589528,
        14.987223393634324,     -14.55759905109921,     34.58549387201842,     17.99180933714726,     16.457667883332277,
        -19.590351644958304,     41.20495629638188,     37.996357918651796,     12.5183952540716,     0.6340001939519908,
        2.223635965400419,     43.0623327966949,     1.9824054113823593,     -18.460395873734882,     -9.678546337641201,
        36.78895205384261,     -42.66851121441867,     9.897773931574527,     -19.377485627161594,     -34.94714181194344,
        -14.461131986247885,     -35.621289538960234,     -2.291720084246272,     30.619001823689658,     -14.476642365665136,
        -8.16692987777877,     -8.352532840274897,     -23.16063596688721,     -45.2181321240096,     26.124371348946767,
        42.76074512905018,     3.285676942638041,     -44.99286012356637,     -19.959603730226227,     -19.009598026212004,
        -14.342983025265866,     -43.319288812722164,     -28.0710341470356,     34.85052180664104,     5.626835316816468,
        20.269808224779567,     -1.908627726621468,     -13.182714560431698,     -49.961748155163995,     -25.489082575863364,
        33.45589713170838,     -18.203184819208307,     -40.580348452092466,     45.184166804121574,     -23.02916599683894,
        41.43062256921384,     12.56845584930553,     29.452610558496886,     -10.822902992534011,     -8.901350321819066,
        -14.929829726831493,     12.299349765182136,     -32.85530282800427,     -7.088528562892257,     -25.120846369284354,
        25.002925236691652,     16.06306676637567,     15.099996489050454,     21.319849042385684,     -47.925823180205285,
        -44.2472190641492,     -26.142364186830648,     10.577379566464138,     11.434642901011337,     -37.35931068775844,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C03_h1]
        rest_g = [self.CEC2017_C03_g1]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.sum([(np.sum(z[:i+1]))**2 for i in range(D)])
        return f_x
    
    @staticmethod
    def CEC2017_C03_g1(x):
        z = generate_z_y(x, CEC2017_C03.o[:D])
        return np.sum(z**2 - 5000 * np.cos(0.1 * np.pi * z) - 4000)
    
    @staticmethod
    def CEC2017_C03_h1(x):
        z = generate_z_y(x, CEC2017_C03.o[:D])
        return np.sum(z * np.sin(0.1 * np.pi * z))

class CEC2017_C04(Problem):
    
    SUPERIOR = np.array([10] * D)
    INFERIOR = np.array([-10] * D)
    
    o = np.array([
        -0.19875613370913214,     3.6722150496983446,     1.279073511454964,     1.4131768195785437,     3.2676366036739672,
        4.143444544228675,     -4.260068993939953,     -2.7284556804990756,     4.939089706838097,     4.391431322541241,
        2.534677077361418,     -1.5174090545272465,     -0.743026082590279,     2.3755720552895365,     4.257906444212228,
        -4.958061277739202,     -1.8324728226480724,     4.052956223523974,     -3.901437307154808,     -2.5952749129152552,
        3.2271473216923834,     1.9581055481509964,     -0.1440293638320984,     3.14783690450232,     -2.052516709172462,
        3.2524016038631594,     -1.3983883027683532,     -3.4586261799210414,     -1.3705499514167032,     2.777228187788733,
        0.5960328224853519,     2.6904573153485334,     3.1478307977986812,     1.167738478536478,     -4.176580031834781,
        1.308127084117877,     -4.618529140052812,     -0.5666986499194682,     -3.612078701363938,     1.113356979538425,
        -2.859970141951859,     3.210613699976676,     2.685502233541758,     -3.3151149292675273,     2.5930058416050947,
        3.127326042129006,     3.3067181171264934,     -1.3470204324204338,     3.9157847080462673,     -4.843897232910399,
        -1.388420132122714,     -1.3475939801466708,     0.7382535488932307,     3.508196592591597,     0.6915727511188798,
        0.211674216828869,     3.161609258410623,     1.2483619715847976,     -4.006734200285921,     1.2240400037216892,
        -0.8189220286823575,     0.5499921670955636,     0.4752008744773679,     1.2853147426112912,     -4.676059374761746,
        -2.2202825896814113,     0.3987361549482946,     4.410297861998471,     3.740753774915092,     -0.8865883133428554,
        0.7529361377451327,     -4.342060258432897,     3.324598742114345,     0.5343685051508604,     3.9732793088449956,
        1.4553893423079227,     3.4555521089345316,     -2.1539277030436823,     4.0830306969815116,     -1.9947017361405872,
        4.1955206892412775,     -4.279247597240517,     -4.412855449487441,     -3.34527514838031,     2.154221570578869,
        3.3103475426723232,     2.0567273509207755,     -3.575816630446167,     4.303064383203562,     -3.2469426550448652,
        -3.185450926933976,     -4.741827498968817,     0.6112894792946637,     3.284891612003431,     4.744260176095477,
        4.702331869887082,     -4.182980390903799,     -2.2291646715936353,     -2.3899020618417843,     2.484974797026278,
    ])
        
    def __init__(self):
        rest_h = []
        rest_g = [self.CEC2017_C04_g1, self.CEC2017_C04_g2]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.sum(z**2 - 10 * np.cos(2 * np.pi * z) + 10)
        return f_x
    
    @staticmethod
    def CEC2017_C04_g1(x):
        z = generate_z_y(x, CEC2017_C04.o[:D])
        return - np.sum(z * np.sin(2 * z))
    
    @staticmethod
    def CEC2017_C04_g2(x):
        z = generate_z_y(x, CEC2017_C04.o[:D])
        return np.sum(z * np.sin(z))

class CEC2017_C05(Problem):

    SUPERIOR = np.array([10] * D)
    INFERIOR = np.array([-10] * D)
    
    o = np.array([
        -2.3064793817745946,     -2.0885034785712,     4.327910236690734,     4.508406567746963,     -0.7026275811464888,
        -4.671801290475842,     -3.867766900521908,     -2.7763336955427818,     1.4599909095759633,     1.7986899417151232,
        4.319473984976414,     -2.5858019422426706,     -3.211889228405452,     2.1204743876172474,     4.897831882650371,
        3.977044106445007,     -3.5102145691332853,     1.3482901943681114,     2.0457285047366645,     2.982950979752185,
        4.778456009366922,     -2.7114183571780615,     -0.746465662146151,     -4.074240907341778,     0.11505766743625667,
        -0.012889009112249106,     -4.770522631248085,     -1.4058029773311276,     -0.10100093546387434,     -1.0658678602480243,
        3.060573682159003,     -1.1478850005939512,     -4.914271083159187,     2.9826402028410115,     -0.9205387121966355,
        3.228007578230553,     1.5723821549297288,     -4.710346278363743,     -1.4934488707691393,     0.9107501447704722,
        -2.2130194446486664,     0.31384356211108244,     -3.5827891998605645,     2.530288822933019,     0.7185051624195911,
        0.7495497582671362,     2.519416338981669,     -1.675862887583123,     -2.94705567866288,     -2.5250752242666543,
        -0.9383713636013109,     -0.8921146619705116,     4.436840751728814,     -2.921134022374411,     4.015802690906771,
        4.2157849575252,     -2.2953153874953394,     4.433905010085192,     -4.856191289283843,     0.06002705482808146,
        4.643153088011459,     3.2713866585248645,     1.5879739184893698,     1.3260929844341351,     1.7538266940606757,
        0.17459224090950087,     -4.68145867958391,     -2.2194736135628226,     -2.7368375283279853,     -0.013270587411970958,
        4.0362726772253,     3.3898924476536507,     3.162500219164885,     -0.3925333904587074,     0.7648138103125017,
        1.6941331665918788,     1.0948463832239153,     -3.9385875651532376,     -1.588035543542082,     -4.917884185854219,
        -3.840856768841223,     4.895566472373204,     2.7302687941447044,     2.758310500352387,     -2.72323901653475,
        2.139078169165706,     -4.238447945750799,     0.4211464177303279,     1.3205435120371085,     4.098819663693469,
        -0.9434288663738188,     1.9459309089440646,     1.3936965576449598,     1.021760823979716,     -0.21230769241376102,
        -4.382872497560609,     0.4288502665176095,     3.8076451146848473,     -0.1420125687525884,     -0.00028669849643492284,
    ])
    M1_5_D10 = np.array([
        [0.9996924772712356, 0.14943014656734643, 0.6227328980221913, 0.40383363980004827, 0.17131901179558007, -0.33445290802632904, 0.30592108078355357, -0.6683336419819051, 0.376261428010507, -0.7428480074603674],
        [-0.8783268006443523, 0.12049223715771983, 1.111753870717206, 0.44968789035858925, 0.9373714338912564, -0.5019122919745475, -0.056387051700280716, -0.22201328774375412, 0.30869257878674217, -0.07114611731578929],
        [0.34591292809892216, -0.507741395636788, 0.27320353249208335, -0.6973213085016697, -0.53565465268182, 0.11989115569234887, 0.09915679909932996, 0.24497104400598177, 0.6650428807781321, 0.8389663633764279],
        [0.13949615572834412, 0.1367418812500075, -1.1279135068173407, 1.0043939759827123, 0.14491594839114727, 0.521391245709132, 0.5577709853331365, -0.28672847007966695, 0.6930884800632338, 0.45567637818196727],
        [-0.8511472984952291, 0.6932111993475925, -0.4030595242386667, -0.3955721995034709, 0.0714099078485202, 0.5349200596705449, 0.9481602451138584, 0.985759687783321, 0.39886127353670864, -0.2440748900195726],
        [-0.09884089507866453, 0.2327301830103945, 0.41981283976658756, 0.1505197251176692, -1.538274982034603, -0.455690041385219, -0.33566362557094176, -0.07755411656345812, -0.4499240717934176, 0.6663321711490605],
        [1.302014472442887, 0.6028763026907245, 0.8394172215568398, -0.3185582465851755, 0.8903271510858483, 0.6763088294894157, -0.9930785882828198, -0.3882703284518574, 0.4008081093683641, -0.31562559497881926],
        [1.3079622628440337, -0.05031228662232769, -0.68826928630324, 0.7523873742018049, -0.7679197835311091, -0.604883323362634, -0.5405738282505906, 1.0289876248965786, 0.463981883963158, 0.6443868554545003],
        [-0.2352293559772551, 0.36801088060444376, -0.9179619811153862, 0.11699213390369528, 0.4817012689357656, -0.6034020220844171, -0.38981213143989735, -0.491964056744951, 0.9531140954805626, -0.2022377011792267],
        [-0.1540290906654688, -0.6635983633320596, 0.6284889254327435, -0.1293741298068446, -0.8965469406110641, 1.732345284157994, -0.883901544008069, 0.5690164310031549, 0.2082820651599048, -0.6043014672508784],
    ])
    M2_5_D10 = np.array([
        [-2.0431012155071993, -0.631736326357657, 1.1677527427002699, 1.9009105602078287, 2.0842526763249207, -0.7478493359023987, 2.143393141309946, 1.1590937108282804, 1.227894490023432, -1.1183705204850913],
        [1.3280204274094198, 0.299505458402368, 0.18223029819086833, 1.486465848762033, 0.7522465043806352, -2.5277327902444098, 0.35578955814785995, -1.0555110386991535, 0.47227913943525157, 1.3423491312151228],
        [1.0908143242105552, 0.40606445605966146, 1.8548177490249074, -0.8313724021272537, -0.621384961429375, 0.13211234904921518, 1.1351708928379982, 0.4775452186059778, 0.9255058446093819, 0.4979779562880548],
        [0.14229736296092776, -0.21450224492777092, 0.9992707523093207, -1.290073347315241, -0.21242139997908338, 0.8926670021202933, 1.4366802871697675, -0.48097392666482686, 0.6847488445733161, 0.7210257151288063],
        [-0.115903350164762, 0.9355395180278724, 1.7920415908388947, -1.1670036631415839, 0.19500780802259582, -0.46145093328755027, -0.6590337291442305, -0.0068363317219058695, 0.7864716951051459, 0.09639162235364968],
        [0.32156416855234304, 0.38346043628116006, 1.8797469522995212, -0.3716172295047748, -1.2327308849275078, 0.2511981461394987, 1.8018746604162579, -0.5011320907738611, -0.8730803931492308, 0.5619839773067158],
        [-1.8733718147751512, -2.117257323485705, 1.3534292983573455, -0.19298314152771923, -0.9683705517798054, -1.1769083585722642, -2.0801571462866777, 0.035985659128203284, -0.6312270597114562, -0.01952175275371315],
        [-1.416816661396272, -0.593105163690092, 0.789971323166454, 0.6952899733755276, -1.398332286784687, 0.01702279528765971, 0.2822911133267638, 1.0059008052626273, -0.7178659381391603, 1.362854357416906],
        [0.41902131667276943, -1.5647490200010754, 1.752800126184796, 1.3103742150997142, 0.3856562402179107, 1.7886429529394694, -1.1906825581011622, -1.604175465650627, 0.39830148026698065, 0.1304509240714869],
        [0.015607133698717246, -0.9377171601737764, -0.23463133799822983, -0.08394368338652125, -0.4178429104737592, 1.0682518558475618, 0.24089494777376788, -2.8280095502227325, 1.5584876594890744, -1.2785348810858195],
    ])
    M1_5_D30 = np.array([
        [-0.14825121464297714, 0.5290383658225004, 0.3927009565600661, 0.5622678599407595, -0.4120327160267825, 0.006694100111029815, 0.6102376413468987, -0.3375634455264991, 0.3773249061512295, 0.2035392332673203, -0.6145244495008115, -0.2426578462559812, 0.28841349107430403, -0.44664285259301073, 0.4739586532470864, 0.30314151965400693, -0.12200991620525298, 0.4120572369137857, 0.3939749660111172, 0.10203458464116172, -0.25054761093595007, 0.25893799689921, -0.11865553503517023, -0.043426079343872326, -0.4286229165347225, -0.1618327781257533, 0.2859385172570833, -0.3469761592596771, 0.49041067490784485, -0.17071655465282615],
        [-0.004900173395331706, -0.3163070549665729, -0.49049822269814064, -0.5569504977300072, -0.003750528097411422, -0.3195507989782781, 0.09526810510575917, 0.07289791386469276, 0.29774251641741156, -0.021357830836795627, -0.49203050981961405, 0.045789575757929996, -0.16758110334474002, 0.3614525106076953, -0.49319659957346085, 0.6079501551508207, -0.1934043002112666, 0.2225102683796838, 0.017180659801716736, 0.7046493573471126, 0.14078655590314842, -0.050268787397055655, -0.43248387362544494, -0.5846637868432698, -0.6672193887242833, 0.4179303381779965, 0.4005629118587714, -0.09243399753669954, -0.38981838400236296, -0.06150129901232551],
        [-0.10991653652512348, -0.17277575894019695, 0.11821653622528608, -0.7443734284601145, -0.223738730346233, -0.6889344996169877, 0.12460376121481981, 0.0871262625685266, -0.0929655491468514, -0.3255295271546012, 0.164819043006232, -0.3580037452247528, 0.4821110957080147, 0.0025862255584517962, -0.2654546701263538, 0.3585332213305134, -0.03904619524176228, 0.35541417460900426, 0.793099587329011, -0.3292343812663924, 0.11307783462690507, 0.524710062770742, 0.14665581030232486, -0.6965130857782307, -0.29734231649232495, -0.2041027769524198, -0.9521260314512346, -0.30258063791102385, -0.0614415002125257, -0.03144182681704018],
        [-0.18006888875013177, -0.743360330315376, 0.3732476307555666, 0.6822493374651409, -0.09165854085682942, -0.0343794599968896, -0.46821887196699447, 1.0298447206506953, 0.29589035297760363, -0.8148785489937006, 0.23117215658145812, 0.08340079226897432, -0.383612475097442, 0.022293789691231705, 0.42288691981145515, -0.4921299262043595, -0.02361743825204632, -0.06863887092055321, 0.019483977330228913, -0.16784302120461914, -0.3030775999320534, 0.15624618863762263, 0.12362791414766205, 0.5284686362818731, -0.3666037861488026, -0.3430733959664843, 0.11821158292441453, -0.5006841468405576, 0.2748383042428999, 0.09266409520466412],
        [-0.03157465632524434, 0.6166739579973131, 0.39703541992851393, -0.2073175310546415, 0.5222692682272131, -0.5527838365394188, 0.6036163493892799, 0.03604719624225655, -0.2213982332666921, -0.35111358100713697, 0.3221053904538367, 0.08955877641616315, -0.3264896461973612, 0.6052052030136532, -0.32627667881416955, 0.4289732780068418, -0.7185723400537928, -0.4268222856933559, -0.3356774419068965, -0.15320478618255315, -0.5219530399916118, 0.22932027857928544, 0.27782090154508726, -0.07021310569580583, -0.017812322629184918, 0.24727521717149203, -0.18451794413506606, 0.35018663971246955, 0.06222315914632873, -0.32835067537163903],
        [0.28262163439231724, 0.1128623817560682, -0.24966260253225758, 0.5596863709439026, -0.05587183703869619, 0.39082220879798585, 0.3137781031201678, 0.24410158809715637, 0.31992243780368923, -0.23932231094858628, 0.4282110881517179, -0.2483039120926765, 0.11871828496028759, -0.03230566240867097, 0.3913773644391736, 0.20264125070199412, 0.39653090115452144, 0.11121078817356538, 0.3216961443793641, 0.1601992618490006, 0.5869416971897974, -0.17975592742664329, -0.2812138514647603, -0.38794616849241753, -0.6729984249152655, 0.09931744727929659, -0.12865726153673546, 0.13875376999989064, 0.5346319073021941, -0.10264714562835797],
        [0.3892151661783855, -0.355793060483398, -0.07959500291010739, 0.49684710056342474, 0.13634224284877172, 0.40397077796958514, -0.4321526786841916, -0.018396757997477864, -0.4524786828407451, 0.4620278415278812, 0.1398249854755808, 0.4018234218937528, -0.45846006580745524, -0.15576430550942744, -0.232382076142197, 0.4409644550942914, 0.23435142836193762, -0.6029626008784433, 0.3407022592664625, 0.384677290740039, -0.17339512529054718, 0.2855305741726456, -0.29852356503419375, 0.4918404733439781, -0.24181167501726486, 0.1444328685604208, -0.5330812377825942, -0.875379694118513, -0.16536251479436187, -0.28200748337909304],
        [0.2404127979402323, 0.27886835799960524, 0.3690150177108625, 0.5272591341048212, -0.369560442013241, -0.498452268611926, 0.1453483544445794, -0.5526347569028333, -0.12560646472813497, 0.35329033463724746, 0.21547082707208826, 0.2316401824614574, -0.16418743874854486, -0.46862616048533545, -0.1178458934444577, -0.2589766719437666, -0.31860592393179094, 0.42264014872623706, 0.5240141932434209, -0.3866418349709711, 0.06857724766791837, -0.7600294650208933, 0.12067843376024392, -0.2737544873629804, -0.10143000757932474, 0.340764922973685, -0.341657912788437, -0.047936008465138596, -0.03247959586998231, 0.17195742432773292],
        [-0.0805350510231698, 0.36462319526297576, -0.23683380805578053, -0.24996683165771788, 0.2334379398639322, 0.07428329602438612, 0.06601369700954174, -0.25403340725087276, 0.35997959380027994, -0.10085096435511759, 0.1226646318885824, -0.20696562741667668, 0.4670646794963167, -0.25762459121273035, 0.07838798753031137, -0.3923019064091091, -0.7731249245739964, -0.6493966037299455, 0.4360544400876747, -0.15472393887550848, 0.1253678653973267, 0.32267033909127085, 0.5114691029354657, -0.3128322188493124, -0.007789312261206716, -0.30945496525322674, 0.42550577780208143, -0.2118257050745703, -0.6703999772052458, 0.5106676532225851],
        [-0.39310299849315933, 0.6957559218157733, 0.4659283795650998, 0.46151656943926633, -0.6952364946264682, -0.09315769916330272, -0.33011661961587113, 0.25381559583468516, 0.2515370450857682, -0.44936038848921867, -0.1839414554213218, -0.3921426724238537, 0.7134221605963799, -0.31555260357714143, 0.23367602545497548, 0.37191718287702985, -0.10816839678317464, -0.19277459039369244, -0.0161916505864039, -0.2725926607168815, -0.19177970521715318, -0.2972254348327213, -0.3862328720606691, 0.336493180067268, -0.07012679528178845, 0.5584991083384956, -0.12049249947286636, -0.0805396692637438, -0.9658080785812679, -0.08604020241583005],
        [-0.08620432987144493, -0.30819014238317444, 0.46286330773011913, 0.2068365647869955, 0.12666428480752492, -0.46472313981864133, -0.25811011679452023, 0.12780086143116598, -0.03281578763362944, 0.9461404457300175, 0.14439312861769477, -0.3393980233602328, -0.2611478652489621, 0.5184559379634684, 0.49032640735047917, -0.14339237422368897, 0.6584335406121956, -0.27903601772833336, 0.46789158127408714, -0.23460051227494738, 0.0009472672122068648, 0.48687985601734507, -0.06309069919154742, -0.4115966939899541, -0.4336438971394041, 0.4317602457305982, 0.06034953278342245, 0.44652100610712864, -0.076918806824056, 0.03858472342158678],
        [0.8721785723827797, -0.10658685359805282, 0.1508514042581616, -0.3037181359229524, -0.3849401486331707, 0.049046233878171364, -0.2980006133774934, 0.15193918108596544, -0.22947347781615018, -0.49581516498375794, -0.4130849192076192, -0.12830760386924822, 0.058095694245003826, -0.35474822486398144, 0.3356300659902761, -0.33178518881148866, -0.03813575849080823, 0.005538437532530013, -0.04997996405443639, -0.141525273793649, 0.07295764121394477, 0.6810142401635189, 0.051047812101643206, 0.27733360946279273, 0.3927148987935366, 0.3838194235355414, 0.31456808727270047, 0.25081054783368095, 0.35462228448052346, 0.5542357840181837],
        [0.12611821049048916, 0.16622439796492822, 0.4280848185361925, -0.5851928658465372, 0.8821881461150678, 0.14935556327495536, -0.18499628984374406, -0.9042381792669544, 0.46969895272583106, -0.04723416140768469, -0.5117598046178465, 0.706561617968755, 0.43686677246597355, 0.3151271707434851, 0.8168198306129528, -0.13020710890304682, -0.10399308342202773, -0.2883624280507973, -0.34207272370170244, -0.14276124794848907, 0.2574657279992845, -0.11449632177366112, -0.2529780006581075, -0.3716420193167925, -0.197656810492911, -0.1644525037659496, -0.12757682576663376, -0.6522973751171951, 0.1351476040033887, -0.10434786704168253],
        [0.3101020747625047, 0.2889393046339869, -0.1949793518798744, -0.17503977140262977, -0.41123461427374924, -0.19097482695956072, -0.48091676111744014, -0.24334125514574767, -0.1607479664343078, -0.17067097053430866, -0.23096581701921276, 0.33257155582778586, 0.7379821144751484, 0.744075254943086, 0.04074479087512356, -0.9329382820423948, 0.08000437483155581, -0.0665620011974064, 0.5300844511856037, -0.10118629423823705, -0.10718711491237269, 0.3371945490121751, 0.06888615377472443, 0.582039992312651, -0.7075060489978569, 0.7681823070381663, -0.38577199511231625, -0.04574683371278232, 0.12926101539935586, -0.5192009860221974],
        [-0.06929165060556788, 0.2587408308155011, 0.048352296503824874, -0.11369952097238004, -0.8107157258737673, 0.09947287582378384, -0.21064528877201885, -0.21119881172371102, 0.033718959926321956, 0.027877295880330527, -0.17690313032828983, -0.33402496002351767, 0.16770837097509347, -0.34040669048274275, -0.4110037985530708, -0.04191091799893365, 0.12456277869120383, -0.11141619089084008, -1.170343463282102, 0.4985235701755143, -0.06082742054668057, -0.5360637549957754, 0.4553425585003825, -0.06293471709873416, -0.08613751018260776, 0.05562203198386124, -0.4866916651934224, -0.6548340907849012, -0.04737825926842737, -0.1197745341751627],
        [0.018381688676348165, 0.10816070141498288, -0.4139549098456491, -0.005313584371312852, 0.3479468365810208, 0.22346289705792216, -0.018611275035665537, 0.08269365997219254, 0.05151611146770571, 0.9777443907974339, 0.11860298433810568, -0.6334715467831452, -0.2667415815025314, 0.2607957322580701, 0.329500183365785, 0.015279444139670029, -0.7519037228339324, -0.12311930828002544, -0.513605448281844, -0.5933387161294588, 0.14429103601552232, 0.22317594266510116, -0.5314402293771588, 0.6588588205868748, -0.10813000446466209, -0.11806531677521026, -0.43032913535005346, 0.10998670169205127, -0.08613534569886205, -0.3583513864895832],
        [-0.1460208651007898, -0.8260689399639891, 0.23120846964514047, -0.048751706635311205, -0.06189051249752864, -0.11970102705619949, 0.78973599373801, -0.5320817133451031, 0.3030024182845206, -0.8783375385843115, 0.011548422432810956, -0.14996011140884222, 0.01861509432379252, 0.1358017431264579, -0.05138033166745183, -0.7014685609445697, -0.12597758508874082, -0.15972783994452971, 0.2587767088767059, 0.37959328590835184, -0.14449490797496176, 0.07994410405156954, -0.2976019833330865, 0.0632318151330514, 0.402524323993808, 0.09496953366245212, -0.34171071693701116, -0.19953452893250423, 0.2653024630119852, 0.4052166347316886],
        [-0.0937093963353238, 0.18191846993977032, -0.6123705971903795, 0.6226052349496406, -0.1279862759353204, -0.0954652193426807, -0.4287888142707255, -0.7456474055247704, -0.25914651428239505, -0.7087036588958793, -0.5538221521902035, 0.39259014629458716, -1.0181592241532524, 0.3216532381525968, 0.3205208783043427, 0.4708749711416453, 0.14336230737206954, 0.4750274306911938, -0.13630651432475405, -0.011070562074230184, -0.6758078525112977, 0.5925302427961064, 0.18249007711946913, -0.03877160744840069, -0.07964617082392904, -0.2731369862428985, -0.18377173684774012, 0.7431072911684227, -0.15638740615713348, -0.1905378203129254],
        [0.5914140083626711, -0.20777206248032834, 0.42106586496647447, 0.04876133022793813, -0.09742962901096947, -0.4338315844256117, -0.349680601954915, -0.5179872546598602, -0.01601116970737082, 0.19951994110906585, 0.6674286854466038, 0.22619220095765882, 0.3457866843402323, -0.6282843498105295, -0.27683407516633746, -0.46506115455461006, -0.4538161870630867, 0.035856534731729416, -0.9237392833111661, 0.22527565860643306, -0.3110053356849081, 0.03433809055737139, -0.11349598192650337, -0.15944255600689491, -0.06395593616429728, -0.21699282032522013, 0.004152401253677978, 0.5652064612731946, 0.27928843759949346, -0.8483227312844861],
        [-0.5311586046440899, -0.12207015165000473, -0.10505277121100792, 0.05504710510062502, 0.2002961063361834, -0.07119957197506929, 0.2268515442814179, 0.1444731836992241, -0.15899502939889543, 0.13532989890564032, -0.07516977286154503, 0.5650999873111064, 0.050962372888768315, -0.10401070322349018, 0.8198083219750354, 0.20655598884258156, 0.018234290137165182, -0.14830459384624867, -0.00397742811166879, 0.19032814852175262, 0.22978838177577018, -0.1338155857435506, 1.1216403593160436, 0.4740705085515716, 0.0015454937881309028, 0.055461520681311244, -0.8353045291743565, 0.49907603217808605, -0.48973312945643643, -0.7042356596787115],
        [-0.7351706024143028, 0.2749015255168716, -0.41154529414961377, -0.5180486785487524, 0.1534195019238403, 0.8959520382136247, 0.5548471413058151, 0.13836488380455098, -0.06381307411719918, -0.2373674183383852, -0.5763156332438982, 0.09743285724430345, -0.0047548680055583895, -0.6437879749830793, -0.06655702935392298, 0.0862527451877082, -0.10255562419356304, -0.5579140833303662, 0.1134541270817167, -0.4385006747452715, -0.34650652587805597, 0.09430023602251449, -0.11995233817924564, -0.002969320992231402, -0.3171469250490246, 0.014875852734104043, -0.5500473755430535, -0.20486696281570577, 0.18106423434404612, 0.19750297281642343],
        [0.14842334148640987, 0.2741212921110904, 0.05146978656836866, -0.1937736345291019, 0.13931108759989763, -0.02159514238633114, -0.13604060186940065, -0.34744298543925567, 0.06229426638104489, -0.1646461564810487, 0.4635154061018588, 0.4188013450768087, 0.0056545069337393325, 0.07831528844846737, 0.34987416762574086, -0.2578905485150868, -0.0077914393926735576, 0.626486452734595, 0.22819001917862214, 0.21749704286954136, -0.6861892188986064, 0.14915090004900505, 0.1455242122214369, 0.24221838447026936, -0.12920695542591343, 0.17896901893861436, -0.3561185472963825, 0.18230185686791844, -0.0559149276013844, 0.29508005012278293],
        [-0.04835213707797309, -0.1801997673973938, 0.3957342489134246, -0.06190047904212598, -0.5939051084393887, 0.23017562270662487, -0.10045000364903364, 0.5071881123489045, 0.8208783146897257, 0.43376140604315705, -0.3803841820516181, -0.08061326087224326, 0.35130824330584265, 0.24793037973613657, 0.6312607683663525, 0.041344084856807295, 0.1428499491363102, -0.18265450717754175, 0.1930250965033357, 0.31300062015132724, -0.2713750918475366, -0.5898590952062798, -0.2556147327524673, -0.40382305919758615, 0.34295310142407887, -0.3295425713563816, -0.5553810260526105, 0.4381761720073392, 0.6255226035965111, -0.23625125876903574],
        [0.10316702563657512, 0.07401634309210592, -0.1828901410525008, -0.45659868655612856, -0.46450777892118217, 0.07743634180060904, 0.6273892220213158, -0.05479941427486895, -0.0782313883218683, -0.24830419288098118, 0.027486196692833365, 0.20857644451951457, -0.5417250926225627, -0.23863854340800716, 0.7254549445917835, 0.048571487234502816, 0.3759239730741148, -0.23832189286593597, 0.14924670802400847, -0.22298906403627225, -0.6241878926109458, 0.14422622807513813, -0.3949904390899766, -0.47018278827781124, 0.5015939869143077, -0.2447531558853246, -0.12827330450983537, -0.3504282393679936, -0.1252636468454659, -0.8823740202417099],
        [0.5694643441223288, -0.2277664808120111, 0.39876441238749505, -0.43476130861184165, -0.2319636603233274, 0.49246783930462507, 0.27195498288142256, 0.3680006818997311, 0.4591660578389054, 0.1715934157414356, -0.711555652825998, 0.5014846070310658, 0.20340469243451711, 0.6076514898025963, -0.10255441853693628, -0.2895608197315329, 0.7083243004255955, -0.0560670293214811, -0.3626996714153802, 0.168812575730403, -0.2612760774479992, 0.2872790985379272, -0.2112424220496214, -0.2231856009639825, -0.06841613723975556, -0.4261869262178082, -0.05877498807449488, 0.6518418523404781, -0.9160107450349311, -0.09827771597704382],
        [0.30789012220063067, -0.9310367903277493, -0.2534749452407324, 0.39338216851206687, 0.3467689444407427, -0.1573539567218638, 0.11014683265079014, 0.3546867187554169, -0.5073627801198692, 0.10248023198498535, -0.1816829617413, -0.2715043154122633, 0.36955323884896313, 0.31095597373524625, 0.15910185179964398, 0.040121858872083846, 0.2221927266844056, 0.15310672119510477, -0.07640982867633606, -0.5267742280026113, -1.001644365801711, -0.5567535231298524, 0.4114114106113545, -0.36854338946126436, -0.2233193199223063, -0.1385488219320149, -0.335230480442993, -0.4395792939286902, -0.03193277265035954, 0.22505061613146757],
        [-0.3606155812607646, -0.4243313573404433, -0.2110554212968749, 0.07666444626273936, 0.019970572766294853, 0.3095239584244158, 0.16558693668086766, 0.07737509240117495, 0.4081696806035699, 0.49142330132590933, 0.23084620024914593, 0.039937168617834196, 0.01936195392322298, 0.44370359149471533, -0.312340499978845, 0.31172804422370837, -0.4505153995689116, 0.4492093070362246, 0.1075056927586315, -0.5008748640748596, 0.048306340398158204, 0.17191119428859863, 0.6392747032653224, -0.4423509670536122, 0.20541957665260116, 0.6594790855281147, -0.011434644523754624, 0.04755826838904301, 0.06381670158915609, -0.011922630943369622],
        [0.12030128102386403, -0.6004753523983333, 0.25447479649406135, -0.7326439548735735, -0.23484152498761895, 0.4514967549183092, -0.38091097534753826, -0.8643492622596766, -0.1722994390850507, 0.17042081879773996, 0.22322227048559362, -0.15226750341551762, -0.01780480856049587, -0.1903437436371902, 0.0821606936961507, 0.39822742538787104, -0.11954598110311143, 0.27865803891120633, -0.021648827352797266, -0.3199012435320404, -0.055857591681810675, -0.40822107976522337, 0.3989735846421402, -0.20553169941611948, -0.6040767923747569, -0.5170780769518822, 0.15864595207545606, -0.2721428940387103, 0.4802310201758927, -0.17563516142588595],
        [-0.45912453656517793, -0.12055903403643448, 0.4577619628987362, -0.07777629060192562, -0.289790844327823, 0.4086983055765073, -0.051784392460181405, 0.2077113182929812, -0.798719284612081, -0.11133198664503757, -0.25197108006948027, -0.5697585855624807, -0.008561353218480089, 0.2611743311149083, 0.0970731239019968, -0.1994686682023581, -0.3796684742683452, 0.4211814278974085, 0.060719263616870224, 0.26338818744606035, -0.18207949417222374, 0.10500737480947289, 0.29074406143738707, -0.8444465566129851, 0.15263196514254296, -0.1815215388397155, -0.025964413863063862, 0.47783064000969505, -0.5325804901861496, -0.041014232055886814],
        [-0.44308857332141605, -0.18362978516471964, -0.2648415420344888, 0.06520535780761491, -0.6889031027412632, -0.1136225811013359, 0.5965625737827486, 0.22578585855357708, -0.2731605636879736, -0.0027900102358654755, 0.46086276192638576, 0.4920033102995811, 0.5283653464434157, 0.4532269943319224, 0.31874846927183964, -0.17364896281026151, -0.5954557884928504, -0.3155663921975539, -0.949043902304443, -0.12385147440783399, -0.12238271055897162, -0.22817365603207393, -0.2280463434133379, 0.14798998928130497, 0.1210478981644145, 0.00801571198039211, -0.014416138562503227, 0.2595859792240667, 0.44068147339389174, 0.4238088645920566],
    ])
    M2_5_D30 = np.array([
        [-0.7881869829517587, -0.08594187295509925, -1.3017284239925533, -0.025016185751691733, -0.29025684835672666, -0.6837651231687998, 0.133743028223337, 0.11112546767355957, 0.46783029673837867, -0.6189604970377963, 0.35283226509595866, -0.4472662843343025, -0.9201159792355038, 1.471615007859908, -0.8789265100697967, 0.09704259491837952, 0.42989703834815285, -0.564956895645362, 0.3636012912590674, -0.06114290754265628, -0.13448758144589124, -0.5804617377054453, -0.14085905540020838, 0.10011312065008876, -0.3318749737991268, 0.4193925096702402, 0.20950213050168143, -0.4862583518514215, 0.03842018115469595, -0.33189255562062664],
        [0.8712247018502419, 0.1887471492171072, 0.14965750904070835, -0.8585373016402424, 1.008825948885192, 0.3259257578950385, 0.26098809545550056, -1.209061901155024, 0.1629977135380535, -0.1802004999068454, 0.41220526858282464, 0.34216933607248856, -0.05167630659092659, 0.46513394952099163, 0.36865159289603816, 0.06945596500396607, 0.06425285698900662, 0.5276595591680249, 0.011869844357525722, 0.6563259992425793, -0.36043249690900764, 0.15175222685747947, -0.4505872805089687, 0.6661082356027738, 0.3593489034060469, -0.2672053448969544, -0.07617166804894825, -0.4303741319024701, 0.3976609321193718, -0.07366578444575436],
        [-0.12495157341703203, 0.8073912286487293, -0.7067446734121533, -0.6142636058767412, 0.27737632831879266, -0.48044968311219316, -0.1149942849966115, -0.8258644329353448, -0.49575092110916896, 0.2754598660668594, -0.09706701811069376, -0.3042970858453678, -0.09124050526910807, -0.04338171429948917, -0.11180300645047703, -0.382663643406353, 0.11860549729820495, 0.36453826661814986, -0.8508435035572585, 0.4993622504745678, 1.1870712625935211, -0.1875727957092694, 0.6895485900347713, -0.488865677018107, 0.10225300668756321, 0.33488172648888614, -0.09366820936206154, 0.0629383707277123, 0.35141678982088226, 0.34024596153227626],
        [-0.21633964713126452, 0.43398285194400865, 0.4306869941078408, 1.1970725971788623, 1.200507865584111, -0.06558494700486289, -0.408378278274187, -0.46704789308793193, 0.08254803725145307, -0.4769050765811762, 0.012974483339229959, -0.658595528495358, -0.2546883231706598, 0.4594598335314948, -0.19511815445869357, 0.038522444504831416, -0.05794546465845801, 0.1876968413914315, -0.5354658843913345, 0.06866208739611657, -0.034808315417695135, 0.3563412305579332, -0.5821996670912931, -0.5385369026946359, -0.9917545209238923, -0.7119054335878889, 0.4733995734950387, 0.5654631107036205, -0.8683055201681852, 0.8332360569368029],
        [0.9818925338195252, 0.4331688866951169, 0.5820020379846507, -0.40456467856614026, -0.10239808955782369, 0.21535875015205191, -0.5693281183014148, -0.3035959562042466, -0.25767871375129536, -0.01471664522178906, 0.01631453933628596, -0.19210854381062878, 0.25963304732766385, -0.7106812405002491, 0.47246971582536357, -0.07784640479090324, -0.03789520274604885, -0.23296279919699475, 0.7740802685091861, 0.6109118026116038, 0.9673588032975048, 0.4429918909904462, -0.3155837478726266, 0.8924057653376141, -0.007716057648999464, -0.4029661427045159, 0.39937185771976197, 1.331294565667231, -0.4025263391859005, 1.076514409784953],
        [0.10688827440186777, 0.0018730020365411715, 0.8638371515702387, 0.605078847852916, 0.5896146342536093, 0.48210342796647604, -0.5026950708739162, -0.7400681413280734, -1.0172893100616485, 0.45547058441766936, 0.28700085416753346, 0.7592715615156187, -0.08992019948573465, 0.2299816734409269, -0.7221304531430278, -0.1969705858695188, 0.575961592452567, -0.41075557061983137, -0.2583768776526705, -0.8596085139661089, -0.8770734870418044, -0.6434638257085272, 0.5403299260173392, 0.9532414998108661, -0.36467551701616147, 0.7690326773496883, -0.6777196610099019, -0.40256310981433097, 0.22071795971141425, 0.6177363852813849],
        [0.5085333169381432, -0.6507187710361104, -0.050751483916063767, 0.2180586134197719, -0.41025515410344227, 0.5647621113287444, -0.6362136558943766, -0.24124456424014337, -0.05820158581906221, -0.9546125620101238, 0.10103626210465733, -0.05711265918731773, 0.307082048788463, 0.05670454859829592, 0.523674168872617, 0.12405191285070796, -0.6893087472776422, -0.375094046553091, -0.1505720634961497, -0.4212000531650495, 0.6965586923811731, -0.2974258948360712, 0.2840191635735536, -0.040750895267074705, 0.8201044386575217, 0.6839550283680254, -0.34863291715427935, -0.314903150322695, 0.4460619153522949, -0.013748448254221335],
        [0.3580511236113378, -0.4691330304867515, -0.4498752623232801, -0.43016786390051076, 0.3426451126542382, -1.1539379154044518, -0.12193998040714064, -0.25341709263450063, -0.09586462803113305, -0.06257445041413462, 0.30654773910078076, -0.11113680924930786, -0.01291751265085625, -0.6101697315861112, -0.03738895505617151, 0.7620253571902282, 0.5753501246273179, -0.15583667433050746, -0.1861095062383899, -0.5811437475621473, -0.2180395797515299, -0.4759367254304493, 0.12077827352327783, -0.5817866887542968, -0.32595935171412793, -0.3370549513207517, 0.1985285403874029, -0.03445257360265837, 0.3282965192240884, 0.5987479492379199],
        [-0.017007912206534026, 0.31419863127386327, -0.08430237156268665, -0.5937811984113804, 0.7340788531968909, -0.6740392576703942, 0.20968703437095815, 0.12709794441803096, 0.3599782871424014, 0.9106213509842281, -0.7064719935702313, -0.21161689886397056, -0.26249070306912503, 1.2543557594165455, -0.5244684568939852, -0.2553736135861822, -0.6560526884333117, 0.22694786186896965, -0.06648378569535907, -0.9857732801169443, 0.08443895017456117, 0.39167108192548916, 0.05322025444191367, 1.061649370178858, 0.3944728043900674, 0.11259820672227533, -0.21684477150399328, 0.6248164145602945, -0.6796034049230733, 1.1687935557925369],
        [-0.4928586157594385, -0.1970944950240405, -0.20683065076404003, -0.0014779974065411983, 0.27993189564627274, 0.4368813834153084, -0.14689605721394822, -0.1208188042494134, -0.13888133727756352, 0.3543021746990818, 0.3865874975150926, -0.12702533707531963, 0.9128132965495572, -0.12320867106777965, -0.42398567052924446, -0.3561049808588009, 0.8298180539004124, -0.3174252756999684, -0.9330054806600608, -0.19558885548165877, -0.17231067152845594, -0.548069056162688, -1.0918178350230632, 0.2878281917335136, -0.028007387647027163, -0.8372033364553159, -0.5052999664774549, 0.6571932656913144, -0.17255966872400083, -0.059088296810915514],
        [-0.6925925323478987, 0.9216869784779126, 0.24601162669150478, 0.6419631196543475, -0.3731640229533928, -0.4607499990998327, -0.11762169343153286, 0.7473361952932039, -0.29402177343414865, 0.04607630731684126, -0.6247484143484623, -0.046689132428560154, -0.45408259310387705, -0.38909874359687097, -0.2208656067774351, 0.28117032169209466, -1.5264031646294272, -0.29820513212707306, -0.16282984011409646, 0.9148971007086979, -0.6111755230379866, 0.5221408503854206, -0.1671721307748224, 0.08254380576969367, 0.45568926611879434, 0.330635273346212, 0.6795002894795205, -0.8380424220035821, 0.05700782413645783, 0.628553508732582],
        [0.13815738774181427, -0.9623363684633266, 0.2027847791285461, 0.4835468319122693, 0.41626208707078105, -0.6670976030635377, 0.08164566440463998, 0.48229824130237914, 0.5575768275147317, 0.07297686407175685, -0.47653263378137656, -0.7896036661233488, 0.26262944716066244, -0.6549327058137596, -0.5141974884679965, 0.28589379244595287, -0.08268487767075633, 0.4132034520723822, -0.28587928328598317, -0.07161186227028293, 0.1953126723597401, 0.34079666818087523, 0.31196077812065515, 0.47624273461981725, -0.09171996845900571, -0.0881626548247756, -0.6437976170366402, -0.5414898328800065, 0.1114786382379373, -0.11936740996988687],
        [0.7411778667567952, -0.11339445067329817, -0.15868666870215464, 0.5064948565984273, 0.04365001093962648, 0.857721755559805, -0.07300158608236962, 1.0580231487201572, -0.9172437030239413, -0.0077879269713635735, 0.06491493268845686, -0.6317414941290769, -0.23007925687144948, -0.2678580641016289, 0.7655194647515515, 0.3441572542364067, 1.2808563146743652, 0.7569497807305087, -0.1585377500732386, 0.2333015753350926, -0.03743320337566361, 0.688349315740835, -0.45171545142725666, 0.2607404169596347, 0.30808775075363115, 0.5368693236025015, -0.005213177813265737, -0.5700755503045694, -0.5053046223163287, 0.5078363407004355],
        [-0.7885475832230536, 0.1755138249350967, 0.3351175712774906, 0.5031143398108622, 0.5402566781698037, 0.4381372663073147, -0.2710587520327264, -0.2523728774330374, 1.064649928489233, -0.21704249818085553, -0.5528041161133133, -0.042589280485250014, -0.041029663735551176, 0.29991058879519567, -0.11370215672901962, -0.2743044541963724, 0.55670512462335, 0.09296728082480218, 0.7154903124983272, -0.4460338012294922, -0.8540355932517967, -0.36306618952218894, 0.3063033848458505, -0.03401675884568608, 0.4184905234926394, -0.08336261336965992, 0.37963040608709925, 0.10869019222173815, 0.03617978343348008, 1.1663046030701136],
        [0.1167767108861161, -0.5729668390439118, 0.604073643089923, -0.4587979842099564, 0.3185842529228825, -0.1131611326424409, 0.4486039250980142, -1.3071627129923007, -0.5624871066372145, -0.3487409608329342, -0.09558931779665408, -0.7190435985422335, -0.7358618026655708, -0.1761395245205294, 0.9167454629076408, -0.020726943206120813, -0.09182977444856899, -0.7628394641987224, 0.3294760797149798, 0.5174367640049128, 0.21041636875043634, 0.30667741092059886, -0.42516074971339285, -0.5973442432169371, 1.1234011339770822, 0.4437324404444658, -0.6127049989821689, -0.5128321396136242, -0.4710137431204968, -0.22911340697529603],
        [-0.20052031777053972, -0.10506756516527929, 0.1683358294611973, 0.4046431244568178, 0.6086885484498552, -1.0852392148551524, -0.36353077624598595, 0.41526603994529787, 0.48268548782442683, 0.5704525353003718, 1.0812024134785019, -0.7109221156018556, 0.5420356904966048, 0.7553517609643273, 0.056124889200657724, 0.13772471156666724, -0.31149665908444957, -0.5940280279327304, 0.17352778185821657, 0.7657013654678477, -0.6213096846111485, 0.6396729554953757, -0.2618722367254416, -0.9142342950562297, 0.07757847057774239, -0.017261568555756196, 0.110815098731631, 0.27559727133905554, 0.042976464577093615, -0.12729456828250335],
        [1.1767478066684034, 0.5159476676630939, -0.32943639367854904, -0.926155112333725, -0.6964636913883575, 0.7006936315003116, -0.08493975574726283, -0.3516899299600575, -0.1653269761708676, 0.3580305406410027, 0.21072975373018996, -0.7814111397014568, -0.5462063001185615, -0.12738870872531416, -0.4702890050450995, -0.18461768454664182, -0.46003519357737094, 0.16753186615873414, -0.28538476146106345, -0.5175818424005092, -0.813422997531754, -0.32482926832671566, 0.6450054742965892, -0.27067308338713875, -0.21252756097531866, 0.21174948954196093, -0.23935047560814876, -0.6583105378081384, 0.4716709813066615, -0.23472818964463055],
        [0.21254656232490743, 1.1707196566510154, -0.2141402684115268, 0.3377123887199156, 0.248657032014174, -0.303156253036133, 0.007071374093773758, 0.5602756575000338, 0.027990656160132382, -0.3156099953075547, -0.34751847186017576, 0.09015967001942504, -1.0021423606921958, 0.15239504656764621, -0.36860813186552427, 0.6362096000719948, 0.5665852352631623, -0.145017752138748, 0.641509402963093, 0.2224791805709625, -0.2735758198778735, 0.05229396726078955, -0.007691219362972457, -1.1513120640025098, 0.36734305462588435, -0.6198634795602026, -0.6989183052824879, -0.10570162578162001, 0.046139942996279576, 0.14055773418022507],
        [0.21776907659344513, 0.053614465593578436, 0.704300153510096, 0.5283327200558825, -1.6236013259805455, 0.18477173608402142, 0.7386606815694415, -0.29540063816339784, 0.2078508549817124, 0.3308241010121057, 0.45156885630841054, 0.2897605478409847, 0.806326468626398, 0.44580627810919116, -0.04753299057121226, -0.42790686815449136, 0.3961875108955337, -0.3199729654506495, 0.7626272764371431, 0.4846805176445891, 0.32154346944323325, 0.2707411487489278, -0.5060963000351876, -0.9969659374619707, -0.16961706062073056, -0.3279073233851348, -0.24459722329603256, 0.020353163085648704, -0.18488304234022412, 1.0325961276235345],
        [0.49716506497206325, -0.3257591072990879, -0.3194634716804815, -0.08874150536287112, 0.9445626933496617, -0.011834742234419542, 0.04725808099073492, 1.21302440094645, -0.030752082016532012, -0.36584596180034934, 0.14632853550802924, -0.9326575979255349, -0.20365094247334564, -0.48837182512333543, 0.5008664879110589, -0.4822866291320417, -0.9489763434753444, 0.407486403161899, 0.01892117203967847, 0.07845659229684628, 0.3862457192456379, -0.21515949280141589, 0.016878361081106796, -0.21438241029835683, -0.272362588918167, -0.2922704306874814, -0.11129648161137762, -0.7748371361754387, -0.9186527828996974, 0.8518626573270554],
        [0.33008342795682655, -0.32033041484418945, 1.7402087645811632, -0.46543087446383336, 0.8127350614011055, -0.5323300536582302, -0.07145326503752358, 0.0033919603101983872, 0.009375708232070068, 0.6486763465555258, 0.33374035201175284, -0.9746860246130324, 0.5357328757446218, 0.4561374586398331, -0.13789962862029376, 0.7027930340617248, 0.1148139211621986, -0.17011852480993028, -0.5467765626875707, 0.314735470160411, -0.17316487650248594, -0.7330728203387886, 0.2038080283031447, 0.09495074641057455, -0.1641756668767968, -0.18113680241672458, -0.08184534719934163, 0.7747474042830129, -0.09863482628068027, -0.02450322510639985],
        [-0.27343627441909846, -0.3801431406085959, 0.100449826221916, -0.5393398909442657, -0.009500177595718001, 0.8643612227590683, 0.6821656414227388, 0.12294595194973718, -0.2589639200422489, 0.571095048801038, -0.7406520151650755, 0.32700162919324904, -0.03903564395106901, 0.41133380244879447, 0.9923181432447323, 0.036952846940671524, -0.4241354866672966, -0.6014968684391293, 0.44986252850678116, 0.5602637907566191, 0.5352919903657036, 0.9050994168275187, -0.6464637012521188, 0.39840112809565464, -0.5316221037749367, 1.052347693018174, 0.14607213933940932, 0.023004921070696113, 0.6832861402100127, -0.1508712012927264],
        [0.3874077626048606, 0.14548247671784253, -0.2883355864994037, -0.06368856068024481, -0.3695884364377196, 0.6312145514156838, -0.36735460123801816, -1.0659357837706058, 0.895498465988215, 0.35212001637684287, -0.2507269191851202, 1.0664962145489922, -0.05078205769287021, 0.555413229030452, -0.32294741807800165, 0.28829899251862645, -0.11572925247546617, -0.5070097975915075, 0.28413001265862264, -0.08675050283752314, -0.24467409621170844, -0.41694577090536517, 1.0258790006098797, 0.405193146734813, -0.0586421661173818, 0.9212618264637418, -0.26328746052713126, -0.39845589362573486, -0.5384672499808896, 0.3916855854190856],
        [0.04913000146027516, -0.08903328977414952, 0.588535600628521, -1.1778246388900422, 0.06530236414756152, -0.6895851589658972, -0.3170544295992793, -0.16172426089194852, 0.5373575801549221, -0.29791799857762813, -1.107957135891093, 0.47135244297456935, 0.21768148049900427, -0.23593768515738464, 1.0148818388550818, -0.5941101842640177, 0.18836238339454797, 0.43030678340944994, -0.7587583865940886, 0.21479334270760428, -0.018221322498107415, 0.19771014097182454, 0.032800075374510906, 0.5077650900171049, -0.4939777663839545, 0.7928372915344892, -0.8242446557061465, 0.1666856705030264, 0.3738638839180471, -0.4974813317163394],
        [-0.3092379682399805, -0.8257241609363286, -0.32718449957796303, 0.4295498501526622, -0.4964878500710745, 0.07224986212518829, 0.8783350329040731, -9.304086147560175e-05, 0.2194406509644401, 0.20811646539703918, 0.05156995691017095, 0.5431197332425655, -1.3569458409368662, -0.1717399969716542, -0.24904803912144569, -0.09349718144985403, -0.5572720374740894, -0.09534005738427945, -0.8874463616637418, -0.42744372282570237, 0.5312761190754971, -0.07871307834850508, -0.8008413197995926, -0.820583499903259, 0.49949948862172017, 0.7802673965413404, -0.46309906163434345, 0.7591818944881498, -0.246475167072791, -0.45049015882381993],
        [-0.8982612205546543, -0.2652446048773299, 0.3088769106876061, -0.5867249901152795, 0.33894345531811754, 0.48883492623394337, -0.7565826493495982, 0.20181300292639465, 0.58930023676157, 0.02296093527962588, 0.9129215250741347, 0.011297027911518223, -0.08584933795456355, 0.19425366677995692, -0.21743871694267203, 0.6991870779070771, 0.6356841236528482, 0.5272700572786904, 0.5375493306278608, -0.44365763491407684, 0.36588777808511774, -0.21410891925581577, -0.2716468983349283, 0.5582310740254225, 0.16254776699058346, -0.5021607378875459, -0.05518099063669771, -0.23217813584259595, 0.1191143915140164, 0.28907765757666964],
        [-0.9935830656673721, -1.4251082886137851, -0.5250730390052758, -0.3741991526185679, 0.09258353055397886, 0.2692059195150709, 0.5034649500756029, 0.5985301799146241, -0.6652743933712453, -0.788002099674986, -0.32123779733472896, 0.12157163091200904, 0.1362758924840553, -0.056903073920121616, 0.03995726296939095, 0.29776139084358755, 0.38270901976540556, -0.5544061973246908, -0.6745986299768844, 0.48304903327110416, 0.0782743084373605, 0.8784756322497788, 0.10626453476490313, -0.019578802663589356, 0.08981561169698327, 0.13393276377854468, -0.23121791786650553, -0.009669680474039141, -0.6926110278915216, 0.5837615501880853],
        [0.022985708648110337, 0.16457343476974506, -0.6316819422816659, -0.06649958905499914, 0.3495356719726326, -0.14482029320574738, -0.09153020607036721, -0.35484139451886915, -0.6100251377716979, -0.3295742248678114, -0.16365788117156685, -0.4983291488510578, -0.06397202369535696, 0.26364857358263705, 0.08016297719835352, 0.07463629495728358, 0.004895613533696497, 1.3462684265145888, 0.8118593062753197, 0.6412221586788643, -0.07675831088264701, -0.37915962776588696, -0.5257690393641985, -0.5655365101568965, 0.6232378298573648, 0.4724910840954778, -0.37573813209466345, 0.30522012246105973, -0.1615943496968125, -0.23106722264217622],
        [-0.10179872393617251, -0.6929655847735113, -0.39744339869164735, -0.2919868797853391, -0.6252606798278698, -0.0020403775500118515, -0.3195698765996147, -0.20009557827094615, -0.19945859336371533, 0.8145321542002854, -0.4381173863833871, 0.7732373364674892, -0.9215770148547306, -0.1436614893961224, 0.6661667346742192, -0.14184470263582583, -0.36655200234455815, -0.6076683544795602, -0.23188478767309853, -0.293619980062329, 0.40395003675033747, -0.31618840087461403, 0.978191239239768, 0.5411142168944587, 0.28778041902066853, -1.1678848666663968, -0.13954751791206824, -0.32869086729623626, 0.4705480169933437, -0.06067566571335742],
        [0.6435038150359718, -0.7061025067845981, 0.4924727846827786, -0.11365305705203571, 0.15759206840935996, 0.5068494609187594, -0.5077280831173209, 0.0918681762485736, 0.3465924684980366, 0.4385862409748693, -0.704546503454769, -0.23084778033589093, 0.15662094788200887, 0.1834067185973512, -0.340435256676193, -0.5234942689230859, 0.06347194749678386, -0.5084770897083328, 0.47144040579554386, 0.47172331521088023, 0.1262427519644463, 0.28570302694223626, -0.5156859881449751, -0.5891976395655757, -0.21894167908807735, -0.713220003481683, 0.9408903936463247, -0.3146805096110355, -0.3235091270861228, 0.1896779517283424],
    ])
        
    def __init__(self):
        rest_h = [] 
        rest_g = [self.CEC2017_C05_g1, self.CEC2017_C05_g2]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.sum(100 * (z[:-1]**2 - z[1:])**2 + (z[:-1] - 1)**2)
        return f_x
    
    @staticmethod
    def select_matrix(D, M):
        if M == 1: 
            if D == 10:
                return CEC2017_C05.M1_5_D10
            elif D == 30:
                return CEC2017_C05.M1_5_D30
            else:
                raise ValueError("Dimensión no soportada")
        elif M == 2:
            if D == 10:
                return CEC2017_C05.M2_5_D10
            elif D == 30:
                return CEC2017_C05.M2_5_D30
            else:
                raise ValueError("Dimensión no soportada")
    
    @staticmethod
    def CEC2017_C05_g1(x):
        M = CEC2017_C05.select_matrix(D, 1)
        y = generate_z_y(x, CEC2017_C05.o[:D], 'matrix_multiply', M)
        return np.sum(y**2 - 50 * np.cos(2 * np.pi * y) - 40)
    
    @staticmethod
    def CEC2017_C05_g2(x):
        M = CEC2017_C05.select_matrix(D, 2)
        w = generate_z_y(x, CEC2017_C05.o[:D], 'matrix_multiply', M)
        return np.sum(w**2 - 50 * np.cos(2 * np.pi * w) - 40)
    
class CEC2017_C06(Problem):
    
    SUPERIOR = np.array([20] * D)
    INFERIOR = np.array([-20] * D)
    
    o = np.array([
        -0.7421809640567645,     5.887153544776108,     6.497040121168865,     9.12650409650167,     9.30888300234129,
        7.074084547382917,     -9.490414497470463,     -4.284433792373623,     -4.293661169284415,     -8.67718072410799,
        2.6313485891986215,     -2.0648468003601828,     6.382896030016141,     -8.094316187504926,     -6.198418796635236,
        -9.495210517395709,     -9.798821345316018,     -9.732554181728352,     -4.074169798764904,     -7.743476042713255,
        -0.8657876308007513,     0.23446967490902892,     -0.42190024246320057,     -4.020480091151331,     -9.333166796463345,
        5.739500476309459,     9.196201986787639,     5.150564443877396,     4.123418072458742,     -4.180896270339733,
        3.9238460308311716,     1.7228261736984294,     -3.182262229717228,     1.2960014210892972,     -7.851168168202176,
        9.202825770469907,     3.382958840148941,     3.9504334829550363,     -7.0061813176998715,     -5.937347233132906,
        0.01787785481270987,     2.588870795940421,     9.26864649127224,     9.975692619872877,     -5.0256175018191795,
        2.6062783028405754,     -9.530718976588767,     -3.713354403115945,     5.486351301324268,     5.410702364131193,
        3.534157585266888,     -8.663284186853684,     -0.04189341281980852,     4.092182861579099,     -0.8495560387387897,
        4.138869432930042,     2.410242079398035,     4.10659464024919,     3.7634138939154838,     2.8554303002934205,
        -9.291784946463133,     -2.970970565489357,     -5.121958717261991,     -2.144114100170178,     -9.005067746461561,
        -3.138318038057168,     -3.4660868369446636,     -1.124475804492274,     -7.541133131762699,     5.953983733703987,
        -3.7536059710079233,     7.877841955036274,     -1.4720615658666087,     -2.5524597112924097,     7.898933169847172,
        8.060961285817474,     -1.3473080579956118,     9.851987716595513,     0.27087129448504044,     3.989002079813659,
        0.29742225404269185,     -6.25454137273956,     -7.274421523164179,     -0.9197726703864273,     4.624362760835121,
        -2.7436727850044074,     9.77530929102965,     9.085503174981344,     5.280094634029419,     0.05805089355926718,
        6.6927336251450065,     -5.7564291341459235,     8.929853628721204,     7.540722503181236,     -1.8851528894817378,
        -1.2588273451468996,     -9.164691580162941,     6.405260782066392,     -2.484887247073986,     4.642306405974082,
    ])
    
    def __init__(self):
        rest_h = [
            self.CEC2017_C06_h1, self.CEC2017_C06_h2, self.CEC2017_C06_h3, self.CEC2017_C06_h4, 
            self.CEC2017_C06_h5, self.CEC2017_C06_h6
        ]
        rest_g = []
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.sum(z**2 - 10 * np.cos(2 * np.pi * z) + 10)
        return f_x
    
    @staticmethod
    def CEC2017_C06_h1(x):
        z = generate_z_y(x, CEC2017_C06.o[:D])
        return np.sum(- z * np.sin(z))
    
    @staticmethod
    def CEC2017_C06_h2(x):
        z = generate_z_y(x, CEC2017_C06.o[:D])
        return np.sum(z * np.sin(np.pi * z))
    
    @staticmethod
    def CEC2017_C06_h3(x):
        z = generate_z_y(x, CEC2017_C06.o[:D])
        return np.sum(- z * np.cos(z))
    
    @staticmethod
    def CEC2017_C06_h4(x):
        z = generate_z_y(x, CEC2017_C06.o[:D])
        return np.sum(z * np.cos(np.pi * z))
    
    @staticmethod
    def CEC2017_C06_h5(x):
        z = generate_z_y(x, CEC2017_C06.o[:D])
        return np.sum(z * np.sin(2 * np.sqrt(np.abs(z))))
    
    @staticmethod
    def CEC2017_C06_h6(x):
        z = generate_z_y(x, CEC2017_C06.o[:D])
        return np.sum(- z * np.sin(2 * np.sqrt(np.abs(z))))
    
class CEC2017_C07(Problem):
    
    SUPERIOR = np.array([50] * D)
    INFERIOR = np.array([-50] * D)
    
    o = np.array([
        2.0517059911673226,     6.611898499313295,     0.0803239618617031,     -6.504129402201655,     -5.687439624423389,
        2.0286207470664497,     7.852137163094191,     -9.166642135561126,     1.5834697709377643,     5.60791809350963,
        -2.8344654601274026,     -3.029194322762258,     2.092757901879507,     6.257046520346446,     -5.129533509817,
        -2.2933093534680378,     -0.9641804586446607,     5.354780049764345,     0.40494600952403204,     0.3393440584751559,
        -2.512777192859847,     9.627564819560998,     -2.7702863536374345,     -8.626475027132287,     6.468280921041444,
        -2.066026454936887,     8.846565997737954,     4.152261289179178,     5.343126805447323,     -6.632227847345986,
        -9.60993288678408,     0.3270501902563048,     5.320388367975449,     -8.534176258696903,     6.725360525031675,
        -4.739225472512092,     -5.106482933877958,     -3.551437104794717,     2.220705658997357,     2.2609275639313644,
        5.820215446102113,     0.9275842107356098,     -2.096918332264992,     8.911829671477804,     8.934321097907873,
        -1.6000057603596947,     -3.85492332228128,     -0.28594217997049043,     4.4987304912593125,     -6.462848204143472,
        3.1452326767256107,     6.672914011346094,     -4.177845198250463,     -8.8276068634708,     2.7999418912381575,
        6.0302153763838255,     -5.487950097869083,     4.257231459463966,     -3.7497353417382406,     7.5796853653270375,
        -0.2633568898671168,     -0.1622418284889271,     -9.802034671221215,     -3.956644266810687,     3.589352250377761,
        5.968120576947662,     0.26157450670400095,     4.242733285887619,     1.8814218732616403,     -0.6390198972700851,
        4.734608769681568,     0.7031628456017796,     6.346087467438274,     7.737426203134724,     8.23249607721123,
        -6.592205156161183,     4.289991460670539,     7.699676435625111,     9.461764518973084,     1.4605665148908642,
        2.9567984680995565,     -0.5166346934564174,     7.010163991103358,     -7.6733632929116435,     -3.3526362459544874,
        3.1313353324868345,     -3.688806683787429,     7.259190884353334,     -7.86262871265391,     5.035517762823517,
        -8.052424354791956,     3.1884061719744423,     2.245258989239593,     7.264737115165062,     5.457537430368337,
        -5.705736447366199,     1.9082723158601986,     -1.669201836578445,     1.0210991158477256,     -2.057577464900511,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C07_h1, self.CEC2017_C07_h2]
        rest_g = []
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.sum(z * np.sin(z))
        return f_x
    
    @staticmethod
    def CEC2017_C07_h1(x):
        z = generate_z_y(x, CEC2017_C07.o[:D])
        return np.sum(z - 100 * np.cos(0.5 * z) + 100)
    
    @staticmethod
    def CEC2017_C07_h2(x):
        z = generate_z_y(x, CEC2017_C07.o[:D])
        return np.sum(-z - 100 * np.cos(0.5 * z) + 100)
    
class CEC2017_C08(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -2.611167284927289,     7.094968773812095,     6.868316612371682,     -9.633175326645745,     -7.5511893987970975,
        8.994637373644633,     -9.359848079439406,     -8.236993360030498,     -6.5814425143948245,     9.864588407763122,
        -1.6972783755492777,     -2.5544678701398738,     -3.1411702645394683,     -0.06659529721289559,     0.06737863694150192,
        9.50881214381532,     -3.2940619232073365,     -6.08035596251489,     -8.172177453903887,     -8.087247000522886,
        -2.3064289005035254,     0.706169274766058,     8.488337517726798,     -5.529403972804994,     -4.490360377304166,
        -5.191538689062172,     -0.5333654720978132,     0.9934170314045936,     3.007037402324695,     -4.64907541535426,
        -6.614677143204048,     1.4835281161568314,     -3.3261367718976604,     -2.2512502161247028,     1.8574350980556513,
        -6.762868745646196,     0.9095723629247505,     3.9871623113736394,     0.8936444358429103,     -3.479112803667592,
        -8.641130799586483,     -4.107703550532746,     -5.081673580948305,     1.3067268961978264,     9.289468611024002,
        7.663299268203762,     -4.52701178101798,     -0.6191488630164912,     -4.214577685506454,     3.7855845054879733,
        -1.6687651923321116,     9.899209891855904,     4.2513588616595435,     0.7749162408552372,     -1.5497107914141885,
        -0.4724942378746455,     -8.16026908254994,     -5.813217063717255,     9.018865860201277,     6.804334812049277,
        -6.173413156319343,     -0.7470799683689968,     5.693299652465001,     -8.547126905640848,     -4.901854350412689,
        -2.924679017116163,     5.219093237295667,     2.9764650781409827,     -4.5883194989800185,     5.8824193145546655,
        8.171562739279263,     4.654341101700513,     -7.929881511318813,     3.9954795681047024,     1.6297666285754353,
        -8.45810555970629,     -1.1064042592973813,     -7.91590327631188,     0.4980727548836601,     -4.517600200153911,
        -0.9981820430113721,     -8.183944168638945,     7.4892279360125436,     -1.2552379822793487,     5.662141488756422,
        -3.7618379625863207,     2.7106056825746006,     -5.7406645274789225,     -5.02384987390905,     0.7340291541118109,
        -0.021319436666614067,     5.987819311747094,     9.508731167027303,     -4.459514110839217,     -5.139507631664612,
        0.8683421683355377,     -7.641608559174681,     3.822760787522242,     -9.408081401252966,     -1.0507486909093515,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C08_h1, self.CEC2017_C08_h2]
        rest_g = []
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.max(z)
        return f_x
    
    @staticmethod
    def CEC2017_C08_h1(x):
        z = generate_z_y(x, CEC2017_C08.o[:D])
        y = z[::2]  # y_l = z_{2l-1} for l = 1, ..., D/2
        return np.sum([np.sum(y[:i+1]**2) for i in range(len(y))])

    @staticmethod
    def CEC2017_C08_h2(x):
        z = generate_z_y(x, CEC2017_C08.o[:D])
        w = z[1::2]  # w_l = z_{2l} for l = 1, ..., D/2
        return np.sum([np.sum(w[:i+1]**2) for i in range(len(w))])
    
class CEC2017_C09(Problem):
    
    SUPERIOR = np.array([10] * D)
    INFERIOR = np.array([-10] * D)
    
    o = np.array([
        -5.098411775186193,     -9.033459218858331,     -4.118274098645682,     -9.390828250798029,     5.765512744319432,
        8.436087698598957,     -7.497081777465477,     2.9309661352721683,     -0.3048938940357644,     4.480019845407535,
        -9.273018371106321,     -2.6338076393056724,     4.608632235364178,     7.632786387913519,     4.753487679566156,
        -1.3354462989474776,     2.472887642996664,     -4.06566036767339,     3.170230738894146,     -8.785994995377195,
        7.133225653302464,     -0.22298917664094375,     -6.166276166579252,     6.386817750843093,     -8.735163367429333,
        4.324321332465988,     -1.2377511971534823,     2.273710441216126,     4.8930534740616345,     4.186087596400954,
        -0.5697863355969304,     -6.762292238964078,     -3.9165727277638958,     6.758781133285424,     8.67270609019134,
        8.669234894566998,     -9.94071639382149,     -1.1212022286916756,     -9.732233284778811,     -5.53010991735615,
        5.611922030588625,     0.9287610347338315,     -4.0870708862835965,     1.0829202349754379,     -0.42208704279968856,
        5.474313395033274,     -4.687566597573158,     -3.280323146818594,     6.90143577085755,     -9.768207493112618,
        -9.219492669829776,     -5.638404868847773,     -8.77652850548933,     7.649253475120613,     3.0561100949018005,
        -7.646864428414448,     -5.178318567523997,     -5.4736924442416,     3.0641611382053586,     -6.062761662709313,
        -3.6882619758825097,     -0.6021385074454155,     1.9033470390878744,     7.232066077036713,     -7.965393456891725,
        -2.2848609367586743,     9.551379630711128,     -0.8540315559618765,     -8.345751919848787,     -3.513373991293596,
        3.303022161528599,     -8.088507478768586,     3.5316664493696788,     1.5032428190129572,     -9.747158425469157,
        1.249766133599577,     -3.6532729955317578,     2.9541875594634153,     4.796734130676715,     9.449752161377369,
        -0.5262508536646511,     -8.077114186107615,     -5.590876149834624,     7.136022608525742,     -5.024323395998471,
        -2.756205453187368,     -5.35491739104506,     -0.6671694332663929,     1.3496547201616202,     -4.701684390922541,
        -2.8036534430159676,     -8.998977647245551,     4.760068196053664,     9.27113855453176,     -0.3646464073581246,
        -3.5601010157292663,     -5.212699701848638,     -0.3750514404901484,     -2.1200034874835616,     -6.591296632832801,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C09_h1]
        rest_g = [self.CEC2017_C09_g1]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.max(z)
        return f_x
    
    @staticmethod
    def CEC2017_C09_g1(x):
        z = generate_z_y(x, CEC2017_C09.o[:D])
        w = z[1::2]  # w_l = z_{2l} for l = 1, ..., D/2
        return np.prod(w)
    
    @staticmethod
    def CEC2017_C09_h1(x):
        z = generate_z_y(x, CEC2017_C09.o[:D])
        y = z[::2]  # y_l = z_{2l-1} for l = 1, ..., D/2
        return np.sum([(y[i]**2 - y[i+1]**2)**2 for i in range(len(y)-1)])

class CEC2017_C10(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        31.472368639317892,     40.57919370756193,     -37.3013183706494,     41.337585613901936,     13.23592462254095,
        -40.245959500059044,     -22.150178113295162,     4.688151920498385,     45.75068354342976,     46.48885351992766,
        -34.23869183224517,     47.05927817606157,     45.716694824294564,     -1.462435127715878,     30.028046888880013,
        -35.81136613727847,     -7.8238717373724995,     41.57355251890671,     29.22073295595544,     45.949242639290304,
        15.574069915658683,     -46.428832142581044,     34.91293058687771,     43.39932477575505,     17.873515485777347,
        25.774013057833344,     24.313246812491613,     -10.777298046583184,     15.547789017755662,     -32.881331218843826,
        20.60460880196088,     -46.81671536225793,     -22.307701503911005,     -45.382860936884605,     -40.286821876415246,
        32.34578283272927,     19.482862297581704,     -18.29005199391395,     45.0222048838355,     -46.555391949709126,
        -6.125564034360174,     -11.844154290699159,     26.551678814900242,     29.519990113706314,     -31.31273954456214,
        -1.0235604211768958,     -5.441379928910052,     14.631301011126467,     20.936483085807254,     25.468668198236088,
        -22.39749230014216,     17.970267685367475,     15.509800397384069,     -33.73882648053694,     -38.10023184416234,
        -0.16359480178570607,     45.97439585160811,     -15.96142733338668,     8.526775097977733,     -27.618806050886302,
        25.12670593056528,     -24.490488454073088,     0.5957051665142359,     19.907672265668594,     39.09032525357985,
        45.92914252054443,     4.721552996380311,     -36.13755571713209,     -35.070599444094256,     -24.249174587626353,
        34.07172559836626,     -24.571782102846896,     31.42848260688163,     -25.64750312750107,     42.92636231872278,
        -15.001623401519126,     -30.34047495687918,     -24.891614202396894,     11.604467614663918,     -2.6711151097270758,
        -14.834049293700325,     33.08286278962909,     8.526409115272429,     4.972360829113953,     41.71936638298101,
        -21.416098117962644,     25.72002291107212,     25.372909427849535,     -11.955415302464331,     6.782164072522114,
        -42.41457104369364,     -44.60498813333928,     3.0797553008972685,     27.91672301020111,     43.4010684229183,
        -37.00937915262699,     6.882366087219275,     -3.0609358941794156,     -48.80979304987586,     -16.287735560111848,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C10_h1, self.CEC2017_C10_h2]
        rest_g = []
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.max(z)
        return f_x
    
    @staticmethod
    def CEC2017_C10_h1(x):
        z = generate_z_y(x, CEC2017_C10.o[:D])
        return np.sum([(np.sum(z[:i+1]))**2 for i in range(D)])
    
    @staticmethod
    def CEC2017_C10_h2(x):
        z = generate_z_y(x, CEC2017_C10.o[:D])
        return np.sum([(z[i] - z[i+1])**2 for i in range(D-1)])
    
class CEC2017_C11(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        2.115802393048103,     -3.0358197506730944,     5.059229179954919,     -1.5194465269568198,     -7.598343558590342,
        -8.561863482634571,     -8.922370681376268,     -7.723172260406295,     8.792825156556866,     7.496108312267847,
        -6.608252328391382,     -9.431698427715208,     2.645388402605061,     1.9292888522282041,     -1.1489638057451117,
        -3.0212986833031863,     -7.691986992759978,     1.1377664521597879,     -2.655942901747059,     -6.640512042320774,
        9.83501887099457,     -2.101584407318504,     -1.1527528422484643,     5.565028468783652,     -0.6937117951486584,
        3.7964775422776835,     -9.134487633598106,     7.260331784104363,     -3.249836498553657,     3.9715392820069084,
        -3.7492821167867874,     -6.115618988386156,     5.588451078660658,     7.197433600326693,     -5.259138714399358,
        0.789439493513326,     4.624443668631065,     3.181242544119037,     -8.849777477137888,     -1.6980138671421052,
        4.040692856508434,     -2.333308359505841,     -9.658711034525364,     6.5921725989799675,     -7.681715112297294,
        -0.940239952284017,     2.407244396925849,     -5.438577416897359,     -2.1552558738652294,     -2.903609405301644,
        -7.460736927138321,     0.19833405349974065,     -9.026787512385088,     0.7672823859416695,     -6.428451862119504,
        3.9894468090719,     9.690494101887698,     -2.2381328736013595,     4.327657525702236,     1.067498182356232,
        -5.870113952910985,     -8.62652172323195,     3.079132003062753,     8.738061348038404,     0.9563758887569307,
        -8.156486486528237,     9.963567750724884,     -8.76793265195953,     4.441232601425632,     -0.3782313381147908,
        -0.32419659163544523,     4.8190369113747025,     6.0302782205909295,     3.3236550970501177,     8.316401364380742,
        7.347546721988877,     1.95033608164219,     8.045598630680196,     7.471324793560623,     -8.178693468871227,
        -5.86585611954789,     -8.67084505379681,     -2.317293705911987,     5.6212843608715595,     4.219330426594695,
        2.8953870468221687,     -9.369062657321885,     3.4736787927282275,     -6.0624456285343875,     0.6041138611814993,
        -1.7619901586989233,     -8.654489599470558,     8.425926027294992,     0.9868625566613076,     5.507148260175377,
        -7.358435584729426,     -4.997357202531225,     -1.6383800784248557,     -7.047066151693311,     7.901203345405477,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C11_h1]
        rest_g = [self.CEC2017_C11_g1]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        z = generate_z_y(x, self.o[:D])
        f_x = np.sum(z)
        return f_x
    
    @staticmethod
    def CEC2017_C11_g1(x):
        z = generate_z_y(x, CEC2017_C11.o[:D])
        return np.prod(z)
    
    @staticmethod 
    def CEC2017_C11_h1(x):
        z = generate_z_y(x, CEC2017_C11.o[:D])
        return np.sum([(z[i] - z[i+1])**2 for i in range(D-1)])
    
class CEC2017_C12(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C12_h1]
        rest_g = [self.CEC2017_C12_g1]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        y = generate_z_y(x, self.o[:D])
        f_x = np.sum(y**2 - 10 * np.cos(2 * np.pi * y) + 10)
        return f_x
    
    @staticmethod
    def CEC2017_C12_g1(x):
        y = generate_z_y(x, CEC2017_C12.o[:D])
        return 4 - np.sum(np.abs(y))
    
    @staticmethod
    def CEC2017_C12_h1(x):
        y = generate_z_y(x, CEC2017_C12.o[:D])
        return np.sum(y**2) - 4
    
class CEC2017_C13(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])

    
    def __init__(self):
        rest_h = []
        rest_g = [self.CEC2017_C13_g1, self.CEC2017_C13_g2, self.CEC2017_C13_g3]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        y = generate_z_y(x, self.o[:D])
        f_x = np.sum([100 * (y[i]**2 - y[i+1]**2)**2 + (y[i] - 1)**2 for i in range(D-1)])
        return f_x
    
    @staticmethod
    def CEC2017_C13_g1(x):
        y = generate_z_y(x, CEC2017_C13.o[:D])
        return np.sum(y**2 - 10 * np.cos(2 * np.pi * y) + 10) - 100
    
    @staticmethod
    def CEC2017_C13_g2(x):
        y = generate_z_y(x, CEC2017_C13.o[:D])
        return np.sum(y) - 2 * D
    
    @staticmethod
    def CEC2017_C13_g3(x):
        y = generate_z_y(x, CEC2017_C13.o[:D])
        return 5 - np.sum(y)

class CEC2017_C14(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C14_h]
        rest_g = [self.CEC2017_C14_g]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        y = generate_z_y(x, self.o[:D])
        term1 = -20 * np.exp(-0.2 * np.sqrt(np.sum(y**2) / D))
        term2 = 20 - np.exp(np.sum(np.cos(2 * np.pi * y)) / D)
        f_x = term1 + term2 + np.e
        return f_x
    
    @staticmethod
    def CEC2017_C14_g(x):
        y = generate_z_y(x, CEC2017_C14.o[:D])
        return np.sum(y[1:]**2) + 1 - np.abs(y[0])
    
    @staticmethod
    def CEC2017_C14_h(x):
        y = generate_z_y(x, CEC2017_C14.o[:D])
        return np.sum(y**2) - 4

class CEC2017_C15(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C15_h]
        rest_g = [self.CEC2017_C15_g]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        y = generate_z_y(x, self.o[:D])
        f_x = np.max(np.abs(y))
        return f_x
    
    @staticmethod
    def CEC2017_C15_g(x):
        y = generate_z_y(x, CEC2017_C15.o[:D])
        return np.sum(y**2) - 100 * D
    
    @staticmethod
    def CEC2017_C15_h(x):
        y = generate_z_y(x, CEC2017_C15.o[:D])
        f_x = np.max(np.abs(y))
        return np.cos(f_x) + np.sin(f_x)

class CEC2017_C16(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C16_h]
        rest_g = [self.CEC2017_C16_g]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        y = generate_z_y(x, self.o[:D])
        f_x = np.sum(np.abs(y))
        return f_x
    
    @staticmethod
    def CEC2017_C16_g(x):
        y = generate_z_y(x, CEC2017_C16.o[:D])
        return np.sum(y**2) - 100 * D
    
    @staticmethod
    def CEC2017_C16_h(x):
        y = generate_z_y(x, CEC2017_C16.o[:D])
        f_x = np.sum(np.abs(y))
        return (np.cos(f_x) + np.sin(f_x))**2 - np.exp(np.cos(f_x) + np.sin(f_x)) - 1 + np.exp(1)

class CEC2017_C17(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    
    def __init__(self):
        rest_h = [self.CEC2017_C17_h]
        rest_g = [self.CEC2017_C17_g]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        y = generate_z_y(x, self.o[:D])
        f_x = 1/4000 * np.sum(y**2) + 1 - np.prod(np.cos(y / np.sqrt(np.arange(1, D+1))))
        return f_x
    
    @staticmethod
    def CEC2017_C17_g(x):
        y = generate_z_y(x, CEC2017_C17.o[:D])
        dataSum = np.sum(y**2)
        return -np.sum(np.sign(np.abs(y) - (np.tile(dataSum, y.shape) - y**2) - 1)) + 1
    
    @staticmethod
    def CEC2017_C17_h(x):
        y = generate_z_y(x, CEC2017_C17.o[:D])
        return np.sum(y**2) - 4 * D

class CEC2017_C18(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])

    def __init__(self):
        rest_h = [self.CEC2017_C18_h1]
        rest_g = [self.CEC2017_C18_g1, self.CEC2017_C18_g2]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        y = generate_z_y(x, self.o[:D])
        z = np.where(np.abs(y) < 0.5, y, 0.5 * np.round(2 * y))
        f_x = np.sum(z**2 - 10 * np.cos(2 * np.pi * z) + 10)
        return f_x
    
    @staticmethod
    def CEC2017_C18_g1(x):
        y = generate_z_y(x, CEC2017_C18.o[:D])
        return 1 - np.sum(np.abs(y))
    
    @staticmethod
    def CEC2017_C18_g2(x):
        y = generate_z_y(x, CEC2017_C18.o[:D])
        return np.sum(y**2) - 100 * D
    
    @staticmethod
    def CEC2017_C18_h1(x):
        y = generate_z_y(x, CEC2017_C18.o[:D])
        h1 = np.sum([100 * (y[i]**2 - y[i+1]**2) for i in range(len(y)-1)])
        h2 = np.prod([np.sin(np.pi * (y[i] - 1))**2 for i in range(len(y))])
        return h1 + h2
    
class CEC2017_C19(Problem):
    SUPERIOR = np.array([50] * D)
    INFERIOR = np.array([-50] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])

    def __init__(self):
        rest_h = []
        rest_g = [self.CEC2017_C19_g1, self.CEC2017_C19_g2]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        y = generate_z_y(x, self.o[:D])
        f_x = np.sum(np.abs(y)**0.5 + 2 * np.sin(y**3))
        return f_x
    
    @staticmethod
    def CEC2017_C19_g1(x):
        y = generate_z_y(x, CEC2017_C19.o[:D])
        return np.sum(-10 * np.exp(-0.2 * np.sqrt(y[:-1]**2 + y[1:]**2))) + (D - 1) * 10 / np.exp(5)
    
    @staticmethod
    def CEC2017_C19_g2(x):
        y = generate_z_y(x, CEC2017_C19.o[:D])
        return np.sum(np.sin(2 * y)**2) - 0.5 * D

class CEC2017_C20(Problem):
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])

    def __init__(self):
        rest_h = []
        rest_g = [self.CEC2017_C20_g1, self.CEC2017_C20_g2]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        y = generate_z_y(x, self.o[:D])
        f_x = 0.5 + np.sum(
            [(np.sin(np.sqrt(y[i]**2 + y[(i+1) % D]**2))**2 - 0.5) / 
             (1 + 0.001 * (y[i]**2 + y[(i+1) % D]**2)**2) 
            for i in range(D)]
        )
        return f_x
    
    @staticmethod
    def CEC2017_C20_g1(x):
        y = generate_z_y(x, CEC2017_C20.o[:D])
        g1 = np.cos(np.sum(y))**2 - 0.25 * np.cos(np.sum(y)) - 0.125
        return g1
    
    @staticmethod
    def CEC2017_C20_g2(x):
        y = generate_z_y(x, CEC2017_C20.o[:D])
        g2 = np.exp(np.cos(np.sum(y))) - np.exp(0.25)
        return g2

class CEC2017_C21(Problem):
    
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    M10 = np.array([
        [-1.4750691585532323, -0.5745205005115123, -0.005699772438594958, 0.6648210730157429, -0.1041634598061256, -0.8978855297957111, -0.901994204541452, -0.6065324100090661, -0.4063251172471228, 0.15528244331830426],
        [0.5592150245095672, 0.04993662795408019, 0.4215715110001431, 0.8658026703900705, 0.6947904462259192, -0.18507116388982225, -0.022188704511750743, -0.649218872652057, 0.07356091714854926, -0.7961176305125455],
        [0.6352998982037079, 0.5943504059660697, 1.103253878964802, -1.1285189770235082, 0.7046494430751651, 0.2755757486743495, -1.0399669162892367, 0.11685698852943777, -0.32902335058747467, 0.07790036419589119],
        [-0.35941283248531275, 0.37082704554158386, -0.5271046483443762, -0.26665593788738984, -0.5141977194125844, 0.5821194001685648, -0.047299261268575435, -0.46312553098784154, -0.10196330326631606, -0.9522639457792393],
        [-0.5839720120889139, 1.7714876607340784, 0.013650083503154053, 0.3212225620402597, 0.7904281214026975, 0.4093923866971973, 0.33744753474799605, 0.5942128150118153, -0.15480530100758425, -0.5237685825508689],
        [-0.17838596502167076, 0.24992500534286521, -0.17316389205861768, -0.005036558084014708, -0.17668981043919074, 0.282386956005954, -1.0946510657454087, 0.45147932173029537, 1.0574055589046905, -0.0074876994077884285],
        [-0.5913243068007854, -0.27049755413083576, -0.3130389318979534, 0.6376303913429255, 1.2741644739500224, 0.7811212288227438, 0.1820711612625297, -0.05528506550771772, 0.27980292347560093, 0.055727088016825216],
        [-0.20277428932485703, 1.0079304172848664, 0.01437318812037941, 0.14803052734314798, 0.45096233182274637, -0.5822593030942272, 0.452115990237956, -0.8708036252941136, 0.4357530932226235, 0.3651693399025321],
        [-0.9026689569470502, 0.17486172336358063, -0.27450550855066735, -0.3661547399904748, 0.6032348252987877, -0.762354545526245, 0.9197863043444101, -0.06739961818174695, 0.5329960368512198, -0.9498570741645186],
        [0.3809013727921987, 0.8270471805962801, -0.9297598191669905, -0.5709424218088751, 1.0158877843868521, -0.39993664335293944, -0.7407173804723235, 0.40730997988162376, -0.3708088890828746, -0.193514070829618],
    ])
    M30 = np.array([
        [-0.5159828783208829, -0.461752601502956, -0.47478430536873406, 0.30906472546822983, 0.0821092546309288, 0.12399425682320928, -0.27213943183862804, -0.6066294974432846, 0.777839341246011, -0.05737011470108, -0.09789520372128557, 0.17520766757008754, 0.15816790642936068, 0.11980961854461003, -0.468153550081146, -0.3620869598650572, -0.4886255076540601, 0.23469980700329732, 0.6450256970330783, 0.49857302334610387, 0.06300037478185166, 0.5766729714557522, 0.0934670738279128, -0.0882071137775379, 0.8805338407901566, 0.37503612382206475, 0.48038544171877795, 0.6074904320527752, -0.06333768975160145, -0.44730035615863784],
        [0.1880754930560265, -0.2720272048289167, 0.1869512122668153, 0.0438983891578362, -0.23549495408004903, -0.6163739419294972, 0.060500463921530634, 0.2676085722425896, 0.5259478346689614, 0.7720494183015834, 0.21960696988918912, 0.15824113495025177, 0.2970151280048526, -0.20379644304513045, 0.641572164969781, -0.418148640182776, 0.22926624189809053, 0.0612419752999645, 0.06791073974691907, -0.032319295885730404, 0.26292640093486397, -0.6480198792924795, 0.2810103744453979, 0.14392792999580045, -0.004528918141343957, -0.005930953273363987, 0.13708107902261224, 0.4968959791866978, -0.10313184784018095, -0.0894528902124122],
        [0.08677860222719772, -0.13415840828119555, 0.5277280418242739, 0.7478122408419924, -0.3125793907217645, 0.38174655051775797, 0.019187525091114474, -0.02240431729236165, -0.5672989058308923, 0.5492354632829972, 0.03655749312790477, -0.39925649810781727, 0.3782977840936688, -0.2512456032672451, -0.3288950029473213, 0.046264440515645315, -0.17471382325041543, -0.650841654577202, -0.26557166002512683, 0.1268686931172478, -0.7752632273386695, 0.3580039025191851, -0.12818030147444026, 0.32101908684569186, 0.15687161215857892, 0.13220017059437858, -0.49611842100609715, -0.16172585090258718, -0.21068271845999856, 0.06731164664251577],
        [-0.0725281242535927, 0.03923363692533671, -0.08451736708855691, 0.911569016239978, 0.27124084181504265, 0.10678488576778121, 0.35154106042529, -0.10959240726719924, -0.3567424184683352, -0.05139206973406582, -0.6458723265904243, -0.17894980229733576, -0.07928189820709317, -0.5534977733755848, -0.3566608623377477, -0.8775717680937246, 0.1069956028157045, -0.2962152465741139, 0.28338354399572724, -0.5383563973668849, 0.2703419660432148, -0.16167942534080176, 0.5163599860818278, -0.5075463963316947, -0.42222755988115773, -0.1523082265251643, 0.3179043033149148, 0.15263148427625017, 0.3186760724944154, -0.007851425697908351],
        [-0.31085059906248025, 0.10773533790008274, 0.21073657512338226, -0.10389714926279825, 0.5006811426159044, 0.6623146979279007, 0.18396874003818742, 0.4617016641762331, -0.5207289159776659, -0.459362028051465, 0.2248991081068287, 0.5680604512423484, 0.3580388165911977, -0.5972146208123865, -0.10433733437648485, -0.014334357116532304, 0.2136845387221096, 0.02439187568807852, 0.23838451766550403, 0.8003915687344867, 0.17872570272597937, -0.5990516448807318, 0.07468653669771103, -0.11529657547119215, -0.08040488050924052, -0.15763218727718675, 0.045919794915371376, 0.3255337153852049, 0.031667282607729774, -0.3317721297284485],
        [0.2882048920773465, -0.14256137622938297, -0.019521164467690172, 0.07084318546010558, -0.09866229014877709, -0.05483664131209329, 0.24968096019471414, -0.6727823205366663, 0.4586423492380458, 0.3840739208227191, 0.10221117432596505, 0.6214137152153121, -0.35242425225098173, -0.5147009154991066, -0.2432463255125819, 0.41179287638035006, -0.315762865887315, -0.3291344064387964, 0.1265193422046716, 0.4787872505741223, -0.14613755535479894, -0.26570943449791184, -0.005485711613561428, 0.49740982236653974, -0.7456385848841535, 0.23704600300129444, 0.3151189427848705, -0.8387615933341264, -0.3854546723830116, -0.022971162158202607],
        [-0.14020032347982048, -0.4683963350040242, -0.05914086143651759, -0.11713500626369226, -0.5481583954724735, 0.4149081840406875, -0.4826214863595243, 0.22391503154961157, -0.09275195276145468, 0.1934587155705878, -0.6390135722335628, 0.36082151781342514, 0.7102948755837191, 0.6954746868245145, 0.2404309981725236, 0.12588166150775848, -0.21052278602763508, 0.044744177933926085, 0.5293182558732803, 0.004181320427426083, -0.06761409605410526, -0.21107664286819583, 0.05833511988247723, 0.0032020184528783885, -0.3345616807067034, 0.5524538826202322, -0.3721275561601629, -0.2637795025196129, -0.12107475788566177, 0.3432266282645529],
        [-0.7154165286229367, 0.31528103197398066, 0.01647640590023225, 0.39882899107397285, -0.14415437963892944, -0.2500593216791629, -0.16311945583262297, 0.5067356779768416, -0.1590560467883433, -0.18667036572780393, 0.12909690348449493, -0.5777050366627182, 0.38790818556587925, -0.03455420420866631, 0.2521998313698651, 0.2522275885761841, 0.25097650987815523, 0.21256365493018475, 0.4406863450775138, -0.07819611927891953, 0.07587133068400234, 0.2632134257544718, -0.6415440320038228, 0.05124995001626026, -0.1767414436297925, -0.24246914260979086, -0.338571847289742, 0.21483495449255388, -0.3229255888333219, -0.07199864307599385],
        [-0.39160242358042946, -0.16134530371710776, 0.46555336270706227, -0.3394623581586844, 0.5031305235512509, 0.7314391012509215, 0.1266883508642425, 0.44419263204459114, -0.2808593742641189, 0.5417972586231993, 0.1843965718350277, -0.35788259443761905, -0.8193905513057221, -0.10780914617362286, -0.39656004845784765, -0.27761678053703087, -0.09398645818794296, 0.43928559595807837, 0.20775315827831287, -0.6077885105664197, -0.5023029903313124, -0.1333465715662987, -0.47768154310538624, 0.17087315244251583, 0.45435187275830496, 0.510020353660775, 0.0949749764287343, 0.019739974727221665, -0.008828707869123292, 0.2232835385643469],
        [-0.6610737817430957, 0.21235972545049517, 0.30368026193672504, 0.20764504955380048, -0.13615718991195438, 0.03281183661376963, 0.4514937186351503, -0.054869371231186403, 0.21071412408577866, -0.09345912666162204, -0.1659068934720344, 0.41299528263039714, 0.45405139507149, 0.22801776609787025, -0.642380501557519, -0.319853912356299, 0.719252468933344, -0.3522194712129756, -0.565583771287912, 0.3341465443900812, 0.6068260177923867, -0.025589002436567265, -0.26337562864346536, 0.00690392328041875, 0.027780261823982532, 0.07485393534252438, 0.5057436307208727, -0.36674580232138426, -0.36471257533260526, 0.7928234991686849],
        [0.8065523814719902, -0.36943762380588585, -0.21311920492789346, 0.41778489674363434, 0.35019288619015626, -0.18998622317609343, -0.23301566911104613, 0.31711875996214256, 0.1370340917183983, -0.3749346254952983, -0.3373056707458486, -0.16046636870617761, -0.9643655176269585, 0.24705778517160132, 0.03645246961244829, 0.13329625551075858, -0.05149119011253189, -0.40643463965352095, -0.16682553579856557, 0.573086397804961, -0.03650358221526426, -0.16833618368872252, -0.3525798849882409, -0.5853101515028365, -0.3610762766963322, 0.25968848482361473, -0.37031314191744324, 0.3193025496915025, 0.027769492121745343, 0.15253502525765555],
        [0.6792405488658713, -0.1847238459840437, -0.10861991134489622, -0.07451629609744548, 0.6175402630727483, -0.6113744458428834, -0.21621742412280864, 0.08673952213390404, -0.14078090723005743, -0.007111751610328079, -0.01919782209027585, 0.06937788854645449, 0.3699711008032469, -0.481850510930375, -0.18977606138728748, -0.05232535633300299, 0.06177395554944698, 0.18012204824330977, -0.11491007222387056, 0.11009868194124217, 0.12117014396089262, -0.06295978132108862, -0.46989939575632095, -0.6982186412661279, -0.021149392450073034, -0.0035629159757058493, -0.29364472575765915, -0.7979812199908445, 0.27280828924008893, 0.006898655227301029],
        [-0.04316062688718403, 0.574420520356522, 0.37533524133818885, 0.15959679574442548, 0.14843422189720235, -0.43304577030751057, 0.325579640829939, -0.34368983825305516, -0.20653147477911787, 0.06368473049219464, 0.3804075259632366, -0.014595794565488557, 0.3850372654425368, 0.12731034254568774, -0.29045275181788877, -0.06237910945564258, -0.40428656430234206, 0.34902577104237026, 0.25702327316526513, 0.2594988367217502, -0.8364188970267952, -0.14109747191434935, 0.17775836804212827, -0.0500392460663695, -0.5124173168738126, 0.20853742504417522, -0.13983479709984473, 0.2170661192391326, -0.027320657589434444, 0.591969011112866],
        [0.5783213302832911, -0.1545603277394636, 0.42051821643793336, 0.10676674457110082, 0.3792453413707366, 0.4815177522812151, -0.1866608777464108, -0.3433656572428487, 0.06489966446424802, 0.40125367716201266, 0.4157713116814852, -0.28374383836537775, 0.3784348692469739, -0.13105506522915678, -0.2309261097981483, 0.2754540704209427, -0.3875060957299661, 0.009502706750420975, 0.27630216298925897, -0.48928819931944995, 0.26759686911936764, -0.4809468998639298, 0.34670144998754526, -0.25254702115250655, -0.15295804897116805, -0.5675911915936362, 0.7620147204347847, -0.45262292056251574, -0.5786079834494645, -0.06323848557037004],
        [-0.34283350701149484, -0.6730636348570841, 0.4040560678784033, -0.599052465082982, -0.7782280087706768, -0.13476955308265137, 0.5604033818496315, -0.20871972306828296, -0.06885428916336744, 0.13117770459667655, 0.25037270345265106, 0.2622538342689601, -0.1431350704326102, -0.2533509573406501, -0.440743862212319, 0.0382534413200026, 0.25271315612534456, 0.1705531546405306, 0.5798203435504045, 0.29874459826759076, -0.310298539084251, 0.2901520296222533, -0.5535259310794999, -0.3514414711167972, 0.3219512330377871, 0.2517175000672037, 0.6782092133186561, -0.22640629174595972, 0.2203653570108618, 0.48304043867717905],
        [0.5135248018314362, -0.006235840069804793, -0.04838540262927399, -0.6721917286548158, 0.34404985747693145, 0.23521675246662052, 0.07953622556706605, -0.06122689574769502, 0.7980864010179608, -0.22068286594611244, 0.3413333711714845, -0.1260520344820353, 0.4063762808634639, -0.12222110867497038, -0.5006738406258504, -0.32605974725293285, -0.4073742230890023, -0.9775655388978536, 0.13296528634549526, 0.192416656460478, 0.27953096426311635, 0.43124275149536223, 0.0314306666362861, 0.6300802493299325, -0.36366018754884005, -0.27314682030401294, -0.35866117345430376, -0.0623746894117953, 0.31657772278189067, 0.21376637178644892],
        [-0.10884321719699523, 0.07686025056311094, -0.10582938903651766, -0.1472760627542356, -0.08747458615172049, 0.12867576853006965, 0.7795987520136758, -0.2660343089151356, 0.7165441120793062, 0.34228742207933, -0.5618887260707238, -0.46996310211928066, 0.24891926708010514, 0.13467100131340617, 0.3969258970894423, 0.6293270433141338, -0.07754649559429216, 0.1442840208339526, -0.2270049675065653, 0.0739791203118698, 0.13682962377700583, 0.7243877652758502, 0.14778082865760023, -0.2698638862808016, 0.1307624490101824, -0.0626325286247561, -0.38964188857768534, -0.08605875870375215, 0.3324519244252263, 0.014277717116738808],
        [0.2895574369050755, 0.1094120367389521, -0.2334579666143783, 0.45859411071183576, -0.03340292195612482, -0.18611488545142055, 0.40158808985003736, 0.335288968332504, -0.3405867450606367, -0.08539935723314102, -0.13534035734723454, -0.6205314824194255, -0.4429401619786058, 0.3011139949815606, -0.5379569193754152, 0.30465525643110253, 0.14030993165994204, 0.36258694309133654, 0.2145373797261815, 0.07498498997621326, -0.4324530774688801, -0.3286489033067833, 0.5667164692446627, 0.1447636406413772, 0.5422185612527602, 0.4089258905299314, 0.40617750549030573, -0.7267811667808712, 0.3516694489491435, -0.30418104038503935],
        [0.20222180340125934, 0.2831776309749603, 0.060166348373850945, -0.5855255552561192, -0.03447793629134796, 0.32445088725002036, 0.1546497277615667, 0.324723999385197, -0.4562959708036036, -0.09816065239612798, 0.020915161109898647, -0.17459557476707283, 0.1394657999015317, 0.18384009162983622, 0.36973363809298176, -0.4381809208188648, -0.5703897438970137, 0.33352422835436446, -0.18797849165466013, 0.631859160342295, 0.3514560200448847, 0.3087307753663644, -0.2515569296419355, 0.03944009267676457, -0.41258704221456, 0.44633263448637195, 0.5732361908918623, 0.39444138036023885, -0.26512571654485284, -0.6018352066208573],
        [-0.5206829905051273, -0.23135859613942492, -0.24296092603616903, 0.5067548607658765, -0.10564890045897368, -0.24048658200075512, -0.7772497674708043, 0.44406441914299977, -0.25431847316375034, 0.14323570082190917, -0.356622688062133, -0.24078911517925972, 0.10355571659093331, -0.001453627978651284, -0.22707022532228102, 0.4682172800208123, -0.37166534546550756, 0.0759457827772767, -0.5096957244960226, 0.5755751510073313, -0.013887151280500318, 0.3251546398415122, 0.3213560243315437, 0.1385799433465439, 0.2375563487573703, -0.4303408021654781, -0.151821997432602, -0.25028100177204743, 0.1457395195025717, 0.776309709064163],
        [0.42836252552949206, -0.33718197585321724, 0.21548035377577868, -0.40507662797645944, 0.2014274832905996, -0.5433793884340921, 0.1224415250293831, 0.5393306791753718, 0.27416686032695486, 0.082632023074415, -0.7884658902824764, 0.352516410343092, -0.3215340918790108, 0.3063978302657008, -0.35842337232209986, 0.15918686812857288, -0.5066182271884826, 0.24318494071384883, -0.07990729625099985, -0.34223427859471983, 0.026389823884251817, -0.012190771423593136, -0.38440465561717074, 0.4422050016374801, 0.5004188286541862, -0.48797366693918576, -0.5257294178775168, 0.27044826965888685, 0.06374658128407093, -0.21055537254768195],
        [-0.07229172521248685, -0.012619021504288216, -0.10306990613044381, 0.5773822518003995, 0.06888051451486416, 0.43713082352039045, 0.5885415309525811, 0.15509576744315207, -0.0646716677963939, -0.4195382156489882, 0.0077740925641710396, 0.25114301460843375, 0.045871547106996174, -0.08119450771007011, 0.8255692518586322, -0.10746168444798904, -0.7233908867213177, -0.28733213848659256, -0.07042257148949574, -0.33736998430157605, -0.31615772012747434, 0.637471243102823, 0.3342620958158797, 0.10193483134353173, 0.22375768368727963, 0.25939635951333456, 0.2895429558698939, 0.0938692733504595, -0.35688342388508215, 0.33223137855053053],
        [-0.18699662934090575, -0.25626959260136895, 0.21645569641934304, -0.5729028966371135, -0.1757924340162676, -0.3096075782754243, 0.07831552044106763, 0.15162561197553526, -0.5420221467353463, -0.3045924843328466, 0.4368657815598125, -0.21463743674331837, -0.4578505782102571, -0.3066597950800175, 0.27053121874282693, 0.20836974921463403, 0.13800460199956427, 0.36587732428809083, 0.04237344159534795, 0.11961652698091832, 0.07333226939939147, 0.30418372479105804, 0.8086105436243229, -0.1881215194116193, 0.3288548599042146, 0.2429985863774975, -0.36775767269543636, -0.5799500101784082, -0.7581937239986651, -0.02363706621763853],
        [-0.18164178957187238, -0.3975578037882955, 0.9031749527859909, 0.06435313172171045, -0.18373217556008753, 0.12856849436939927, 0.03605582300233018, -0.22177090943159183, 0.46766398866629866, -0.45862241453424646, 0.6090704190704241, -0.16871814723754863, -0.05282949041805468, -0.23775525925864419, 0.1458537535172106, 0.3601499062837886, -0.3548351717298724, 0.11465124307727872, -0.7408734746734618, -0.17028472651884238, 0.016211503505893607, 0.08555954360280565, -0.19327077449197183, 0.3477159638225413, 0.1405951388246403, 0.6741091274493876, 0.18351925802796182, 0.28709379999081447, 0.09649713320812849, 0.1770619974289314],
        [-0.2959998782373478, -0.31893488942623544, 0.2884344740408862, 0.12777785918551032, -0.3298828917178556, -0.01296814707209483, -0.026207430454604275, -0.3195494668334498, -0.13831150022629682, -0.06202930628131616, 0.5038326313361795, 0.06812820721374047, -0.3883804678776764, 0.42117399995432425, 0.6719523175060682, -0.7829119058233104, -0.2545728223200528, 0.030432611272681168, 0.46105781013008984, 0.3455033529988476, 0.38043039410177476, 0.015592560744472711, -0.0782236623864884, 0.10723363542970979, -0.0785484717132918, -0.5242356949446266, -0.3076345938849563, -0.5447340695866476, 0.20827160167719058, -0.24714630791611464],
        [0.39091730874319836, -0.14301948453718222, -0.416573974498724, 0.21058636576321915, -0.042392695980575545, 0.9692299560410524, 0.18067532655955904, 0.07048923752150876, -0.25753083434238133, -0.02811434559196349, 0.4084048583145683, 0.25263554314386394, 0.24018893308181855, -0.45088121570201556, -0.37543681788595623, -0.21472728196743884, -0.20185399884279412, 0.6453208405376091, 0.25181311449736976, -0.34569454269251476, 0.376170751494547, -0.19323458373162783, -0.09873617008670921, -0.11693468261985994, -0.12211990315128496, -0.5205620314235212, -0.3819412010822847, -0.024201460578551548, -0.43322487076976357, 0.40659980395686357],
        [0.32490256897373954, 0.273641936177235, 0.6409145677667029, 0.010478884705160063, -0.13968486757812731, 0.36348706825807253, -0.47939360842532897, 0.5215045445963201, -0.08475159525065415, -0.38274255200218354, -0.24647385601789726, 0.09939948553816708, 0.24046412030140712, -0.05198426665156987, -0.050031793748498476, 0.01728344868408335, 0.6783139651058665, 0.22122649826282775, -0.15006430849891333, 0.4093345419333876, -0.3604899816439195, 0.527653545494235, 0.1341756137913044, 0.2921984039295986, -0.4290151283670982, -0.48997286041670407, 0.090580797885915, -0.14809464302004724, -0.007510073366799333, 0.21560238869439494],
        [0.20386338576133167, 0.49707514715466306, 0.3049937683144083, 0.5062407667254119, -0.9414667369063229, 0.013418269930532703, -0.5051597908533171, 0.3924810115481096, 0.19273242642462857, -0.2537293164221322, 0.48713589276149327, 0.4290184531975732, -0.6419506493670214, -0.2592152788761851, 0.0038551191121315442, -0.1300980835925416, -0.6166597563107101, -0.36683498615168486, -0.41225121218445687, 0.2231510516544806, 0.08715996651143887, -0.21546515642668754, -0.014515945995269355, -0.9197293583873759, -0.17423640730171053, 0.3751523690314758, 0.0875330631809718, -0.36273892066117197, -0.38622720112210185, -0.22233035439369653],
        [0.8140328127660865, 0.2446917807402485, 0.7860284456563504, 0.18734273423462533, 0.16666056758952214, 0.22948096689199932, -0.1792347287266782, -0.16358616668219433, -0.3989444091550533, 0.272957753954343, -0.08143602516667217, 0.049539361244016714, -0.02326210498902423, -0.1404812384357955, 0.11718385884214445, 0.112366644401973, -0.1595835299923443, -0.44416703842723465, 0.9084248633577152, 0.3743265373824697, 0.7640412871510154, 0.35743439721802656, 0.06527304586232732, 0.42585937544467023, 0.809885878410352, 0.4000640530709614, -0.26865180542075917, -0.17160132630425895, 0.5267642382760309, 0.02882298134604211],
        [0.339038897179861, 0.5061272784823421, 0.2722285063723555, -0.08024349582890891, 0.035515754410313086, 0.29566436303920507, -0.1984798774986795, -0.37025124191924835, -0.012655290497039076, -0.30838044519764707, -0.8855288593872315, -0.43679212531806566, -0.034416560576147615, -0.23338149640589623, 0.2532464780575538, -0.7065134108451461, -0.2794681789552189, -0.41001645838043077, -0.033598119177321834, 0.09514136754983767, -0.44522949863169964, -0.5680023381620815, -0.325754877478974, 0.43204808140388473, 0.13389718193679792, -0.22126061393205954, 0.044064658248676225, 0.06399776648419692, -0.0759510558039012, 0.29874829315486817],
    ])
    
    def __init__(self):
        rest_h = []
        rest_g = [self.CEC2017_C21_g1, self.CEC2017_C21_g2]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        M = self.select_matrix(D)
        y = generate_z_y(x, self.o[:D], 'matrix_multiply', M)
        f_x = np.sum(y**2 - 10 * np.cos(2 * np.pi * y) + 10)
        return f_x
    
    @staticmethod
    def select_matrix(D):
        if D == 10:
            return CEC2017_C21.M10
        elif D == 30:
            return CEC2017_C21.M30
        else:
            raise ValueError("Dimensión no soportada")
    
    @staticmethod
    def CEC2017_C21_g1(x):
        M = CEC2017_C21.select_matrix(D)
        z = generate_z_y(x, CEC2017_C21.o[:D], 'matrix_multiply', M)
        return 4 - np.sum(np.abs(z))
    
    @staticmethod
    def CEC2017_C21_g2(x):
        M = CEC2017_C21.select_matrix(D)
        z = generate_z_y(x, CEC2017_C21.o[:D], 'matrix_multiply', M)
        return np.sum(z**2) - 4

class CEC2017_C22(Problem):
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    M10 = np.array([
        [-1.4750691585532323, -0.5745205005115123, -0.005699772438594958, 0.6648210730157429, -0.1041634598061256, -0.8978855297957111, -0.901994204541452, -0.6065324100090661, -0.4063251172471228, 0.15528244331830426],
        [0.5592150245095672, 0.04993662795408019, 0.4215715110001431, 0.8658026703900705, 0.6947904462259192, -0.18507116388982225, -0.022188704511750743, -0.649218872652057, 0.07356091714854926, -0.7961176305125455],
        [0.6352998982037079, 0.5943504059660697, 1.103253878964802, -1.1285189770235082, 0.7046494430751651, 0.2755757486743495, -1.0399669162892367, 0.11685698852943777, -0.32902335058747467, 0.07790036419589119],
        [-0.35941283248531275, 0.37082704554158386, -0.5271046483443762, -0.26665593788738984, -0.5141977194125844, 0.5821194001685648, -0.047299261268575435, -0.46312553098784154, -0.10196330326631606, -0.9522639457792393],
        [-0.5839720120889139, 1.7714876607340784, 0.013650083503154053, 0.3212225620402597, 0.7904281214026975, 0.4093923866971973, 0.33744753474799605, 0.5942128150118153, -0.15480530100758425, -0.5237685825508689],
        [-0.17838596502167076, 0.24992500534286521, -0.17316389205861768, -0.005036558084014708, -0.17668981043919074, 0.282386956005954, -1.0946510657454087, 0.45147932173029537, 1.0574055589046905, -0.0074876994077884285],
        [-0.5913243068007854, -0.27049755413083576, -0.3130389318979534, 0.6376303913429255, 1.2741644739500224, 0.7811212288227438, 0.1820711612625297, -0.05528506550771772, 0.27980292347560093, 0.055727088016825216],
        [-0.20277428932485703, 1.0079304172848664, 0.01437318812037941, 0.14803052734314798, 0.45096233182274637, -0.5822593030942272, 0.452115990237956, -0.8708036252941136, 0.4357530932226235, 0.3651693399025321],
        [-0.9026689569470502, 0.17486172336358063, -0.27450550855066735, -0.3661547399904748, 0.6032348252987877, -0.762354545526245, 0.9197863043444101, -0.06739961818174695, 0.5329960368512198, -0.9498570741645186],
        [0.3809013727921987, 0.8270471805962801, -0.9297598191669905, -0.5709424218088751, 1.0158877843868521, -0.39993664335293944, -0.7407173804723235, 0.40730997988162376, -0.3708088890828746, -0.193514070829618],
    ])
    
    
    M30 = np.array([
        [-0.5159828783208829, -0.461752601502956, -0.47478430536873406, 0.30906472546822983, 0.0821092546309288, 0.12399425682320928, -0.27213943183862804, -0.6066294974432846, 0.777839341246011, -0.05737011470108, -0.09789520372128557, 0.17520766757008754, 0.15816790642936068, 0.11980961854461003, -0.468153550081146, -0.3620869598650572, -0.4886255076540601, 0.23469980700329732, 0.6450256970330783, 0.49857302334610387, 0.06300037478185166, 0.5766729714557522, 0.0934670738279128, -0.0882071137775379, 0.8805338407901566, 0.37503612382206475, 0.48038544171877795, 0.6074904320527752, -0.06333768975160145, -0.44730035615863784],
        [0.1880754930560265, -0.2720272048289167, 0.1869512122668153, 0.0438983891578362, -0.23549495408004903, -0.6163739419294972, 0.060500463921530634, 0.2676085722425896, 0.5259478346689614, 0.7720494183015834, 0.21960696988918912, 0.15824113495025177, 0.2970151280048526, -0.20379644304513045, 0.641572164969781, -0.418148640182776, 0.22926624189809053, 0.0612419752999645, 0.06791073974691907, -0.032319295885730404, 0.26292640093486397, -0.6480198792924795, 0.2810103744453979, 0.14392792999580045, -0.004528918141343957, -0.005930953273363987, 0.13708107902261224, 0.4968959791866978, -0.10313184784018095, -0.0894528902124122],
        [0.08677860222719772, -0.13415840828119555, 0.5277280418242739, 0.7478122408419924, -0.3125793907217645, 0.38174655051775797, 0.019187525091114474, -0.02240431729236165, -0.5672989058308923, 0.5492354632829972, 0.03655749312790477, -0.39925649810781727, 0.3782977840936688, -0.2512456032672451, -0.3288950029473213, 0.046264440515645315, -0.17471382325041543, -0.650841654577202, -0.26557166002512683, 0.1268686931172478, -0.7752632273386695, 0.3580039025191851, -0.12818030147444026, 0.32101908684569186, 0.15687161215857892, 0.13220017059437858, -0.49611842100609715, -0.16172585090258718, -0.21068271845999856, 0.06731164664251577],
        [-0.0725281242535927, 0.03923363692533671, -0.08451736708855691, 0.911569016239978, 0.27124084181504265, 0.10678488576778121, 0.35154106042529, -0.10959240726719924, -0.3567424184683352, -0.05139206973406582, -0.6458723265904243, -0.17894980229733576, -0.07928189820709317, -0.5534977733755848, -0.3566608623377477, -0.8775717680937246, 0.1069956028157045, -0.2962152465741139, 0.28338354399572724, -0.5383563973668849, 0.2703419660432148, -0.16167942534080176, 0.5163599860818278, -0.5075463963316947, -0.42222755988115773, -0.1523082265251643, 0.3179043033149148, 0.15263148427625017, 0.3186760724944154, -0.007851425697908351],
        [-0.31085059906248025, 0.10773533790008274, 0.21073657512338226, -0.10389714926279825, 0.5006811426159044, 0.6623146979279007, 0.18396874003818742, 0.4617016641762331, -0.5207289159776659, -0.459362028051465, 0.2248991081068287, 0.5680604512423484, 0.3580388165911977, -0.5972146208123865, -0.10433733437648485, -0.014334357116532304, 0.2136845387221096, 0.02439187568807852, 0.23838451766550403, 0.8003915687344867, 0.17872570272597937, -0.5990516448807318, 0.07468653669771103, -0.11529657547119215, -0.08040488050924052, -0.15763218727718675, 0.045919794915371376, 0.3255337153852049, 0.031667282607729774, -0.3317721297284485],
        [0.2882048920773465, -0.14256137622938297, -0.019521164467690172, 0.07084318546010558, -0.09866229014877709, -0.05483664131209329, 0.24968096019471414, -0.6727823205366663, 0.4586423492380458, 0.3840739208227191, 0.10221117432596505, 0.6214137152153121, -0.35242425225098173, -0.5147009154991066, -0.2432463255125819, 0.41179287638035006, -0.315762865887315, -0.3291344064387964, 0.1265193422046716, 0.4787872505741223, -0.14613755535479894, -0.26570943449791184, -0.005485711613561428, 0.49740982236653974, -0.7456385848841535, 0.23704600300129444, 0.3151189427848705, -0.8387615933341264, -0.3854546723830116, -0.022971162158202607],
        [-0.14020032347982048, -0.4683963350040242, -0.05914086143651759, -0.11713500626369226, -0.5481583954724735, 0.4149081840406875, -0.4826214863595243, 0.22391503154961157, -0.09275195276145468, 0.1934587155705878, -0.6390135722335628, 0.36082151781342514, 0.7102948755837191, 0.6954746868245145, 0.2404309981725236, 0.12588166150775848, -0.21052278602763508, 0.044744177933926085, 0.5293182558732803, 0.004181320427426083, -0.06761409605410526, -0.21107664286819583, 0.05833511988247723, 0.0032020184528783885, -0.3345616807067034, 0.5524538826202322, -0.3721275561601629, -0.2637795025196129, -0.12107475788566177, 0.3432266282645529],
        [-0.7154165286229367, 0.31528103197398066, 0.01647640590023225, 0.39882899107397285, -0.14415437963892944, -0.2500593216791629, -0.16311945583262297, 0.5067356779768416, -0.1590560467883433, -0.18667036572780393, 0.12909690348449493, -0.5777050366627182, 0.38790818556587925, -0.03455420420866631, 0.2521998313698651, 0.2522275885761841, 0.25097650987815523, 0.21256365493018475, 0.4406863450775138, -0.07819611927891953, 0.07587133068400234, 0.2632134257544718, -0.6415440320038228, 0.05124995001626026, -0.1767414436297925, -0.24246914260979086, -0.338571847289742, 0.21483495449255388, -0.3229255888333219, -0.07199864307599385],
        [-0.39160242358042946, -0.16134530371710776, 0.46555336270706227, -0.3394623581586844, 0.5031305235512509, 0.7314391012509215, 0.1266883508642425, 0.44419263204459114, -0.2808593742641189, 0.5417972586231993, 0.1843965718350277, -0.35788259443761905, -0.8193905513057221, -0.10780914617362286, -0.39656004845784765, -0.27761678053703087, -0.09398645818794296, 0.43928559595807837, 0.20775315827831287, -0.6077885105664197, -0.5023029903313124, -0.1333465715662987, -0.47768154310538624, 0.17087315244251583, 0.45435187275830496, 0.510020353660775, 0.0949749764287343, 0.019739974727221665, -0.008828707869123292, 0.2232835385643469],
        [-0.6610737817430957, 0.21235972545049517, 0.30368026193672504, 0.20764504955380048, -0.13615718991195438, 0.03281183661376963, 0.4514937186351503, -0.054869371231186403, 0.21071412408577866, -0.09345912666162204, -0.1659068934720344, 0.41299528263039714, 0.45405139507149, 0.22801776609787025, -0.642380501557519, -0.319853912356299, 0.719252468933344, -0.3522194712129756, -0.565583771287912, 0.3341465443900812, 0.6068260177923867, -0.025589002436567265, -0.26337562864346536, 0.00690392328041875, 0.027780261823982532, 0.07485393534252438, 0.5057436307208727, -0.36674580232138426, -0.36471257533260526, 0.7928234991686849],
        [0.8065523814719902, -0.36943762380588585, -0.21311920492789346, 0.41778489674363434, 0.35019288619015626, -0.18998622317609343, -0.23301566911104613, 0.31711875996214256, 0.1370340917183983, -0.3749346254952983, -0.3373056707458486, -0.16046636870617761, -0.9643655176269585, 0.24705778517160132, 0.03645246961244829, 0.13329625551075858, -0.05149119011253189, -0.40643463965352095, -0.16682553579856557, 0.573086397804961, -0.03650358221526426, -0.16833618368872252, -0.3525798849882409, -0.5853101515028365, -0.3610762766963322, 0.25968848482361473, -0.37031314191744324, 0.3193025496915025, 0.027769492121745343, 0.15253502525765555],
        [0.6792405488658713, -0.1847238459840437, -0.10861991134489622, -0.07451629609744548, 0.6175402630727483, -0.6113744458428834, -0.21621742412280864, 0.08673952213390404, -0.14078090723005743, -0.007111751610328079, -0.01919782209027585, 0.06937788854645449, 0.3699711008032469, -0.481850510930375, -0.18977606138728748, -0.05232535633300299, 0.06177395554944698, 0.18012204824330977, -0.11491007222387056, 0.11009868194124217, 0.12117014396089262, -0.06295978132108862, -0.46989939575632095, -0.6982186412661279, -0.021149392450073034, -0.0035629159757058493, -0.29364472575765915, -0.7979812199908445, 0.27280828924008893, 0.006898655227301029],
        [-0.04316062688718403, 0.574420520356522, 0.37533524133818885, 0.15959679574442548, 0.14843422189720235, -0.43304577030751057, 0.325579640829939, -0.34368983825305516, -0.20653147477911787, 0.06368473049219464, 0.3804075259632366, -0.014595794565488557, 0.3850372654425368, 0.12731034254568774, -0.29045275181788877, -0.06237910945564258, -0.40428656430234206, 0.34902577104237026, 0.25702327316526513, 0.2594988367217502, -0.8364188970267952, -0.14109747191434935, 0.17775836804212827, -0.0500392460663695, -0.5124173168738126, 0.20853742504417522, -0.13983479709984473, 0.2170661192391326, -0.027320657589434444, 0.591969011112866],
        [0.5783213302832911, -0.1545603277394636, 0.42051821643793336, 0.10676674457110082, 0.3792453413707366, 0.4815177522812151, -0.1866608777464108, -0.3433656572428487, 0.06489966446424802, 0.40125367716201266, 0.4157713116814852, -0.28374383836537775, 0.3784348692469739, -0.13105506522915678, -0.2309261097981483, 0.2754540704209427, -0.3875060957299661, 0.009502706750420975, 0.27630216298925897, -0.48928819931944995, 0.26759686911936764, -0.4809468998639298, 0.34670144998754526, -0.25254702115250655, -0.15295804897116805, -0.5675911915936362, 0.7620147204347847, -0.45262292056251574, -0.5786079834494645, -0.06323848557037004],
        [-0.34283350701149484, -0.6730636348570841, 0.4040560678784033, -0.599052465082982, -0.7782280087706768, -0.13476955308265137, 0.5604033818496315, -0.20871972306828296, -0.06885428916336744, 0.13117770459667655, 0.25037270345265106, 0.2622538342689601, -0.1431350704326102, -0.2533509573406501, -0.440743862212319, 0.0382534413200026, 0.25271315612534456, 0.1705531546405306, 0.5798203435504045, 0.29874459826759076, -0.310298539084251, 0.2901520296222533, -0.5535259310794999, -0.3514414711167972, 0.3219512330377871, 0.2517175000672037, 0.6782092133186561, -0.22640629174595972, 0.2203653570108618, 0.48304043867717905],
        [0.5135248018314362, -0.006235840069804793, -0.04838540262927399, -0.6721917286548158, 0.34404985747693145, 0.23521675246662052, 0.07953622556706605, -0.06122689574769502, 0.7980864010179608, -0.22068286594611244, 0.3413333711714845, -0.1260520344820353, 0.4063762808634639, -0.12222110867497038, -0.5006738406258504, -0.32605974725293285, -0.4073742230890023, -0.9775655388978536, 0.13296528634549526, 0.192416656460478, 0.27953096426311635, 0.43124275149536223, 0.0314306666362861, 0.6300802493299325, -0.36366018754884005, -0.27314682030401294, -0.35866117345430376, -0.0623746894117953, 0.31657772278189067, 0.21376637178644892],
        [-0.10884321719699523, 0.07686025056311094, -0.10582938903651766, -0.1472760627542356, -0.08747458615172049, 0.12867576853006965, 0.7795987520136758, -0.2660343089151356, 0.7165441120793062, 0.34228742207933, -0.5618887260707238, -0.46996310211928066, 0.24891926708010514, 0.13467100131340617, 0.3969258970894423, 0.6293270433141338, -0.07754649559429216, 0.1442840208339526, -0.2270049675065653, 0.0739791203118698, 0.13682962377700583, 0.7243877652758502, 0.14778082865760023, -0.2698638862808016, 0.1307624490101824, -0.0626325286247561, -0.38964188857768534, -0.08605875870375215, 0.3324519244252263, 0.014277717116738808],
        [0.2895574369050755, 0.1094120367389521, -0.2334579666143783, 0.45859411071183576, -0.03340292195612482, -0.18611488545142055, 0.40158808985003736, 0.335288968332504, -0.3405867450606367, -0.08539935723314102, -0.13534035734723454, -0.6205314824194255, -0.4429401619786058, 0.3011139949815606, -0.5379569193754152, 0.30465525643110253, 0.14030993165994204, 0.36258694309133654, 0.2145373797261815, 0.07498498997621326, -0.4324530774688801, -0.3286489033067833, 0.5667164692446627, 0.1447636406413772, 0.5422185612527602, 0.4089258905299314, 0.40617750549030573, -0.7267811667808712, 0.3516694489491435, -0.30418104038503935],
        [0.20222180340125934, 0.2831776309749603, 0.060166348373850945, -0.5855255552561192, -0.03447793629134796, 0.32445088725002036, 0.1546497277615667, 0.324723999385197, -0.4562959708036036, -0.09816065239612798, 0.020915161109898647, -0.17459557476707283, 0.1394657999015317, 0.18384009162983622, 0.36973363809298176, -0.4381809208188648, -0.5703897438970137, 0.33352422835436446, -0.18797849165466013, 0.631859160342295, 0.3514560200448847, 0.3087307753663644, -0.2515569296419355, 0.03944009267676457, -0.41258704221456, 0.44633263448637195, 0.5732361908918623, 0.39444138036023885, -0.26512571654485284, -0.6018352066208573],
        [-0.5206829905051273, -0.23135859613942492, -0.24296092603616903, 0.5067548607658765, -0.10564890045897368, -0.24048658200075512, -0.7772497674708043, 0.44406441914299977, -0.25431847316375034, 0.14323570082190917, -0.356622688062133, -0.24078911517925972, 0.10355571659093331, -0.001453627978651284, -0.22707022532228102, 0.4682172800208123, -0.37166534546550756, 0.0759457827772767, -0.5096957244960226, 0.5755751510073313, -0.013887151280500318, 0.3251546398415122, 0.3213560243315437, 0.1385799433465439, 0.2375563487573703, -0.4303408021654781, -0.151821997432602, -0.25028100177204743, 0.1457395195025717, 0.776309709064163],
        [0.42836252552949206, -0.33718197585321724, 0.21548035377577868, -0.40507662797645944, 0.2014274832905996, -0.5433793884340921, 0.1224415250293831, 0.5393306791753718, 0.27416686032695486, 0.082632023074415, -0.7884658902824764, 0.352516410343092, -0.3215340918790108, 0.3063978302657008, -0.35842337232209986, 0.15918686812857288, -0.5066182271884826, 0.24318494071384883, -0.07990729625099985, -0.34223427859471983, 0.026389823884251817, -0.012190771423593136, -0.38440465561717074, 0.4422050016374801, 0.5004188286541862, -0.48797366693918576, -0.5257294178775168, 0.27044826965888685, 0.06374658128407093, -0.21055537254768195],
        [-0.07229172521248685, -0.012619021504288216, -0.10306990613044381, 0.5773822518003995, 0.06888051451486416, 0.43713082352039045, 0.5885415309525811, 0.15509576744315207, -0.0646716677963939, -0.4195382156489882, 0.0077740925641710396, 0.25114301460843375, 0.045871547106996174, -0.08119450771007011, 0.8255692518586322, -0.10746168444798904, -0.7233908867213177, -0.28733213848659256, -0.07042257148949574, -0.33736998430157605, -0.31615772012747434, 0.637471243102823, 0.3342620958158797, 0.10193483134353173, 0.22375768368727963, 0.25939635951333456, 0.2895429558698939, 0.0938692733504595, -0.35688342388508215, 0.33223137855053053],
        [-0.18699662934090575, -0.25626959260136895, 0.21645569641934304, -0.5729028966371135, -0.1757924340162676, -0.3096075782754243, 0.07831552044106763, 0.15162561197553526, -0.5420221467353463, -0.3045924843328466, 0.4368657815598125, -0.21463743674331837, -0.4578505782102571, -0.3066597950800175, 0.27053121874282693, 0.20836974921463403, 0.13800460199956427, 0.36587732428809083, 0.04237344159534795, 0.11961652698091832, 0.07333226939939147, 0.30418372479105804, 0.8086105436243229, -0.1881215194116193, 0.3288548599042146, 0.2429985863774975, -0.36775767269543636, -0.5799500101784082, -0.7581937239986651, -0.02363706621763853],
        [-0.18164178957187238, -0.3975578037882955, 0.9031749527859909, 0.06435313172171045, -0.18373217556008753, 0.12856849436939927, 0.03605582300233018, -0.22177090943159183, 0.46766398866629866, -0.45862241453424646, 0.6090704190704241, -0.16871814723754863, -0.05282949041805468, -0.23775525925864419, 0.1458537535172106, 0.3601499062837886, -0.3548351717298724, 0.11465124307727872, -0.7408734746734618, -0.17028472651884238, 0.016211503505893607, 0.08555954360280565, -0.19327077449197183, 0.3477159638225413, 0.1405951388246403, 0.6741091274493876, 0.18351925802796182, 0.28709379999081447, 0.09649713320812849, 0.1770619974289314],
        [-0.2959998782373478, -0.31893488942623544, 0.2884344740408862, 0.12777785918551032, -0.3298828917178556, -0.01296814707209483, -0.026207430454604275, -0.3195494668334498, -0.13831150022629682, -0.06202930628131616, 0.5038326313361795, 0.06812820721374047, -0.3883804678776764, 0.42117399995432425, 0.6719523175060682, -0.7829119058233104, -0.2545728223200528, 0.030432611272681168, 0.46105781013008984, 0.3455033529988476, 0.38043039410177476, 0.015592560744472711, -0.0782236623864884, 0.10723363542970979, -0.0785484717132918, -0.5242356949446266, -0.3076345938849563, -0.5447340695866476, 0.20827160167719058, -0.24714630791611464],
        [0.39091730874319836, -0.14301948453718222, -0.416573974498724, 0.21058636576321915, -0.042392695980575545, 0.9692299560410524, 0.18067532655955904, 0.07048923752150876, -0.25753083434238133, -0.02811434559196349, 0.4084048583145683, 0.25263554314386394, 0.24018893308181855, -0.45088121570201556, -0.37543681788595623, -0.21472728196743884, -0.20185399884279412, 0.6453208405376091, 0.25181311449736976, -0.34569454269251476, 0.376170751494547, -0.19323458373162783, -0.09873617008670921, -0.11693468261985994, -0.12211990315128496, -0.5205620314235212, -0.3819412010822847, -0.024201460578551548, -0.43322487076976357, 0.40659980395686357],
        [0.32490256897373954, 0.273641936177235, 0.6409145677667029, 0.010478884705160063, -0.13968486757812731, 0.36348706825807253, -0.47939360842532897, 0.5215045445963201, -0.08475159525065415, -0.38274255200218354, -0.24647385601789726, 0.09939948553816708, 0.24046412030140712, -0.05198426665156987, -0.050031793748498476, 0.01728344868408335, 0.6783139651058665, 0.22122649826282775, -0.15006430849891333, 0.4093345419333876, -0.3604899816439195, 0.527653545494235, 0.1341756137913044, 0.2921984039295986, -0.4290151283670982, -0.48997286041670407, 0.090580797885915, -0.14809464302004724, -0.007510073366799333, 0.21560238869439494],
        [0.20386338576133167, 0.49707514715466306, 0.3049937683144083, 0.5062407667254119, -0.9414667369063229, 0.013418269930532703, -0.5051597908533171, 0.3924810115481096, 0.19273242642462857, -0.2537293164221322, 0.48713589276149327, 0.4290184531975732, -0.6419506493670214, -0.2592152788761851, 0.0038551191121315442, -0.1300980835925416, -0.6166597563107101, -0.36683498615168486, -0.41225121218445687, 0.2231510516544806, 0.08715996651143887, -0.21546515642668754, -0.014515945995269355, -0.9197293583873759, -0.17423640730171053, 0.3751523690314758, 0.0875330631809718, -0.36273892066117197, -0.38622720112210185, -0.22233035439369653],
        [0.8140328127660865, 0.2446917807402485, 0.7860284456563504, 0.18734273423462533, 0.16666056758952214, 0.22948096689199932, -0.1792347287266782, -0.16358616668219433, -0.3989444091550533, 0.272957753954343, -0.08143602516667217, 0.049539361244016714, -0.02326210498902423, -0.1404812384357955, 0.11718385884214445, 0.112366644401973, -0.1595835299923443, -0.44416703842723465, 0.9084248633577152, 0.3743265373824697, 0.7640412871510154, 0.35743439721802656, 0.06527304586232732, 0.42585937544467023, 0.809885878410352, 0.4000640530709614, -0.26865180542075917, -0.17160132630425895, 0.5267642382760309, 0.02882298134604211],
        [0.339038897179861, 0.5061272784823421, 0.2722285063723555, -0.08024349582890891, 0.035515754410313086, 0.29566436303920507, -0.1984798774986795, -0.37025124191924835, -0.012655290497039076, -0.30838044519764707, -0.8855288593872315, -0.43679212531806566, -0.034416560576147615, -0.23338149640589623, 0.2532464780575538, -0.7065134108451461, -0.2794681789552189, -0.41001645838043077, -0.033598119177321834, 0.09514136754983767, -0.44522949863169964, -0.5680023381620815, -0.325754877478974, 0.43204808140388473, 0.13389718193679792, -0.22126061393205954, 0.044064658248676225, 0.06399776648419692, -0.0759510558039012, 0.29874829315486817],
    ])

    def __init__(self):
        rest_h = []
        rest_g = [self.CEC2017_C22_g1, self.CEC2017_C22_g2, self.CEC2017_C22_g3]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        M = self.select_matrix(D)
        z = generate_z_y(x, self.o[:D], 'matrix_multiply', M)
        f_x = np.sum([100 * (z[i]**2 - z[i+1])**2 + (z[i] - 1)**2 for i in range(D-1)])
        return f_x
    
    @staticmethod
    def select_matrix(D):
        if D == 10:
            return CEC2017_C22.M10
        elif D == 30:
            return CEC2017_C22.M30
        else:
            raise ValueError("Dimensión no soportada")
    
    @staticmethod
    def CEC2017_C22_g1(x):
        M = CEC2017_C22.select_matrix(D)
        z = generate_z_y(x, CEC2017_C22.o[:D], 'matrix_multiply', M)
        return np.sum(z**2 - 10 * np.cos(2 * np.pi * z) + 10) - 100
    
    @staticmethod
    def CEC2017_C22_g2(x):
        M = CEC2017_C22.select_matrix(D)
        z = generate_z_y(x, CEC2017_C22.o[:D], 'matrix_multiply', M)
        z = np.clip(z, CEC2017_C22.INFERIOR, CEC2017_C22.SUPERIOR)
        return np.sum(z) - 2 * D
    
    @staticmethod
    def CEC2017_C22_g3(x):
        M = CEC2017_C22.select_matrix(D)
        z = generate_z_y(x, CEC2017_C22.o[:D], 'matrix_multiply', M)
        return 5 - np.sum(z)

class CEC2017_C23(Problem):
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    M10 = np.array([
        [-1.4750691585532323, -0.5745205005115123, -0.005699772438594958, 0.6648210730157429, -0.1041634598061256, -0.8978855297957111, -0.901994204541452, -0.6065324100090661, -0.4063251172471228, 0.15528244331830426],
        [0.5592150245095672, 0.04993662795408019, 0.4215715110001431, 0.8658026703900705, 0.6947904462259192, -0.18507116388982225, -0.022188704511750743, -0.649218872652057, 0.07356091714854926, -0.7961176305125455],
        [0.6352998982037079, 0.5943504059660697, 1.103253878964802, -1.1285189770235082, 0.7046494430751651, 0.2755757486743495, -1.0399669162892367, 0.11685698852943777, -0.32902335058747467, 0.07790036419589119],
        [-0.35941283248531275, 0.37082704554158386, -0.5271046483443762, -0.26665593788738984, -0.5141977194125844, 0.5821194001685648, -0.047299261268575435, -0.46312553098784154, -0.10196330326631606, -0.9522639457792393],
        [-0.5839720120889139, 1.7714876607340784, 0.013650083503154053, 0.3212225620402597, 0.7904281214026975, 0.4093923866971973, 0.33744753474799605, 0.5942128150118153, -0.15480530100758425, -0.5237685825508689],
        [-0.17838596502167076, 0.24992500534286521, -0.17316389205861768, -0.005036558084014708, -0.17668981043919074, 0.282386956005954, -1.0946510657454087, 0.45147932173029537, 1.0574055589046905, -0.0074876994077884285],
        [-0.5913243068007854, -0.27049755413083576, -0.3130389318979534, 0.6376303913429255, 1.2741644739500224, 0.7811212288227438, 0.1820711612625297, -0.05528506550771772, 0.27980292347560093, 0.055727088016825216],
        [-0.20277428932485703, 1.0079304172848664, 0.01437318812037941, 0.14803052734314798, 0.45096233182274637, -0.5822593030942272, 0.452115990237956, -0.8708036252941136, 0.4357530932226235, 0.3651693399025321],
        [-0.9026689569470502, 0.17486172336358063, -0.27450550855066735, -0.3661547399904748, 0.6032348252987877, -0.762354545526245, 0.9197863043444101, -0.06739961818174695, 0.5329960368512198, -0.9498570741645186],
        [0.3809013727921987, 0.8270471805962801, -0.9297598191669905, -0.5709424218088751, 1.0158877843868521, -0.39993664335293944, -0.7407173804723235, 0.40730997988162376, -0.3708088890828746, -0.193514070829618],
    ])
    M30 = np.array([
        [-0.5159828783208829, -0.461752601502956, -0.47478430536873406, 0.30906472546822983, 0.0821092546309288, 0.12399425682320928, -0.27213943183862804, -0.6066294974432846, 0.777839341246011, -0.05737011470108, -0.09789520372128557, 0.17520766757008754, 0.15816790642936068, 0.11980961854461003, -0.468153550081146, -0.3620869598650572, -0.4886255076540601, 0.23469980700329732, 0.6450256970330783, 0.49857302334610387, 0.06300037478185166, 0.5766729714557522, 0.0934670738279128, -0.0882071137775379, 0.8805338407901566, 0.37503612382206475, 0.48038544171877795, 0.6074904320527752, -0.06333768975160145, -0.44730035615863784],
        [0.1880754930560265, -0.2720272048289167, 0.1869512122668153, 0.0438983891578362, -0.23549495408004903, -0.6163739419294972, 0.060500463921530634, 0.2676085722425896, 0.5259478346689614, 0.7720494183015834, 0.21960696988918912, 0.15824113495025177, 0.2970151280048526, -0.20379644304513045, 0.641572164969781, -0.418148640182776, 0.22926624189809053, 0.0612419752999645, 0.06791073974691907, -0.032319295885730404, 0.26292640093486397, -0.6480198792924795, 0.2810103744453979, 0.14392792999580045, -0.004528918141343957, -0.005930953273363987, 0.13708107902261224, 0.4968959791866978, -0.10313184784018095, -0.0894528902124122],
        [0.08677860222719772, -0.13415840828119555, 0.5277280418242739, 0.7478122408419924, -0.3125793907217645, 0.38174655051775797, 0.019187525091114474, -0.02240431729236165, -0.5672989058308923, 0.5492354632829972, 0.03655749312790477, -0.39925649810781727, 0.3782977840936688, -0.2512456032672451, -0.3288950029473213, 0.046264440515645315, -0.17471382325041543, -0.650841654577202, -0.26557166002512683, 0.1268686931172478, -0.7752632273386695, 0.3580039025191851, -0.12818030147444026, 0.32101908684569186, 0.15687161215857892, 0.13220017059437858, -0.49611842100609715, -0.16172585090258718, -0.21068271845999856, 0.06731164664251577],
        [-0.0725281242535927, 0.03923363692533671, -0.08451736708855691, 0.911569016239978, 0.27124084181504265, 0.10678488576778121, 0.35154106042529, -0.10959240726719924, -0.3567424184683352, -0.05139206973406582, -0.6458723265904243, -0.17894980229733576, -0.07928189820709317, -0.5534977733755848, -0.3566608623377477, -0.8775717680937246, 0.1069956028157045, -0.2962152465741139, 0.28338354399572724, -0.5383563973668849, 0.2703419660432148, -0.16167942534080176, 0.5163599860818278, -0.5075463963316947, -0.42222755988115773, -0.1523082265251643, 0.3179043033149148, 0.15263148427625017, 0.3186760724944154, -0.007851425697908351],
        [-0.31085059906248025, 0.10773533790008274, 0.21073657512338226, -0.10389714926279825, 0.5006811426159044, 0.6623146979279007, 0.18396874003818742, 0.4617016641762331, -0.5207289159776659, -0.459362028051465, 0.2248991081068287, 0.5680604512423484, 0.3580388165911977, -0.5972146208123865, -0.10433733437648485, -0.014334357116532304, 0.2136845387221096, 0.02439187568807852, 0.23838451766550403, 0.8003915687344867, 0.17872570272597937, -0.5990516448807318, 0.07468653669771103, -0.11529657547119215, -0.08040488050924052, -0.15763218727718675, 0.045919794915371376, 0.3255337153852049, 0.031667282607729774, -0.3317721297284485],
        [0.2882048920773465, -0.14256137622938297, -0.019521164467690172, 0.07084318546010558, -0.09866229014877709, -0.05483664131209329, 0.24968096019471414, -0.6727823205366663, 0.4586423492380458, 0.3840739208227191, 0.10221117432596505, 0.6214137152153121, -0.35242425225098173, -0.5147009154991066, -0.2432463255125819, 0.41179287638035006, -0.315762865887315, -0.3291344064387964, 0.1265193422046716, 0.4787872505741223, -0.14613755535479894, -0.26570943449791184, -0.005485711613561428, 0.49740982236653974, -0.7456385848841535, 0.23704600300129444, 0.3151189427848705, -0.8387615933341264, -0.3854546723830116, -0.022971162158202607],
        [-0.14020032347982048, -0.4683963350040242, -0.05914086143651759, -0.11713500626369226, -0.5481583954724735, 0.4149081840406875, -0.4826214863595243, 0.22391503154961157, -0.09275195276145468, 0.1934587155705878, -0.6390135722335628, 0.36082151781342514, 0.7102948755837191, 0.6954746868245145, 0.2404309981725236, 0.12588166150775848, -0.21052278602763508, 0.044744177933926085, 0.5293182558732803, 0.004181320427426083, -0.06761409605410526, -0.21107664286819583, 0.05833511988247723, 0.0032020184528783885, -0.3345616807067034, 0.5524538826202322, -0.3721275561601629, -0.2637795025196129, -0.12107475788566177, 0.3432266282645529],
        [-0.7154165286229367, 0.31528103197398066, 0.01647640590023225, 0.39882899107397285, -0.14415437963892944, -0.2500593216791629, -0.16311945583262297, 0.5067356779768416, -0.1590560467883433, -0.18667036572780393, 0.12909690348449493, -0.5777050366627182, 0.38790818556587925, -0.03455420420866631, 0.2521998313698651, 0.2522275885761841, 0.25097650987815523, 0.21256365493018475, 0.4406863450775138, -0.07819611927891953, 0.07587133068400234, 0.2632134257544718, -0.6415440320038228, 0.05124995001626026, -0.1767414436297925, -0.24246914260979086, -0.338571847289742, 0.21483495449255388, -0.3229255888333219, -0.07199864307599385],
        [-0.39160242358042946, -0.16134530371710776, 0.46555336270706227, -0.3394623581586844, 0.5031305235512509, 0.7314391012509215, 0.1266883508642425, 0.44419263204459114, -0.2808593742641189, 0.5417972586231993, 0.1843965718350277, -0.35788259443761905, -0.8193905513057221, -0.10780914617362286, -0.39656004845784765, -0.27761678053703087, -0.09398645818794296, 0.43928559595807837, 0.20775315827831287, -0.6077885105664197, -0.5023029903313124, -0.1333465715662987, -0.47768154310538624, 0.17087315244251583, 0.45435187275830496, 0.510020353660775, 0.0949749764287343, 0.019739974727221665, -0.008828707869123292, 0.2232835385643469],
        [-0.6610737817430957, 0.21235972545049517, 0.30368026193672504, 0.20764504955380048, -0.13615718991195438, 0.03281183661376963, 0.4514937186351503, -0.054869371231186403, 0.21071412408577866, -0.09345912666162204, -0.1659068934720344, 0.41299528263039714, 0.45405139507149, 0.22801776609787025, -0.642380501557519, -0.319853912356299, 0.719252468933344, -0.3522194712129756, -0.565583771287912, 0.3341465443900812, 0.6068260177923867, -0.025589002436567265, -0.26337562864346536, 0.00690392328041875, 0.027780261823982532, 0.07485393534252438, 0.5057436307208727, -0.36674580232138426, -0.36471257533260526, 0.7928234991686849],
        [0.8065523814719902, -0.36943762380588585, -0.21311920492789346, 0.41778489674363434, 0.35019288619015626, -0.18998622317609343, -0.23301566911104613, 0.31711875996214256, 0.1370340917183983, -0.3749346254952983, -0.3373056707458486, -0.16046636870617761, -0.9643655176269585, 0.24705778517160132, 0.03645246961244829, 0.13329625551075858, -0.05149119011253189, -0.40643463965352095, -0.16682553579856557, 0.573086397804961, -0.03650358221526426, -0.16833618368872252, -0.3525798849882409, -0.5853101515028365, -0.3610762766963322, 0.25968848482361473, -0.37031314191744324, 0.3193025496915025, 0.027769492121745343, 0.15253502525765555],
        [0.6792405488658713, -0.1847238459840437, -0.10861991134489622, -0.07451629609744548, 0.6175402630727483, -0.6113744458428834, -0.21621742412280864, 0.08673952213390404, -0.14078090723005743, -0.007111751610328079, -0.01919782209027585, 0.06937788854645449, 0.3699711008032469, -0.481850510930375, -0.18977606138728748, -0.05232535633300299, 0.06177395554944698, 0.18012204824330977, -0.11491007222387056, 0.11009868194124217, 0.12117014396089262, -0.06295978132108862, -0.46989939575632095, -0.6982186412661279, -0.021149392450073034, -0.0035629159757058493, -0.29364472575765915, -0.7979812199908445, 0.27280828924008893, 0.006898655227301029],
        [-0.04316062688718403, 0.574420520356522, 0.37533524133818885, 0.15959679574442548, 0.14843422189720235, -0.43304577030751057, 0.325579640829939, -0.34368983825305516, -0.20653147477911787, 0.06368473049219464, 0.3804075259632366, -0.014595794565488557, 0.3850372654425368, 0.12731034254568774, -0.29045275181788877, -0.06237910945564258, -0.40428656430234206, 0.34902577104237026, 0.25702327316526513, 0.2594988367217502, -0.8364188970267952, -0.14109747191434935, 0.17775836804212827, -0.0500392460663695, -0.5124173168738126, 0.20853742504417522, -0.13983479709984473, 0.2170661192391326, -0.027320657589434444, 0.591969011112866],
        [0.5783213302832911, -0.1545603277394636, 0.42051821643793336, 0.10676674457110082, 0.3792453413707366, 0.4815177522812151, -0.1866608777464108, -0.3433656572428487, 0.06489966446424802, 0.40125367716201266, 0.4157713116814852, -0.28374383836537775, 0.3784348692469739, -0.13105506522915678, -0.2309261097981483, 0.2754540704209427, -0.3875060957299661, 0.009502706750420975, 0.27630216298925897, -0.48928819931944995, 0.26759686911936764, -0.4809468998639298, 0.34670144998754526, -0.25254702115250655, -0.15295804897116805, -0.5675911915936362, 0.7620147204347847, -0.45262292056251574, -0.5786079834494645, -0.06323848557037004],
        [-0.34283350701149484, -0.6730636348570841, 0.4040560678784033, -0.599052465082982, -0.7782280087706768, -0.13476955308265137, 0.5604033818496315, -0.20871972306828296, -0.06885428916336744, 0.13117770459667655, 0.25037270345265106, 0.2622538342689601, -0.1431350704326102, -0.2533509573406501, -0.440743862212319, 0.0382534413200026, 0.25271315612534456, 0.1705531546405306, 0.5798203435504045, 0.29874459826759076, -0.310298539084251, 0.2901520296222533, -0.5535259310794999, -0.3514414711167972, 0.3219512330377871, 0.2517175000672037, 0.6782092133186561, -0.22640629174595972, 0.2203653570108618, 0.48304043867717905],
        [0.5135248018314362, -0.006235840069804793, -0.04838540262927399, -0.6721917286548158, 0.34404985747693145, 0.23521675246662052, 0.07953622556706605, -0.06122689574769502, 0.7980864010179608, -0.22068286594611244, 0.3413333711714845, -0.1260520344820353, 0.4063762808634639, -0.12222110867497038, -0.5006738406258504, -0.32605974725293285, -0.4073742230890023, -0.9775655388978536, 0.13296528634549526, 0.192416656460478, 0.27953096426311635, 0.43124275149536223, 0.0314306666362861, 0.6300802493299325, -0.36366018754884005, -0.27314682030401294, -0.35866117345430376, -0.0623746894117953, 0.31657772278189067, 0.21376637178644892],
        [-0.10884321719699523, 0.07686025056311094, -0.10582938903651766, -0.1472760627542356, -0.08747458615172049, 0.12867576853006965, 0.7795987520136758, -0.2660343089151356, 0.7165441120793062, 0.34228742207933, -0.5618887260707238, -0.46996310211928066, 0.24891926708010514, 0.13467100131340617, 0.3969258970894423, 0.6293270433141338, -0.07754649559429216, 0.1442840208339526, -0.2270049675065653, 0.0739791203118698, 0.13682962377700583, 0.7243877652758502, 0.14778082865760023, -0.2698638862808016, 0.1307624490101824, -0.0626325286247561, -0.38964188857768534, -0.08605875870375215, 0.3324519244252263, 0.014277717116738808],
        [0.2895574369050755, 0.1094120367389521, -0.2334579666143783, 0.45859411071183576, -0.03340292195612482, -0.18611488545142055, 0.40158808985003736, 0.335288968332504, -0.3405867450606367, -0.08539935723314102, -0.13534035734723454, -0.6205314824194255, -0.4429401619786058, 0.3011139949815606, -0.5379569193754152, 0.30465525643110253, 0.14030993165994204, 0.36258694309133654, 0.2145373797261815, 0.07498498997621326, -0.4324530774688801, -0.3286489033067833, 0.5667164692446627, 0.1447636406413772, 0.5422185612527602, 0.4089258905299314, 0.40617750549030573, -0.7267811667808712, 0.3516694489491435, -0.30418104038503935],
        [0.20222180340125934, 0.2831776309749603, 0.060166348373850945, -0.5855255552561192, -0.03447793629134796, 0.32445088725002036, 0.1546497277615667, 0.324723999385197, -0.4562959708036036, -0.09816065239612798, 0.020915161109898647, -0.17459557476707283, 0.1394657999015317, 0.18384009162983622, 0.36973363809298176, -0.4381809208188648, -0.5703897438970137, 0.33352422835436446, -0.18797849165466013, 0.631859160342295, 0.3514560200448847, 0.3087307753663644, -0.2515569296419355, 0.03944009267676457, -0.41258704221456, 0.44633263448637195, 0.5732361908918623, 0.39444138036023885, -0.26512571654485284, -0.6018352066208573],
        [-0.5206829905051273, -0.23135859613942492, -0.24296092603616903, 0.5067548607658765, -0.10564890045897368, -0.24048658200075512, -0.7772497674708043, 0.44406441914299977, -0.25431847316375034, 0.14323570082190917, -0.356622688062133, -0.24078911517925972, 0.10355571659093331, -0.001453627978651284, -0.22707022532228102, 0.4682172800208123, -0.37166534546550756, 0.0759457827772767, -0.5096957244960226, 0.5755751510073313, -0.013887151280500318, 0.3251546398415122, 0.3213560243315437, 0.1385799433465439, 0.2375563487573703, -0.4303408021654781, -0.151821997432602, -0.25028100177204743, 0.1457395195025717, 0.776309709064163],
        [0.42836252552949206, -0.33718197585321724, 0.21548035377577868, -0.40507662797645944, 0.2014274832905996, -0.5433793884340921, 0.1224415250293831, 0.5393306791753718, 0.27416686032695486, 0.082632023074415, -0.7884658902824764, 0.352516410343092, -0.3215340918790108, 0.3063978302657008, -0.35842337232209986, 0.15918686812857288, -0.5066182271884826, 0.24318494071384883, -0.07990729625099985, -0.34223427859471983, 0.026389823884251817, -0.012190771423593136, -0.38440465561717074, 0.4422050016374801, 0.5004188286541862, -0.48797366693918576, -0.5257294178775168, 0.27044826965888685, 0.06374658128407093, -0.21055537254768195],
        [-0.07229172521248685, -0.012619021504288216, -0.10306990613044381, 0.5773822518003995, 0.06888051451486416, 0.43713082352039045, 0.5885415309525811, 0.15509576744315207, -0.0646716677963939, -0.4195382156489882, 0.0077740925641710396, 0.25114301460843375, 0.045871547106996174, -0.08119450771007011, 0.8255692518586322, -0.10746168444798904, -0.7233908867213177, -0.28733213848659256, -0.07042257148949574, -0.33736998430157605, -0.31615772012747434, 0.637471243102823, 0.3342620958158797, 0.10193483134353173, 0.22375768368727963, 0.25939635951333456, 0.2895429558698939, 0.0938692733504595, -0.35688342388508215, 0.33223137855053053],
        [-0.18699662934090575, -0.25626959260136895, 0.21645569641934304, -0.5729028966371135, -0.1757924340162676, -0.3096075782754243, 0.07831552044106763, 0.15162561197553526, -0.5420221467353463, -0.3045924843328466, 0.4368657815598125, -0.21463743674331837, -0.4578505782102571, -0.3066597950800175, 0.27053121874282693, 0.20836974921463403, 0.13800460199956427, 0.36587732428809083, 0.04237344159534795, 0.11961652698091832, 0.07333226939939147, 0.30418372479105804, 0.8086105436243229, -0.1881215194116193, 0.3288548599042146, 0.2429985863774975, -0.36775767269543636, -0.5799500101784082, -0.7581937239986651, -0.02363706621763853],
        [-0.18164178957187238, -0.3975578037882955, 0.9031749527859909, 0.06435313172171045, -0.18373217556008753, 0.12856849436939927, 0.03605582300233018, -0.22177090943159183, 0.46766398866629866, -0.45862241453424646, 0.6090704190704241, -0.16871814723754863, -0.05282949041805468, -0.23775525925864419, 0.1458537535172106, 0.3601499062837886, -0.3548351717298724, 0.11465124307727872, -0.7408734746734618, -0.17028472651884238, 0.016211503505893607, 0.08555954360280565, -0.19327077449197183, 0.3477159638225413, 0.1405951388246403, 0.6741091274493876, 0.18351925802796182, 0.28709379999081447, 0.09649713320812849, 0.1770619974289314],
        [-0.2959998782373478, -0.31893488942623544, 0.2884344740408862, 0.12777785918551032, -0.3298828917178556, -0.01296814707209483, -0.026207430454604275, -0.3195494668334498, -0.13831150022629682, -0.06202930628131616, 0.5038326313361795, 0.06812820721374047, -0.3883804678776764, 0.42117399995432425, 0.6719523175060682, -0.7829119058233104, -0.2545728223200528, 0.030432611272681168, 0.46105781013008984, 0.3455033529988476, 0.38043039410177476, 0.015592560744472711, -0.0782236623864884, 0.10723363542970979, -0.0785484717132918, -0.5242356949446266, -0.3076345938849563, -0.5447340695866476, 0.20827160167719058, -0.24714630791611464],
        [0.39091730874319836, -0.14301948453718222, -0.416573974498724, 0.21058636576321915, -0.042392695980575545, 0.9692299560410524, 0.18067532655955904, 0.07048923752150876, -0.25753083434238133, -0.02811434559196349, 0.4084048583145683, 0.25263554314386394, 0.24018893308181855, -0.45088121570201556, -0.37543681788595623, -0.21472728196743884, -0.20185399884279412, 0.6453208405376091, 0.25181311449736976, -0.34569454269251476, 0.376170751494547, -0.19323458373162783, -0.09873617008670921, -0.11693468261985994, -0.12211990315128496, -0.5205620314235212, -0.3819412010822847, -0.024201460578551548, -0.43322487076976357, 0.40659980395686357],
        [0.32490256897373954, 0.273641936177235, 0.6409145677667029, 0.010478884705160063, -0.13968486757812731, 0.36348706825807253, -0.47939360842532897, 0.5215045445963201, -0.08475159525065415, -0.38274255200218354, -0.24647385601789726, 0.09939948553816708, 0.24046412030140712, -0.05198426665156987, -0.050031793748498476, 0.01728344868408335, 0.6783139651058665, 0.22122649826282775, -0.15006430849891333, 0.4093345419333876, -0.3604899816439195, 0.527653545494235, 0.1341756137913044, 0.2921984039295986, -0.4290151283670982, -0.48997286041670407, 0.090580797885915, -0.14809464302004724, -0.007510073366799333, 0.21560238869439494],
        [0.20386338576133167, 0.49707514715466306, 0.3049937683144083, 0.5062407667254119, -0.9414667369063229, 0.013418269930532703, -0.5051597908533171, 0.3924810115481096, 0.19273242642462857, -0.2537293164221322, 0.48713589276149327, 0.4290184531975732, -0.6419506493670214, -0.2592152788761851, 0.0038551191121315442, -0.1300980835925416, -0.6166597563107101, -0.36683498615168486, -0.41225121218445687, 0.2231510516544806, 0.08715996651143887, -0.21546515642668754, -0.014515945995269355, -0.9197293583873759, -0.17423640730171053, 0.3751523690314758, 0.0875330631809718, -0.36273892066117197, -0.38622720112210185, -0.22233035439369653],
        [0.8140328127660865, 0.2446917807402485, 0.7860284456563504, 0.18734273423462533, 0.16666056758952214, 0.22948096689199932, -0.1792347287266782, -0.16358616668219433, -0.3989444091550533, 0.272957753954343, -0.08143602516667217, 0.049539361244016714, -0.02326210498902423, -0.1404812384357955, 0.11718385884214445, 0.112366644401973, -0.1595835299923443, -0.44416703842723465, 0.9084248633577152, 0.3743265373824697, 0.7640412871510154, 0.35743439721802656, 0.06527304586232732, 0.42585937544467023, 0.809885878410352, 0.4000640530709614, -0.26865180542075917, -0.17160132630425895, 0.5267642382760309, 0.02882298134604211],
        [0.339038897179861, 0.5061272784823421, 0.2722285063723555, -0.08024349582890891, 0.035515754410313086, 0.29566436303920507, -0.1984798774986795, -0.37025124191924835, -0.012655290497039076, -0.30838044519764707, -0.8855288593872315, -0.43679212531806566, -0.034416560576147615, -0.23338149640589623, 0.2532464780575538, -0.7065134108451461, -0.2794681789552189, -0.41001645838043077, -0.033598119177321834, 0.09514136754983767, -0.44522949863169964, -0.5680023381620815, -0.325754877478974, 0.43204808140388473, 0.13389718193679792, -0.22126061393205954, 0.044064658248676225, 0.06399776648419692, -0.0759510558039012, 0.29874829315486817],
    ])

    def __init__(self):
        rest_h = [self.CEC2017_C23_h1]
        rest_g = [self.CEC2017_C23_g1]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        M = self.select_matrix(D)
        z = generate_z_y(x, self.o[:D], 'matrix_multiply', M)
        term1 = -20 * np.exp(-0.2 * np.sqrt(np.sum(z**2) / D))
        term2 = 20 - np.exp(np.sum(np.cos(2 * np.pi * z) / D))
        f_x = term1 + term2 + np.e
        return f_x
    
    @staticmethod
    def select_matrix(D):
        if D == 10:
            return CEC2017_C23.M10
        elif D == 30:
            return CEC2017_C23.M30
        else:
            raise ValueError("Dimensión no soportada")
    
    @staticmethod
    def CEC2017_C23_g1(x):
        M = CEC2017_C23.select_matrix(D)
        z = generate_z_y(x, CEC2017_C23.o[:D], 'matrix_multiply', M)
        return np.sum(z[1:]**2) + 1 - np.abs(z[0])
    
    @staticmethod
    def CEC2017_C23_h1(x):
        M = CEC2017_C23.select_matrix(D)
        z = generate_z_y(x, CEC2017_C23.o[:D], 'matrix_multiply', M)
        return np.sum(z**2) - 4
    
class CEC2017_C24(Problem):
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    M10 = np.array([
        [-1.4750691585532323, -0.5745205005115123, -0.005699772438594958, 0.6648210730157429, -0.1041634598061256, -0.8978855297957111, -0.901994204541452, -0.6065324100090661, -0.4063251172471228, 0.15528244331830426],
        [0.5592150245095672, 0.04993662795408019, 0.4215715110001431, 0.8658026703900705, 0.6947904462259192, -0.18507116388982225, -0.022188704511750743, -0.649218872652057, 0.07356091714854926, -0.7961176305125455],
        [0.6352998982037079, 0.5943504059660697, 1.103253878964802, -1.1285189770235082, 0.7046494430751651, 0.2755757486743495, -1.0399669162892367, 0.11685698852943777, -0.32902335058747467, 0.07790036419589119],
        [-0.35941283248531275, 0.37082704554158386, -0.5271046483443762, -0.26665593788738984, -0.5141977194125844, 0.5821194001685648, -0.047299261268575435, -0.46312553098784154, -0.10196330326631606, -0.9522639457792393],
        [-0.5839720120889139, 1.7714876607340784, 0.013650083503154053, 0.3212225620402597, 0.7904281214026975, 0.4093923866971973, 0.33744753474799605, 0.5942128150118153, -0.15480530100758425, -0.5237685825508689],
        [-0.17838596502167076, 0.24992500534286521, -0.17316389205861768, -0.005036558084014708, -0.17668981043919074, 0.282386956005954, -1.0946510657454087, 0.45147932173029537, 1.0574055589046905, -0.0074876994077884285],
        [-0.5913243068007854, -0.27049755413083576, -0.3130389318979534, 0.6376303913429255, 1.2741644739500224, 0.7811212288227438, 0.1820711612625297, -0.05528506550771772, 0.27980292347560093, 0.055727088016825216],
        [-0.20277428932485703, 1.0079304172848664, 0.01437318812037941, 0.14803052734314798, 0.45096233182274637, -0.5822593030942272, 0.452115990237956, -0.8708036252941136, 0.4357530932226235, 0.3651693399025321],
        [-0.9026689569470502, 0.17486172336358063, -0.27450550855066735, -0.3661547399904748, 0.6032348252987877, -0.762354545526245, 0.9197863043444101, -0.06739961818174695, 0.5329960368512198, -0.9498570741645186],
        [0.3809013727921987, 0.8270471805962801, -0.9297598191669905, -0.5709424218088751, 1.0158877843868521, -0.39993664335293944, -0.7407173804723235, 0.40730997988162376, -0.3708088890828746, -0.193514070829618],
    ])
    M30 = np.array([
        [-0.5159828783208829, -0.461752601502956, -0.47478430536873406, 0.30906472546822983, 0.0821092546309288, 0.12399425682320928, -0.27213943183862804, -0.6066294974432846, 0.777839341246011, -0.05737011470108, -0.09789520372128557, 0.17520766757008754, 0.15816790642936068, 0.11980961854461003, -0.468153550081146, -0.3620869598650572, -0.4886255076540601, 0.23469980700329732, 0.6450256970330783, 0.49857302334610387, 0.06300037478185166, 0.5766729714557522, 0.0934670738279128, -0.0882071137775379, 0.8805338407901566, 0.37503612382206475, 0.48038544171877795, 0.6074904320527752, -0.06333768975160145, -0.44730035615863784],
        [0.1880754930560265, -0.2720272048289167, 0.1869512122668153, 0.0438983891578362, -0.23549495408004903, -0.6163739419294972, 0.060500463921530634, 0.2676085722425896, 0.5259478346689614, 0.7720494183015834, 0.21960696988918912, 0.15824113495025177, 0.2970151280048526, -0.20379644304513045, 0.641572164969781, -0.418148640182776, 0.22926624189809053, 0.0612419752999645, 0.06791073974691907, -0.032319295885730404, 0.26292640093486397, -0.6480198792924795, 0.2810103744453979, 0.14392792999580045, -0.004528918141343957, -0.005930953273363987, 0.13708107902261224, 0.4968959791866978, -0.10313184784018095, -0.0894528902124122],
        [0.08677860222719772, -0.13415840828119555, 0.5277280418242739, 0.7478122408419924, -0.3125793907217645, 0.38174655051775797, 0.019187525091114474, -0.02240431729236165, -0.5672989058308923, 0.5492354632829972, 0.03655749312790477, -0.39925649810781727, 0.3782977840936688, -0.2512456032672451, -0.3288950029473213, 0.046264440515645315, -0.17471382325041543, -0.650841654577202, -0.26557166002512683, 0.1268686931172478, -0.7752632273386695, 0.3580039025191851, -0.12818030147444026, 0.32101908684569186, 0.15687161215857892, 0.13220017059437858, -0.49611842100609715, -0.16172585090258718, -0.21068271845999856, 0.06731164664251577],
        [-0.0725281242535927, 0.03923363692533671, -0.08451736708855691, 0.911569016239978, 0.27124084181504265, 0.10678488576778121, 0.35154106042529, -0.10959240726719924, -0.3567424184683352, -0.05139206973406582, -0.6458723265904243, -0.17894980229733576, -0.07928189820709317, -0.5534977733755848, -0.3566608623377477, -0.8775717680937246, 0.1069956028157045, -0.2962152465741139, 0.28338354399572724, -0.5383563973668849, 0.2703419660432148, -0.16167942534080176, 0.5163599860818278, -0.5075463963316947, -0.42222755988115773, -0.1523082265251643, 0.3179043033149148, 0.15263148427625017, 0.3186760724944154, -0.007851425697908351],
        [-0.31085059906248025, 0.10773533790008274, 0.21073657512338226, -0.10389714926279825, 0.5006811426159044, 0.6623146979279007, 0.18396874003818742, 0.4617016641762331, -0.5207289159776659, -0.459362028051465, 0.2248991081068287, 0.5680604512423484, 0.3580388165911977, -0.5972146208123865, -0.10433733437648485, -0.014334357116532304, 0.2136845387221096, 0.02439187568807852, 0.23838451766550403, 0.8003915687344867, 0.17872570272597937, -0.5990516448807318, 0.07468653669771103, -0.11529657547119215, -0.08040488050924052, -0.15763218727718675, 0.045919794915371376, 0.3255337153852049, 0.031667282607729774, -0.3317721297284485],
        [0.2882048920773465, -0.14256137622938297, -0.019521164467690172, 0.07084318546010558, -0.09866229014877709, -0.05483664131209329, 0.24968096019471414, -0.6727823205366663, 0.4586423492380458, 0.3840739208227191, 0.10221117432596505, 0.6214137152153121, -0.35242425225098173, -0.5147009154991066, -0.2432463255125819, 0.41179287638035006, -0.315762865887315, -0.3291344064387964, 0.1265193422046716, 0.4787872505741223, -0.14613755535479894, -0.26570943449791184, -0.005485711613561428, 0.49740982236653974, -0.7456385848841535, 0.23704600300129444, 0.3151189427848705, -0.8387615933341264, -0.3854546723830116, -0.022971162158202607],
        [-0.14020032347982048, -0.4683963350040242, -0.05914086143651759, -0.11713500626369226, -0.5481583954724735, 0.4149081840406875, -0.4826214863595243, 0.22391503154961157, -0.09275195276145468, 0.1934587155705878, -0.6390135722335628, 0.36082151781342514, 0.7102948755837191, 0.6954746868245145, 0.2404309981725236, 0.12588166150775848, -0.21052278602763508, 0.044744177933926085, 0.5293182558732803, 0.004181320427426083, -0.06761409605410526, -0.21107664286819583, 0.05833511988247723, 0.0032020184528783885, -0.3345616807067034, 0.5524538826202322, -0.3721275561601629, -0.2637795025196129, -0.12107475788566177, 0.3432266282645529],
        [-0.7154165286229367, 0.31528103197398066, 0.01647640590023225, 0.39882899107397285, -0.14415437963892944, -0.2500593216791629, -0.16311945583262297, 0.5067356779768416, -0.1590560467883433, -0.18667036572780393, 0.12909690348449493, -0.5777050366627182, 0.38790818556587925, -0.03455420420866631, 0.2521998313698651, 0.2522275885761841, 0.25097650987815523, 0.21256365493018475, 0.4406863450775138, -0.07819611927891953, 0.07587133068400234, 0.2632134257544718, -0.6415440320038228, 0.05124995001626026, -0.1767414436297925, -0.24246914260979086, -0.338571847289742, 0.21483495449255388, -0.3229255888333219, -0.07199864307599385],
        [-0.39160242358042946, -0.16134530371710776, 0.46555336270706227, -0.3394623581586844, 0.5031305235512509, 0.7314391012509215, 0.1266883508642425, 0.44419263204459114, -0.2808593742641189, 0.5417972586231993, 0.1843965718350277, -0.35788259443761905, -0.8193905513057221, -0.10780914617362286, -0.39656004845784765, -0.27761678053703087, -0.09398645818794296, 0.43928559595807837, 0.20775315827831287, -0.6077885105664197, -0.5023029903313124, -0.1333465715662987, -0.47768154310538624, 0.17087315244251583, 0.45435187275830496, 0.510020353660775, 0.0949749764287343, 0.019739974727221665, -0.008828707869123292, 0.2232835385643469],
        [-0.6610737817430957, 0.21235972545049517, 0.30368026193672504, 0.20764504955380048, -0.13615718991195438, 0.03281183661376963, 0.4514937186351503, -0.054869371231186403, 0.21071412408577866, -0.09345912666162204, -0.1659068934720344, 0.41299528263039714, 0.45405139507149, 0.22801776609787025, -0.642380501557519, -0.319853912356299, 0.719252468933344, -0.3522194712129756, -0.565583771287912, 0.3341465443900812, 0.6068260177923867, -0.025589002436567265, -0.26337562864346536, 0.00690392328041875, 0.027780261823982532, 0.07485393534252438, 0.5057436307208727, -0.36674580232138426, -0.36471257533260526, 0.7928234991686849],
        [0.8065523814719902, -0.36943762380588585, -0.21311920492789346, 0.41778489674363434, 0.35019288619015626, -0.18998622317609343, -0.23301566911104613, 0.31711875996214256, 0.1370340917183983, -0.3749346254952983, -0.3373056707458486, -0.16046636870617761, -0.9643655176269585, 0.24705778517160132, 0.03645246961244829, 0.13329625551075858, -0.05149119011253189, -0.40643463965352095, -0.16682553579856557, 0.573086397804961, -0.03650358221526426, -0.16833618368872252, -0.3525798849882409, -0.5853101515028365, -0.3610762766963322, 0.25968848482361473, -0.37031314191744324, 0.3193025496915025, 0.027769492121745343, 0.15253502525765555],
        [0.6792405488658713, -0.1847238459840437, -0.10861991134489622, -0.07451629609744548, 0.6175402630727483, -0.6113744458428834, -0.21621742412280864, 0.08673952213390404, -0.14078090723005743, -0.007111751610328079, -0.01919782209027585, 0.06937788854645449, 0.3699711008032469, -0.481850510930375, -0.18977606138728748, -0.05232535633300299, 0.06177395554944698, 0.18012204824330977, -0.11491007222387056, 0.11009868194124217, 0.12117014396089262, -0.06295978132108862, -0.46989939575632095, -0.6982186412661279, -0.021149392450073034, -0.0035629159757058493, -0.29364472575765915, -0.7979812199908445, 0.27280828924008893, 0.006898655227301029],
        [-0.04316062688718403, 0.574420520356522, 0.37533524133818885, 0.15959679574442548, 0.14843422189720235, -0.43304577030751057, 0.325579640829939, -0.34368983825305516, -0.20653147477911787, 0.06368473049219464, 0.3804075259632366, -0.014595794565488557, 0.3850372654425368, 0.12731034254568774, -0.29045275181788877, -0.06237910945564258, -0.40428656430234206, 0.34902577104237026, 0.25702327316526513, 0.2594988367217502, -0.8364188970267952, -0.14109747191434935, 0.17775836804212827, -0.0500392460663695, -0.5124173168738126, 0.20853742504417522, -0.13983479709984473, 0.2170661192391326, -0.027320657589434444, 0.591969011112866],
        [0.5783213302832911, -0.1545603277394636, 0.42051821643793336, 0.10676674457110082, 0.3792453413707366, 0.4815177522812151, -0.1866608777464108, -0.3433656572428487, 0.06489966446424802, 0.40125367716201266, 0.4157713116814852, -0.28374383836537775, 0.3784348692469739, -0.13105506522915678, -0.2309261097981483, 0.2754540704209427, -0.3875060957299661, 0.009502706750420975, 0.27630216298925897, -0.48928819931944995, 0.26759686911936764, -0.4809468998639298, 0.34670144998754526, -0.25254702115250655, -0.15295804897116805, -0.5675911915936362, 0.7620147204347847, -0.45262292056251574, -0.5786079834494645, -0.06323848557037004],
        [-0.34283350701149484, -0.6730636348570841, 0.4040560678784033, -0.599052465082982, -0.7782280087706768, -0.13476955308265137, 0.5604033818496315, -0.20871972306828296, -0.06885428916336744, 0.13117770459667655, 0.25037270345265106, 0.2622538342689601, -0.1431350704326102, -0.2533509573406501, -0.440743862212319, 0.0382534413200026, 0.25271315612534456, 0.1705531546405306, 0.5798203435504045, 0.29874459826759076, -0.310298539084251, 0.2901520296222533, -0.5535259310794999, -0.3514414711167972, 0.3219512330377871, 0.2517175000672037, 0.6782092133186561, -0.22640629174595972, 0.2203653570108618, 0.48304043867717905],
        [0.5135248018314362, -0.006235840069804793, -0.04838540262927399, -0.6721917286548158, 0.34404985747693145, 0.23521675246662052, 0.07953622556706605, -0.06122689574769502, 0.7980864010179608, -0.22068286594611244, 0.3413333711714845, -0.1260520344820353, 0.4063762808634639, -0.12222110867497038, -0.5006738406258504, -0.32605974725293285, -0.4073742230890023, -0.9775655388978536, 0.13296528634549526, 0.192416656460478, 0.27953096426311635, 0.43124275149536223, 0.0314306666362861, 0.6300802493299325, -0.36366018754884005, -0.27314682030401294, -0.35866117345430376, -0.0623746894117953, 0.31657772278189067, 0.21376637178644892],
        [-0.10884321719699523, 0.07686025056311094, -0.10582938903651766, -0.1472760627542356, -0.08747458615172049, 0.12867576853006965, 0.7795987520136758, -0.2660343089151356, 0.7165441120793062, 0.34228742207933, -0.5618887260707238, -0.46996310211928066, 0.24891926708010514, 0.13467100131340617, 0.3969258970894423, 0.6293270433141338, -0.07754649559429216, 0.1442840208339526, -0.2270049675065653, 0.0739791203118698, 0.13682962377700583, 0.7243877652758502, 0.14778082865760023, -0.2698638862808016, 0.1307624490101824, -0.0626325286247561, -0.38964188857768534, -0.08605875870375215, 0.3324519244252263, 0.014277717116738808],
        [0.2895574369050755, 0.1094120367389521, -0.2334579666143783, 0.45859411071183576, -0.03340292195612482, -0.18611488545142055, 0.40158808985003736, 0.335288968332504, -0.3405867450606367, -0.08539935723314102, -0.13534035734723454, -0.6205314824194255, -0.4429401619786058, 0.3011139949815606, -0.5379569193754152, 0.30465525643110253, 0.14030993165994204, 0.36258694309133654, 0.2145373797261815, 0.07498498997621326, -0.4324530774688801, -0.3286489033067833, 0.5667164692446627, 0.1447636406413772, 0.5422185612527602, 0.4089258905299314, 0.40617750549030573, -0.7267811667808712, 0.3516694489491435, -0.30418104038503935],
        [0.20222180340125934, 0.2831776309749603, 0.060166348373850945, -0.5855255552561192, -0.03447793629134796, 0.32445088725002036, 0.1546497277615667, 0.324723999385197, -0.4562959708036036, -0.09816065239612798, 0.020915161109898647, -0.17459557476707283, 0.1394657999015317, 0.18384009162983622, 0.36973363809298176, -0.4381809208188648, -0.5703897438970137, 0.33352422835436446, -0.18797849165466013, 0.631859160342295, 0.3514560200448847, 0.3087307753663644, -0.2515569296419355, 0.03944009267676457, -0.41258704221456, 0.44633263448637195, 0.5732361908918623, 0.39444138036023885, -0.26512571654485284, -0.6018352066208573],
        [-0.5206829905051273, -0.23135859613942492, -0.24296092603616903, 0.5067548607658765, -0.10564890045897368, -0.24048658200075512, -0.7772497674708043, 0.44406441914299977, -0.25431847316375034, 0.14323570082190917, -0.356622688062133, -0.24078911517925972, 0.10355571659093331, -0.001453627978651284, -0.22707022532228102, 0.4682172800208123, -0.37166534546550756, 0.0759457827772767, -0.5096957244960226, 0.5755751510073313, -0.013887151280500318, 0.3251546398415122, 0.3213560243315437, 0.1385799433465439, 0.2375563487573703, -0.4303408021654781, -0.151821997432602, -0.25028100177204743, 0.1457395195025717, 0.776309709064163],
        [0.42836252552949206, -0.33718197585321724, 0.21548035377577868, -0.40507662797645944, 0.2014274832905996, -0.5433793884340921, 0.1224415250293831, 0.5393306791753718, 0.27416686032695486, 0.082632023074415, -0.7884658902824764, 0.352516410343092, -0.3215340918790108, 0.3063978302657008, -0.35842337232209986, 0.15918686812857288, -0.5066182271884826, 0.24318494071384883, -0.07990729625099985, -0.34223427859471983, 0.026389823884251817, -0.012190771423593136, -0.38440465561717074, 0.4422050016374801, 0.5004188286541862, -0.48797366693918576, -0.5257294178775168, 0.27044826965888685, 0.06374658128407093, -0.21055537254768195],
        [-0.07229172521248685, -0.012619021504288216, -0.10306990613044381, 0.5773822518003995, 0.06888051451486416, 0.43713082352039045, 0.5885415309525811, 0.15509576744315207, -0.0646716677963939, -0.4195382156489882, 0.0077740925641710396, 0.25114301460843375, 0.045871547106996174, -0.08119450771007011, 0.8255692518586322, -0.10746168444798904, -0.7233908867213177, -0.28733213848659256, -0.07042257148949574, -0.33736998430157605, -0.31615772012747434, 0.637471243102823, 0.3342620958158797, 0.10193483134353173, 0.22375768368727963, 0.25939635951333456, 0.2895429558698939, 0.0938692733504595, -0.35688342388508215, 0.33223137855053053],
        [-0.18699662934090575, -0.25626959260136895, 0.21645569641934304, -0.5729028966371135, -0.1757924340162676, -0.3096075782754243, 0.07831552044106763, 0.15162561197553526, -0.5420221467353463, -0.3045924843328466, 0.4368657815598125, -0.21463743674331837, -0.4578505782102571, -0.3066597950800175, 0.27053121874282693, 0.20836974921463403, 0.13800460199956427, 0.36587732428809083, 0.04237344159534795, 0.11961652698091832, 0.07333226939939147, 0.30418372479105804, 0.8086105436243229, -0.1881215194116193, 0.3288548599042146, 0.2429985863774975, -0.36775767269543636, -0.5799500101784082, -0.7581937239986651, -0.02363706621763853],
        [-0.18164178957187238, -0.3975578037882955, 0.9031749527859909, 0.06435313172171045, -0.18373217556008753, 0.12856849436939927, 0.03605582300233018, -0.22177090943159183, 0.46766398866629866, -0.45862241453424646, 0.6090704190704241, -0.16871814723754863, -0.05282949041805468, -0.23775525925864419, 0.1458537535172106, 0.3601499062837886, -0.3548351717298724, 0.11465124307727872, -0.7408734746734618, -0.17028472651884238, 0.016211503505893607, 0.08555954360280565, -0.19327077449197183, 0.3477159638225413, 0.1405951388246403, 0.6741091274493876, 0.18351925802796182, 0.28709379999081447, 0.09649713320812849, 0.1770619974289314],
        [-0.2959998782373478, -0.31893488942623544, 0.2884344740408862, 0.12777785918551032, -0.3298828917178556, -0.01296814707209483, -0.026207430454604275, -0.3195494668334498, -0.13831150022629682, -0.06202930628131616, 0.5038326313361795, 0.06812820721374047, -0.3883804678776764, 0.42117399995432425, 0.6719523175060682, -0.7829119058233104, -0.2545728223200528, 0.030432611272681168, 0.46105781013008984, 0.3455033529988476, 0.38043039410177476, 0.015592560744472711, -0.0782236623864884, 0.10723363542970979, -0.0785484717132918, -0.5242356949446266, -0.3076345938849563, -0.5447340695866476, 0.20827160167719058, -0.24714630791611464],
        [0.39091730874319836, -0.14301948453718222, -0.416573974498724, 0.21058636576321915, -0.042392695980575545, 0.9692299560410524, 0.18067532655955904, 0.07048923752150876, -0.25753083434238133, -0.02811434559196349, 0.4084048583145683, 0.25263554314386394, 0.24018893308181855, -0.45088121570201556, -0.37543681788595623, -0.21472728196743884, -0.20185399884279412, 0.6453208405376091, 0.25181311449736976, -0.34569454269251476, 0.376170751494547, -0.19323458373162783, -0.09873617008670921, -0.11693468261985994, -0.12211990315128496, -0.5205620314235212, -0.3819412010822847, -0.024201460578551548, -0.43322487076976357, 0.40659980395686357],
        [0.32490256897373954, 0.273641936177235, 0.6409145677667029, 0.010478884705160063, -0.13968486757812731, 0.36348706825807253, -0.47939360842532897, 0.5215045445963201, -0.08475159525065415, -0.38274255200218354, -0.24647385601789726, 0.09939948553816708, 0.24046412030140712, -0.05198426665156987, -0.050031793748498476, 0.01728344868408335, 0.6783139651058665, 0.22122649826282775, -0.15006430849891333, 0.4093345419333876, -0.3604899816439195, 0.527653545494235, 0.1341756137913044, 0.2921984039295986, -0.4290151283670982, -0.48997286041670407, 0.090580797885915, -0.14809464302004724, -0.007510073366799333, 0.21560238869439494],
        [0.20386338576133167, 0.49707514715466306, 0.3049937683144083, 0.5062407667254119, -0.9414667369063229, 0.013418269930532703, -0.5051597908533171, 0.3924810115481096, 0.19273242642462857, -0.2537293164221322, 0.48713589276149327, 0.4290184531975732, -0.6419506493670214, -0.2592152788761851, 0.0038551191121315442, -0.1300980835925416, -0.6166597563107101, -0.36683498615168486, -0.41225121218445687, 0.2231510516544806, 0.08715996651143887, -0.21546515642668754, -0.014515945995269355, -0.9197293583873759, -0.17423640730171053, 0.3751523690314758, 0.0875330631809718, -0.36273892066117197, -0.38622720112210185, -0.22233035439369653],
        [0.8140328127660865, 0.2446917807402485, 0.7860284456563504, 0.18734273423462533, 0.16666056758952214, 0.22948096689199932, -0.1792347287266782, -0.16358616668219433, -0.3989444091550533, 0.272957753954343, -0.08143602516667217, 0.049539361244016714, -0.02326210498902423, -0.1404812384357955, 0.11718385884214445, 0.112366644401973, -0.1595835299923443, -0.44416703842723465, 0.9084248633577152, 0.3743265373824697, 0.7640412871510154, 0.35743439721802656, 0.06527304586232732, 0.42585937544467023, 0.809885878410352, 0.4000640530709614, -0.26865180542075917, -0.17160132630425895, 0.5267642382760309, 0.02882298134604211],
        [0.339038897179861, 0.5061272784823421, 0.2722285063723555, -0.08024349582890891, 0.035515754410313086, 0.29566436303920507, -0.1984798774986795, -0.37025124191924835, -0.012655290497039076, -0.30838044519764707, -0.8855288593872315, -0.43679212531806566, -0.034416560576147615, -0.23338149640589623, 0.2532464780575538, -0.7065134108451461, -0.2794681789552189, -0.41001645838043077, -0.033598119177321834, 0.09514136754983767, -0.44522949863169964, -0.5680023381620815, -0.325754877478974, 0.43204808140388473, 0.13389718193679792, -0.22126061393205954, 0.044064658248676225, 0.06399776648419692, -0.0759510558039012, 0.29874829315486817],
    ])

    def __init__(self):
        rest_h = [self.CEC2017_C24_h1]
        rest_g = [self.CEC2017_C24_g1]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        M = self.select_matrix(D)
        z = generate_z_y(x, self.o[:D], 'matrix_multiply', M)
        f_x = np.max(np.abs(z))
        return f_x
    
    @staticmethod
    def select_matrix(D):
        if D == 10:
            return CEC2017_C24.M10
        elif D == 30:
            return CEC2017_C24.M30
        else:
            raise ValueError("Dimensión no soportada")
    
    @staticmethod
    def CEC2017_C24_g1(x):
        M = CEC2017_C24.select_matrix(D)
        z = generate_z_y(x, CEC2017_C24.o[:D], 'matrix_multiply', M)
        return np.sum(z**2) - 100 * D
    
    @staticmethod
    def CEC2017_C24_h1(x):
        M = CEC2017_C24.select_matrix(D)
        z = generate_z_y(x, CEC2017_C24.o[:D], 'matrix_multiply', M)
        f_x = np.max(np.abs(z))
        return np.cos(f_x) + np.sin(f_x)

class CEC2017_C25(Problem):
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    M10 = np.array([
        [-1.4750691585532323, -0.5745205005115123, -0.005699772438594958, 0.6648210730157429, -0.1041634598061256, -0.8978855297957111, -0.901994204541452, -0.6065324100090661, -0.4063251172471228, 0.15528244331830426],
        [0.5592150245095672, 0.04993662795408019, 0.4215715110001431, 0.8658026703900705, 0.6947904462259192, -0.18507116388982225, -0.022188704511750743, -0.649218872652057, 0.07356091714854926, -0.7961176305125455],
        [0.6352998982037079, 0.5943504059660697, 1.103253878964802, -1.1285189770235082, 0.7046494430751651, 0.2755757486743495, -1.0399669162892367, 0.11685698852943777, -0.32902335058747467, 0.07790036419589119],
        [-0.35941283248531275, 0.37082704554158386, -0.5271046483443762, -0.26665593788738984, -0.5141977194125844, 0.5821194001685648, -0.047299261268575435, -0.46312553098784154, -0.10196330326631606, -0.9522639457792393],
        [-0.5839720120889139, 1.7714876607340784, 0.013650083503154053, 0.3212225620402597, 0.7904281214026975, 0.4093923866971973, 0.33744753474799605, 0.5942128150118153, -0.15480530100758425, -0.5237685825508689],
        [-0.17838596502167076, 0.24992500534286521, -0.17316389205861768, -0.005036558084014708, -0.17668981043919074, 0.282386956005954, -1.0946510657454087, 0.45147932173029537, 1.0574055589046905, -0.0074876994077884285],
        [-0.5913243068007854, -0.27049755413083576, -0.3130389318979534, 0.6376303913429255, 1.2741644739500224, 0.7811212288227438, 0.1820711612625297, -0.05528506550771772, 0.27980292347560093, 0.055727088016825216],
        [-0.20277428932485703, 1.0079304172848664, 0.01437318812037941, 0.14803052734314798, 0.45096233182274637, -0.5822593030942272, 0.452115990237956, -0.8708036252941136, 0.4357530932226235, 0.3651693399025321],
        [-0.9026689569470502, 0.17486172336358063, -0.27450550855066735, -0.3661547399904748, 0.6032348252987877, -0.762354545526245, 0.9197863043444101, -0.06739961818174695, 0.5329960368512198, -0.9498570741645186],
        [0.3809013727921987, 0.8270471805962801, -0.9297598191669905, -0.5709424218088751, 1.0158877843868521, -0.39993664335293944, -0.7407173804723235, 0.40730997988162376, -0.3708088890828746, -0.193514070829618],
    ])
    M30 = np.array([
        [-0.5159828783208829, -0.461752601502956, -0.47478430536873406, 0.30906472546822983, 0.0821092546309288, 0.12399425682320928, -0.27213943183862804, -0.6066294974432846, 0.777839341246011, -0.05737011470108, -0.09789520372128557, 0.17520766757008754, 0.15816790642936068, 0.11980961854461003, -0.468153550081146, -0.3620869598650572, -0.4886255076540601, 0.23469980700329732, 0.6450256970330783, 0.49857302334610387, 0.06300037478185166, 0.5766729714557522, 0.0934670738279128, -0.0882071137775379, 0.8805338407901566, 0.37503612382206475, 0.48038544171877795, 0.6074904320527752, -0.06333768975160145, -0.44730035615863784],
        [0.1880754930560265, -0.2720272048289167, 0.1869512122668153, 0.0438983891578362, -0.23549495408004903, -0.6163739419294972, 0.060500463921530634, 0.2676085722425896, 0.5259478346689614, 0.7720494183015834, 0.21960696988918912, 0.15824113495025177, 0.2970151280048526, -0.20379644304513045, 0.641572164969781, -0.418148640182776, 0.22926624189809053, 0.0612419752999645, 0.06791073974691907, -0.032319295885730404, 0.26292640093486397, -0.6480198792924795, 0.2810103744453979, 0.14392792999580045, -0.004528918141343957, -0.005930953273363987, 0.13708107902261224, 0.4968959791866978, -0.10313184784018095, -0.0894528902124122],
        [0.08677860222719772, -0.13415840828119555, 0.5277280418242739, 0.7478122408419924, -0.3125793907217645, 0.38174655051775797, 0.019187525091114474, -0.02240431729236165, -0.5672989058308923, 0.5492354632829972, 0.03655749312790477, -0.39925649810781727, 0.3782977840936688, -0.2512456032672451, -0.3288950029473213, 0.046264440515645315, -0.17471382325041543, -0.650841654577202, -0.26557166002512683, 0.1268686931172478, -0.7752632273386695, 0.3580039025191851, -0.12818030147444026, 0.32101908684569186, 0.15687161215857892, 0.13220017059437858, -0.49611842100609715, -0.16172585090258718, -0.21068271845999856, 0.06731164664251577],
        [-0.0725281242535927, 0.03923363692533671, -0.08451736708855691, 0.911569016239978, 0.27124084181504265, 0.10678488576778121, 0.35154106042529, -0.10959240726719924, -0.3567424184683352, -0.05139206973406582, -0.6458723265904243, -0.17894980229733576, -0.07928189820709317, -0.5534977733755848, -0.3566608623377477, -0.8775717680937246, 0.1069956028157045, -0.2962152465741139, 0.28338354399572724, -0.5383563973668849, 0.2703419660432148, -0.16167942534080176, 0.5163599860818278, -0.5075463963316947, -0.42222755988115773, -0.1523082265251643, 0.3179043033149148, 0.15263148427625017, 0.3186760724944154, -0.007851425697908351],
        [-0.31085059906248025, 0.10773533790008274, 0.21073657512338226, -0.10389714926279825, 0.5006811426159044, 0.6623146979279007, 0.18396874003818742, 0.4617016641762331, -0.5207289159776659, -0.459362028051465, 0.2248991081068287, 0.5680604512423484, 0.3580388165911977, -0.5972146208123865, -0.10433733437648485, -0.014334357116532304, 0.2136845387221096, 0.02439187568807852, 0.23838451766550403, 0.8003915687344867, 0.17872570272597937, -0.5990516448807318, 0.07468653669771103, -0.11529657547119215, -0.08040488050924052, -0.15763218727718675, 0.045919794915371376, 0.3255337153852049, 0.031667282607729774, -0.3317721297284485],
        [0.2882048920773465, -0.14256137622938297, -0.019521164467690172, 0.07084318546010558, -0.09866229014877709, -0.05483664131209329, 0.24968096019471414, -0.6727823205366663, 0.4586423492380458, 0.3840739208227191, 0.10221117432596505, 0.6214137152153121, -0.35242425225098173, -0.5147009154991066, -0.2432463255125819, 0.41179287638035006, -0.315762865887315, -0.3291344064387964, 0.1265193422046716, 0.4787872505741223, -0.14613755535479894, -0.26570943449791184, -0.005485711613561428, 0.49740982236653974, -0.7456385848841535, 0.23704600300129444, 0.3151189427848705, -0.8387615933341264, -0.3854546723830116, -0.022971162158202607],
        [-0.14020032347982048, -0.4683963350040242, -0.05914086143651759, -0.11713500626369226, -0.5481583954724735, 0.4149081840406875, -0.4826214863595243, 0.22391503154961157, -0.09275195276145468, 0.1934587155705878, -0.6390135722335628, 0.36082151781342514, 0.7102948755837191, 0.6954746868245145, 0.2404309981725236, 0.12588166150775848, -0.21052278602763508, 0.044744177933926085, 0.5293182558732803, 0.004181320427426083, -0.06761409605410526, -0.21107664286819583, 0.05833511988247723, 0.0032020184528783885, -0.3345616807067034, 0.5524538826202322, -0.3721275561601629, -0.2637795025196129, -0.12107475788566177, 0.3432266282645529],
        [-0.7154165286229367, 0.31528103197398066, 0.01647640590023225, 0.39882899107397285, -0.14415437963892944, -0.2500593216791629, -0.16311945583262297, 0.5067356779768416, -0.1590560467883433, -0.18667036572780393, 0.12909690348449493, -0.5777050366627182, 0.38790818556587925, -0.03455420420866631, 0.2521998313698651, 0.2522275885761841, 0.25097650987815523, 0.21256365493018475, 0.4406863450775138, -0.07819611927891953, 0.07587133068400234, 0.2632134257544718, -0.6415440320038228, 0.05124995001626026, -0.1767414436297925, -0.24246914260979086, -0.338571847289742, 0.21483495449255388, -0.3229255888333219, -0.07199864307599385],
        [-0.39160242358042946, -0.16134530371710776, 0.46555336270706227, -0.3394623581586844, 0.5031305235512509, 0.7314391012509215, 0.1266883508642425, 0.44419263204459114, -0.2808593742641189, 0.5417972586231993, 0.1843965718350277, -0.35788259443761905, -0.8193905513057221, -0.10780914617362286, -0.39656004845784765, -0.27761678053703087, -0.09398645818794296, 0.43928559595807837, 0.20775315827831287, -0.6077885105664197, -0.5023029903313124, -0.1333465715662987, -0.47768154310538624, 0.17087315244251583, 0.45435187275830496, 0.510020353660775, 0.0949749764287343, 0.019739974727221665, -0.008828707869123292, 0.2232835385643469],
        [-0.6610737817430957, 0.21235972545049517, 0.30368026193672504, 0.20764504955380048, -0.13615718991195438, 0.03281183661376963, 0.4514937186351503, -0.054869371231186403, 0.21071412408577866, -0.09345912666162204, -0.1659068934720344, 0.41299528263039714, 0.45405139507149, 0.22801776609787025, -0.642380501557519, -0.319853912356299, 0.719252468933344, -0.3522194712129756, -0.565583771287912, 0.3341465443900812, 0.6068260177923867, -0.025589002436567265, -0.26337562864346536, 0.00690392328041875, 0.027780261823982532, 0.07485393534252438, 0.5057436307208727, -0.36674580232138426, -0.36471257533260526, 0.7928234991686849],
        [0.8065523814719902, -0.36943762380588585, -0.21311920492789346, 0.41778489674363434, 0.35019288619015626, -0.18998622317609343, -0.23301566911104613, 0.31711875996214256, 0.1370340917183983, -0.3749346254952983, -0.3373056707458486, -0.16046636870617761, -0.9643655176269585, 0.24705778517160132, 0.03645246961244829, 0.13329625551075858, -0.05149119011253189, -0.40643463965352095, -0.16682553579856557, 0.573086397804961, -0.03650358221526426, -0.16833618368872252, -0.3525798849882409, -0.5853101515028365, -0.3610762766963322, 0.25968848482361473, -0.37031314191744324, 0.3193025496915025, 0.027769492121745343, 0.15253502525765555],
        [0.6792405488658713, -0.1847238459840437, -0.10861991134489622, -0.07451629609744548, 0.6175402630727483, -0.6113744458428834, -0.21621742412280864, 0.08673952213390404, -0.14078090723005743, -0.007111751610328079, -0.01919782209027585, 0.06937788854645449, 0.3699711008032469, -0.481850510930375, -0.18977606138728748, -0.05232535633300299, 0.06177395554944698, 0.18012204824330977, -0.11491007222387056, 0.11009868194124217, 0.12117014396089262, -0.06295978132108862, -0.46989939575632095, -0.6982186412661279, -0.021149392450073034, -0.0035629159757058493, -0.29364472575765915, -0.7979812199908445, 0.27280828924008893, 0.006898655227301029],
        [-0.04316062688718403, 0.574420520356522, 0.37533524133818885, 0.15959679574442548, 0.14843422189720235, -0.43304577030751057, 0.325579640829939, -0.34368983825305516, -0.20653147477911787, 0.06368473049219464, 0.3804075259632366, -0.014595794565488557, 0.3850372654425368, 0.12731034254568774, -0.29045275181788877, -0.06237910945564258, -0.40428656430234206, 0.34902577104237026, 0.25702327316526513, 0.2594988367217502, -0.8364188970267952, -0.14109747191434935, 0.17775836804212827, -0.0500392460663695, -0.5124173168738126, 0.20853742504417522, -0.13983479709984473, 0.2170661192391326, -0.027320657589434444, 0.591969011112866],
        [0.5783213302832911, -0.1545603277394636, 0.42051821643793336, 0.10676674457110082, 0.3792453413707366, 0.4815177522812151, -0.1866608777464108, -0.3433656572428487, 0.06489966446424802, 0.40125367716201266, 0.4157713116814852, -0.28374383836537775, 0.3784348692469739, -0.13105506522915678, -0.2309261097981483, 0.2754540704209427, -0.3875060957299661, 0.009502706750420975, 0.27630216298925897, -0.48928819931944995, 0.26759686911936764, -0.4809468998639298, 0.34670144998754526, -0.25254702115250655, -0.15295804897116805, -0.5675911915936362, 0.7620147204347847, -0.45262292056251574, -0.5786079834494645, -0.06323848557037004],
        [-0.34283350701149484, -0.6730636348570841, 0.4040560678784033, -0.599052465082982, -0.7782280087706768, -0.13476955308265137, 0.5604033818496315, -0.20871972306828296, -0.06885428916336744, 0.13117770459667655, 0.25037270345265106, 0.2622538342689601, -0.1431350704326102, -0.2533509573406501, -0.440743862212319, 0.0382534413200026, 0.25271315612534456, 0.1705531546405306, 0.5798203435504045, 0.29874459826759076, -0.310298539084251, 0.2901520296222533, -0.5535259310794999, -0.3514414711167972, 0.3219512330377871, 0.2517175000672037, 0.6782092133186561, -0.22640629174595972, 0.2203653570108618, 0.48304043867717905],
        [0.5135248018314362, -0.006235840069804793, -0.04838540262927399, -0.6721917286548158, 0.34404985747693145, 0.23521675246662052, 0.07953622556706605, -0.06122689574769502, 0.7980864010179608, -0.22068286594611244, 0.3413333711714845, -0.1260520344820353, 0.4063762808634639, -0.12222110867497038, -0.5006738406258504, -0.32605974725293285, -0.4073742230890023, -0.9775655388978536, 0.13296528634549526, 0.192416656460478, 0.27953096426311635, 0.43124275149536223, 0.0314306666362861, 0.6300802493299325, -0.36366018754884005, -0.27314682030401294, -0.35866117345430376, -0.0623746894117953, 0.31657772278189067, 0.21376637178644892],
        [-0.10884321719699523, 0.07686025056311094, -0.10582938903651766, -0.1472760627542356, -0.08747458615172049, 0.12867576853006965, 0.7795987520136758, -0.2660343089151356, 0.7165441120793062, 0.34228742207933, -0.5618887260707238, -0.46996310211928066, 0.24891926708010514, 0.13467100131340617, 0.3969258970894423, 0.6293270433141338, -0.07754649559429216, 0.1442840208339526, -0.2270049675065653, 0.0739791203118698, 0.13682962377700583, 0.7243877652758502, 0.14778082865760023, -0.2698638862808016, 0.1307624490101824, -0.0626325286247561, -0.38964188857768534, -0.08605875870375215, 0.3324519244252263, 0.014277717116738808],
        [0.2895574369050755, 0.1094120367389521, -0.2334579666143783, 0.45859411071183576, -0.03340292195612482, -0.18611488545142055, 0.40158808985003736, 0.335288968332504, -0.3405867450606367, -0.08539935723314102, -0.13534035734723454, -0.6205314824194255, -0.4429401619786058, 0.3011139949815606, -0.5379569193754152, 0.30465525643110253, 0.14030993165994204, 0.36258694309133654, 0.2145373797261815, 0.07498498997621326, -0.4324530774688801, -0.3286489033067833, 0.5667164692446627, 0.1447636406413772, 0.5422185612527602, 0.4089258905299314, 0.40617750549030573, -0.7267811667808712, 0.3516694489491435, -0.30418104038503935],
        [0.20222180340125934, 0.2831776309749603, 0.060166348373850945, -0.5855255552561192, -0.03447793629134796, 0.32445088725002036, 0.1546497277615667, 0.324723999385197, -0.4562959708036036, -0.09816065239612798, 0.020915161109898647, -0.17459557476707283, 0.1394657999015317, 0.18384009162983622, 0.36973363809298176, -0.4381809208188648, -0.5703897438970137, 0.33352422835436446, -0.18797849165466013, 0.631859160342295, 0.3514560200448847, 0.3087307753663644, -0.2515569296419355, 0.03944009267676457, -0.41258704221456, 0.44633263448637195, 0.5732361908918623, 0.39444138036023885, -0.26512571654485284, -0.6018352066208573],
        [-0.5206829905051273, -0.23135859613942492, -0.24296092603616903, 0.5067548607658765, -0.10564890045897368, -0.24048658200075512, -0.7772497674708043, 0.44406441914299977, -0.25431847316375034, 0.14323570082190917, -0.356622688062133, -0.24078911517925972, 0.10355571659093331, -0.001453627978651284, -0.22707022532228102, 0.4682172800208123, -0.37166534546550756, 0.0759457827772767, -0.5096957244960226, 0.5755751510073313, -0.013887151280500318, 0.3251546398415122, 0.3213560243315437, 0.1385799433465439, 0.2375563487573703, -0.4303408021654781, -0.151821997432602, -0.25028100177204743, 0.1457395195025717, 0.776309709064163],
        [0.42836252552949206, -0.33718197585321724, 0.21548035377577868, -0.40507662797645944, 0.2014274832905996, -0.5433793884340921, 0.1224415250293831, 0.5393306791753718, 0.27416686032695486, 0.082632023074415, -0.7884658902824764, 0.352516410343092, -0.3215340918790108, 0.3063978302657008, -0.35842337232209986, 0.15918686812857288, -0.5066182271884826, 0.24318494071384883, -0.07990729625099985, -0.34223427859471983, 0.026389823884251817, -0.012190771423593136, -0.38440465561717074, 0.4422050016374801, 0.5004188286541862, -0.48797366693918576, -0.5257294178775168, 0.27044826965888685, 0.06374658128407093, -0.21055537254768195],
        [-0.07229172521248685, -0.012619021504288216, -0.10306990613044381, 0.5773822518003995, 0.06888051451486416, 0.43713082352039045, 0.5885415309525811, 0.15509576744315207, -0.0646716677963939, -0.4195382156489882, 0.0077740925641710396, 0.25114301460843375, 0.045871547106996174, -0.08119450771007011, 0.8255692518586322, -0.10746168444798904, -0.7233908867213177, -0.28733213848659256, -0.07042257148949574, -0.33736998430157605, -0.31615772012747434, 0.637471243102823, 0.3342620958158797, 0.10193483134353173, 0.22375768368727963, 0.25939635951333456, 0.2895429558698939, 0.0938692733504595, -0.35688342388508215, 0.33223137855053053],
        [-0.18699662934090575, -0.25626959260136895, 0.21645569641934304, -0.5729028966371135, -0.1757924340162676, -0.3096075782754243, 0.07831552044106763, 0.15162561197553526, -0.5420221467353463, -0.3045924843328466, 0.4368657815598125, -0.21463743674331837, -0.4578505782102571, -0.3066597950800175, 0.27053121874282693, 0.20836974921463403, 0.13800460199956427, 0.36587732428809083, 0.04237344159534795, 0.11961652698091832, 0.07333226939939147, 0.30418372479105804, 0.8086105436243229, -0.1881215194116193, 0.3288548599042146, 0.2429985863774975, -0.36775767269543636, -0.5799500101784082, -0.7581937239986651, -0.02363706621763853],
        [-0.18164178957187238, -0.3975578037882955, 0.9031749527859909, 0.06435313172171045, -0.18373217556008753, 0.12856849436939927, 0.03605582300233018, -0.22177090943159183, 0.46766398866629866, -0.45862241453424646, 0.6090704190704241, -0.16871814723754863, -0.05282949041805468, -0.23775525925864419, 0.1458537535172106, 0.3601499062837886, -0.3548351717298724, 0.11465124307727872, -0.7408734746734618, -0.17028472651884238, 0.016211503505893607, 0.08555954360280565, -0.19327077449197183, 0.3477159638225413, 0.1405951388246403, 0.6741091274493876, 0.18351925802796182, 0.28709379999081447, 0.09649713320812849, 0.1770619974289314],
        [-0.2959998782373478, -0.31893488942623544, 0.2884344740408862, 0.12777785918551032, -0.3298828917178556, -0.01296814707209483, -0.026207430454604275, -0.3195494668334498, -0.13831150022629682, -0.06202930628131616, 0.5038326313361795, 0.06812820721374047, -0.3883804678776764, 0.42117399995432425, 0.6719523175060682, -0.7829119058233104, -0.2545728223200528, 0.030432611272681168, 0.46105781013008984, 0.3455033529988476, 0.38043039410177476, 0.015592560744472711, -0.0782236623864884, 0.10723363542970979, -0.0785484717132918, -0.5242356949446266, -0.3076345938849563, -0.5447340695866476, 0.20827160167719058, -0.24714630791611464],
        [0.39091730874319836, -0.14301948453718222, -0.416573974498724, 0.21058636576321915, -0.042392695980575545, 0.9692299560410524, 0.18067532655955904, 0.07048923752150876, -0.25753083434238133, -0.02811434559196349, 0.4084048583145683, 0.25263554314386394, 0.24018893308181855, -0.45088121570201556, -0.37543681788595623, -0.21472728196743884, -0.20185399884279412, 0.6453208405376091, 0.25181311449736976, -0.34569454269251476, 0.376170751494547, -0.19323458373162783, -0.09873617008670921, -0.11693468261985994, -0.12211990315128496, -0.5205620314235212, -0.3819412010822847, -0.024201460578551548, -0.43322487076976357, 0.40659980395686357],
        [0.32490256897373954, 0.273641936177235, 0.6409145677667029, 0.010478884705160063, -0.13968486757812731, 0.36348706825807253, -0.47939360842532897, 0.5215045445963201, -0.08475159525065415, -0.38274255200218354, -0.24647385601789726, 0.09939948553816708, 0.24046412030140712, -0.05198426665156987, -0.050031793748498476, 0.01728344868408335, 0.6783139651058665, 0.22122649826282775, -0.15006430849891333, 0.4093345419333876, -0.3604899816439195, 0.527653545494235, 0.1341756137913044, 0.2921984039295986, -0.4290151283670982, -0.48997286041670407, 0.090580797885915, -0.14809464302004724, -0.007510073366799333, 0.21560238869439494],
        [0.20386338576133167, 0.49707514715466306, 0.3049937683144083, 0.5062407667254119, -0.9414667369063229, 0.013418269930532703, -0.5051597908533171, 0.3924810115481096, 0.19273242642462857, -0.2537293164221322, 0.48713589276149327, 0.4290184531975732, -0.6419506493670214, -0.2592152788761851, 0.0038551191121315442, -0.1300980835925416, -0.6166597563107101, -0.36683498615168486, -0.41225121218445687, 0.2231510516544806, 0.08715996651143887, -0.21546515642668754, -0.014515945995269355, -0.9197293583873759, -0.17423640730171053, 0.3751523690314758, 0.0875330631809718, -0.36273892066117197, -0.38622720112210185, -0.22233035439369653],
        [0.8140328127660865, 0.2446917807402485, 0.7860284456563504, 0.18734273423462533, 0.16666056758952214, 0.22948096689199932, -0.1792347287266782, -0.16358616668219433, -0.3989444091550533, 0.272957753954343, -0.08143602516667217, 0.049539361244016714, -0.02326210498902423, -0.1404812384357955, 0.11718385884214445, 0.112366644401973, -0.1595835299923443, -0.44416703842723465, 0.9084248633577152, 0.3743265373824697, 0.7640412871510154, 0.35743439721802656, 0.06527304586232732, 0.42585937544467023, 0.809885878410352, 0.4000640530709614, -0.26865180542075917, -0.17160132630425895, 0.5267642382760309, 0.02882298134604211],
        [0.339038897179861, 0.5061272784823421, 0.2722285063723555, -0.08024349582890891, 0.035515754410313086, 0.29566436303920507, -0.1984798774986795, -0.37025124191924835, -0.012655290497039076, -0.30838044519764707, -0.8855288593872315, -0.43679212531806566, -0.034416560576147615, -0.23338149640589623, 0.2532464780575538, -0.7065134108451461, -0.2794681789552189, -0.41001645838043077, -0.033598119177321834, 0.09514136754983767, -0.44522949863169964, -0.5680023381620815, -0.325754877478974, 0.43204808140388473, 0.13389718193679792, -0.22126061393205954, 0.044064658248676225, 0.06399776648419692, -0.0759510558039012, 0.29874829315486817],
    ])

    def __init__(self):
        rest_h = [self.CEC2017_C25_h1]
        rest_g = [self.CEC2017_C25_g1]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        M = self.select_matrix(D)
        z = generate_z_y(x, self.o[:D], 'matrix_multiply', M)
        f_x = np.sum(np.abs(z))
        return f_x
    
    @staticmethod
    def select_matrix(D):
        if D == 10:
            return CEC2017_C25.M10
        elif D == 30:
            return CEC2017_C25.M30
        else:
            raise ValueError("Dimensión no soportada")
    
    @staticmethod
    def CEC2017_C25_g1(x):
        M = CEC2017_C25.select_matrix(D)
        z = generate_z_y(x, CEC2017_C25.o[:D], 'matrix_multiply', M)
        return np.sum(z**2) - 100 * D
    
    @staticmethod
    def CEC2017_C25_h1(x):
        M = CEC2017_C25.select_matrix(D)
        z = generate_z_y(x, CEC2017_C25.o[:D], 'matrix_multiply', M)
        f_x = np.sum(np.abs(z))
        return (np.cos(f_x) + np.sin(f_x))**2 - np.exp(np.cos(f_x) + np.sin(f_x)) - 1 + np.exp(1)

class CEC2017_C26(Problem):
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)

    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    M10 = np.array([
        [-1.4750691585532323, -0.5745205005115123, -0.005699772438594958, 0.6648210730157429, -0.1041634598061256, -0.8978855297957111, -0.901994204541452, -0.6065324100090661, -0.4063251172471228, 0.15528244331830426],
        [0.5592150245095672, 0.04993662795408019, 0.4215715110001431, 0.8658026703900705, 0.6947904462259192, -0.18507116388982225, -0.022188704511750743, -0.649218872652057, 0.07356091714854926, -0.7961176305125455],
        [0.6352998982037079, 0.5943504059660697, 1.103253878964802, -1.1285189770235082, 0.7046494430751651, 0.2755757486743495, -1.0399669162892367, 0.11685698852943777, -0.32902335058747467, 0.07790036419589119],
        [-0.35941283248531275, 0.37082704554158386, -0.5271046483443762, -0.26665593788738984, -0.5141977194125844, 0.5821194001685648, -0.047299261268575435, -0.46312553098784154, -0.10196330326631606, -0.9522639457792393],
        [-0.5839720120889139, 1.7714876607340784, 0.013650083503154053, 0.3212225620402597, 0.7904281214026975, 0.4093923866971973, 0.33744753474799605, 0.5942128150118153, -0.15480530100758425, -0.5237685825508689],
        [-0.17838596502167076, 0.24992500534286521, -0.17316389205861768, -0.005036558084014708, -0.17668981043919074, 0.282386956005954, -1.0946510657454087, 0.45147932173029537, 1.0574055589046905, -0.0074876994077884285],
        [-0.5913243068007854, -0.27049755413083576, -0.3130389318979534, 0.6376303913429255, 1.2741644739500224, 0.7811212288227438, 0.1820711612625297, -0.05528506550771772, 0.27980292347560093, 0.055727088016825216],
        [-0.20277428932485703, 1.0079304172848664, 0.01437318812037941, 0.14803052734314798, 0.45096233182274637, -0.5822593030942272, 0.452115990237956, -0.8708036252941136, 0.4357530932226235, 0.3651693399025321],
        [-0.9026689569470502, 0.17486172336358063, -0.27450550855066735, -0.3661547399904748, 0.6032348252987877, -0.762354545526245, 0.9197863043444101, -0.06739961818174695, 0.5329960368512198, -0.9498570741645186],
        [0.3809013727921987, 0.8270471805962801, -0.9297598191669905, -0.5709424218088751, 1.0158877843868521, -0.39993664335293944, -0.7407173804723235, 0.40730997988162376, -0.3708088890828746, -0.193514070829618],
    ])
    M30 = np.array([
        [-0.5159828783208829, -0.461752601502956, -0.47478430536873406, 0.30906472546822983, 0.0821092546309288, 0.12399425682320928, -0.27213943183862804, -0.6066294974432846, 0.777839341246011, -0.05737011470108, -0.09789520372128557, 0.17520766757008754, 0.15816790642936068, 0.11980961854461003, -0.468153550081146, -0.3620869598650572, -0.4886255076540601, 0.23469980700329732, 0.6450256970330783, 0.49857302334610387, 0.06300037478185166, 0.5766729714557522, 0.0934670738279128, -0.0882071137775379, 0.8805338407901566, 0.37503612382206475, 0.48038544171877795, 0.6074904320527752, -0.06333768975160145, -0.44730035615863784],
        [0.1880754930560265, -0.2720272048289167, 0.1869512122668153, 0.0438983891578362, -0.23549495408004903, -0.6163739419294972, 0.060500463921530634, 0.2676085722425896, 0.5259478346689614, 0.7720494183015834, 0.21960696988918912, 0.15824113495025177, 0.2970151280048526, -0.20379644304513045, 0.641572164969781, -0.418148640182776, 0.22926624189809053, 0.0612419752999645, 0.06791073974691907, -0.032319295885730404, 0.26292640093486397, -0.6480198792924795, 0.2810103744453979, 0.14392792999580045, -0.004528918141343957, -0.005930953273363987, 0.13708107902261224, 0.4968959791866978, -0.10313184784018095, -0.0894528902124122],
        [0.08677860222719772, -0.13415840828119555, 0.5277280418242739, 0.7478122408419924, -0.3125793907217645, 0.38174655051775797, 0.019187525091114474, -0.02240431729236165, -0.5672989058308923, 0.5492354632829972, 0.03655749312790477, -0.39925649810781727, 0.3782977840936688, -0.2512456032672451, -0.3288950029473213, 0.046264440515645315, -0.17471382325041543, -0.650841654577202, -0.26557166002512683, 0.1268686931172478, -0.7752632273386695, 0.3580039025191851, -0.12818030147444026, 0.32101908684569186, 0.15687161215857892, 0.13220017059437858, -0.49611842100609715, -0.16172585090258718, -0.21068271845999856, 0.06731164664251577],
        [-0.0725281242535927, 0.03923363692533671, -0.08451736708855691, 0.911569016239978, 0.27124084181504265, 0.10678488576778121, 0.35154106042529, -0.10959240726719924, -0.3567424184683352, -0.05139206973406582, -0.6458723265904243, -0.17894980229733576, -0.07928189820709317, -0.5534977733755848, -0.3566608623377477, -0.8775717680937246, 0.1069956028157045, -0.2962152465741139, 0.28338354399572724, -0.5383563973668849, 0.2703419660432148, -0.16167942534080176, 0.5163599860818278, -0.5075463963316947, -0.42222755988115773, -0.1523082265251643, 0.3179043033149148, 0.15263148427625017, 0.3186760724944154, -0.007851425697908351],
        [-0.31085059906248025, 0.10773533790008274, 0.21073657512338226, -0.10389714926279825, 0.5006811426159044, 0.6623146979279007, 0.18396874003818742, 0.4617016641762331, -0.5207289159776659, -0.459362028051465, 0.2248991081068287, 0.5680604512423484, 0.3580388165911977, -0.5972146208123865, -0.10433733437648485, -0.014334357116532304, 0.2136845387221096, 0.02439187568807852, 0.23838451766550403, 0.8003915687344867, 0.17872570272597937, -0.5990516448807318, 0.07468653669771103, -0.11529657547119215, -0.08040488050924052, -0.15763218727718675, 0.045919794915371376, 0.3255337153852049, 0.031667282607729774, -0.3317721297284485],
        [0.2882048920773465, -0.14256137622938297, -0.019521164467690172, 0.07084318546010558, -0.09866229014877709, -0.05483664131209329, 0.24968096019471414, -0.6727823205366663, 0.4586423492380458, 0.3840739208227191, 0.10221117432596505, 0.6214137152153121, -0.35242425225098173, -0.5147009154991066, -0.2432463255125819, 0.41179287638035006, -0.315762865887315, -0.3291344064387964, 0.1265193422046716, 0.4787872505741223, -0.14613755535479894, -0.26570943449791184, -0.005485711613561428, 0.49740982236653974, -0.7456385848841535, 0.23704600300129444, 0.3151189427848705, -0.8387615933341264, -0.3854546723830116, -0.022971162158202607],
        [-0.14020032347982048, -0.4683963350040242, -0.05914086143651759, -0.11713500626369226, -0.5481583954724735, 0.4149081840406875, -0.4826214863595243, 0.22391503154961157, -0.09275195276145468, 0.1934587155705878, -0.6390135722335628, 0.36082151781342514, 0.7102948755837191, 0.6954746868245145, 0.2404309981725236, 0.12588166150775848, -0.21052278602763508, 0.044744177933926085, 0.5293182558732803, 0.004181320427426083, -0.06761409605410526, -0.21107664286819583, 0.05833511988247723, 0.0032020184528783885, -0.3345616807067034, 0.5524538826202322, -0.3721275561601629, -0.2637795025196129, -0.12107475788566177, 0.3432266282645529],
        [-0.7154165286229367, 0.31528103197398066, 0.01647640590023225, 0.39882899107397285, -0.14415437963892944, -0.2500593216791629, -0.16311945583262297, 0.5067356779768416, -0.1590560467883433, -0.18667036572780393, 0.12909690348449493, -0.5777050366627182, 0.38790818556587925, -0.03455420420866631, 0.2521998313698651, 0.2522275885761841, 0.25097650987815523, 0.21256365493018475, 0.4406863450775138, -0.07819611927891953, 0.07587133068400234, 0.2632134257544718, -0.6415440320038228, 0.05124995001626026, -0.1767414436297925, -0.24246914260979086, -0.338571847289742, 0.21483495449255388, -0.3229255888333219, -0.07199864307599385],
        [-0.39160242358042946, -0.16134530371710776, 0.46555336270706227, -0.3394623581586844, 0.5031305235512509, 0.7314391012509215, 0.1266883508642425, 0.44419263204459114, -0.2808593742641189, 0.5417972586231993, 0.1843965718350277, -0.35788259443761905, -0.8193905513057221, -0.10780914617362286, -0.39656004845784765, -0.27761678053703087, -0.09398645818794296, 0.43928559595807837, 0.20775315827831287, -0.6077885105664197, -0.5023029903313124, -0.1333465715662987, -0.47768154310538624, 0.17087315244251583, 0.45435187275830496, 0.510020353660775, 0.0949749764287343, 0.019739974727221665, -0.008828707869123292, 0.2232835385643469],
        [-0.6610737817430957, 0.21235972545049517, 0.30368026193672504, 0.20764504955380048, -0.13615718991195438, 0.03281183661376963, 0.4514937186351503, -0.054869371231186403, 0.21071412408577866, -0.09345912666162204, -0.1659068934720344, 0.41299528263039714, 0.45405139507149, 0.22801776609787025, -0.642380501557519, -0.319853912356299, 0.719252468933344, -0.3522194712129756, -0.565583771287912, 0.3341465443900812, 0.6068260177923867, -0.025589002436567265, -0.26337562864346536, 0.00690392328041875, 0.027780261823982532, 0.07485393534252438, 0.5057436307208727, -0.36674580232138426, -0.36471257533260526, 0.7928234991686849],
        [0.8065523814719902, -0.36943762380588585, -0.21311920492789346, 0.41778489674363434, 0.35019288619015626, -0.18998622317609343, -0.23301566911104613, 0.31711875996214256, 0.1370340917183983, -0.3749346254952983, -0.3373056707458486, -0.16046636870617761, -0.9643655176269585, 0.24705778517160132, 0.03645246961244829, 0.13329625551075858, -0.05149119011253189, -0.40643463965352095, -0.16682553579856557, 0.573086397804961, -0.03650358221526426, -0.16833618368872252, -0.3525798849882409, -0.5853101515028365, -0.3610762766963322, 0.25968848482361473, -0.37031314191744324, 0.3193025496915025, 0.027769492121745343, 0.15253502525765555],
        [0.6792405488658713, -0.1847238459840437, -0.10861991134489622, -0.07451629609744548, 0.6175402630727483, -0.6113744458428834, -0.21621742412280864, 0.08673952213390404, -0.14078090723005743, -0.007111751610328079, -0.01919782209027585, 0.06937788854645449, 0.3699711008032469, -0.481850510930375, -0.18977606138728748, -0.05232535633300299, 0.06177395554944698, 0.18012204824330977, -0.11491007222387056, 0.11009868194124217, 0.12117014396089262, -0.06295978132108862, -0.46989939575632095, -0.6982186412661279, -0.021149392450073034, -0.0035629159757058493, -0.29364472575765915, -0.7979812199908445, 0.27280828924008893, 0.006898655227301029],
        [-0.04316062688718403, 0.574420520356522, 0.37533524133818885, 0.15959679574442548, 0.14843422189720235, -0.43304577030751057, 0.325579640829939, -0.34368983825305516, -0.20653147477911787, 0.06368473049219464, 0.3804075259632366, -0.014595794565488557, 0.3850372654425368, 0.12731034254568774, -0.29045275181788877, -0.06237910945564258, -0.40428656430234206, 0.34902577104237026, 0.25702327316526513, 0.2594988367217502, -0.8364188970267952, -0.14109747191434935, 0.17775836804212827, -0.0500392460663695, -0.5124173168738126, 0.20853742504417522, -0.13983479709984473, 0.2170661192391326, -0.027320657589434444, 0.591969011112866],
        [0.5783213302832911, -0.1545603277394636, 0.42051821643793336, 0.10676674457110082, 0.3792453413707366, 0.4815177522812151, -0.1866608777464108, -0.3433656572428487, 0.06489966446424802, 0.40125367716201266, 0.4157713116814852, -0.28374383836537775, 0.3784348692469739, -0.13105506522915678, -0.2309261097981483, 0.2754540704209427, -0.3875060957299661, 0.009502706750420975, 0.27630216298925897, -0.48928819931944995, 0.26759686911936764, -0.4809468998639298, 0.34670144998754526, -0.25254702115250655, -0.15295804897116805, -0.5675911915936362, 0.7620147204347847, -0.45262292056251574, -0.5786079834494645, -0.06323848557037004],
        [-0.34283350701149484, -0.6730636348570841, 0.4040560678784033, -0.599052465082982, -0.7782280087706768, -0.13476955308265137, 0.5604033818496315, -0.20871972306828296, -0.06885428916336744, 0.13117770459667655, 0.25037270345265106, 0.2622538342689601, -0.1431350704326102, -0.2533509573406501, -0.440743862212319, 0.0382534413200026, 0.25271315612534456, 0.1705531546405306, 0.5798203435504045, 0.29874459826759076, -0.310298539084251, 0.2901520296222533, -0.5535259310794999, -0.3514414711167972, 0.3219512330377871, 0.2517175000672037, 0.6782092133186561, -0.22640629174595972, 0.2203653570108618, 0.48304043867717905],
        [0.5135248018314362, -0.006235840069804793, -0.04838540262927399, -0.6721917286548158, 0.34404985747693145, 0.23521675246662052, 0.07953622556706605, -0.06122689574769502, 0.7980864010179608, -0.22068286594611244, 0.3413333711714845, -0.1260520344820353, 0.4063762808634639, -0.12222110867497038, -0.5006738406258504, -0.32605974725293285, -0.4073742230890023, -0.9775655388978536, 0.13296528634549526, 0.192416656460478, 0.27953096426311635, 0.43124275149536223, 0.0314306666362861, 0.6300802493299325, -0.36366018754884005, -0.27314682030401294, -0.35866117345430376, -0.0623746894117953, 0.31657772278189067, 0.21376637178644892],
        [-0.10884321719699523, 0.07686025056311094, -0.10582938903651766, -0.1472760627542356, -0.08747458615172049, 0.12867576853006965, 0.7795987520136758, -0.2660343089151356, 0.7165441120793062, 0.34228742207933, -0.5618887260707238, -0.46996310211928066, 0.24891926708010514, 0.13467100131340617, 0.3969258970894423, 0.6293270433141338, -0.07754649559429216, 0.1442840208339526, -0.2270049675065653, 0.0739791203118698, 0.13682962377700583, 0.7243877652758502, 0.14778082865760023, -0.2698638862808016, 0.1307624490101824, -0.0626325286247561, -0.38964188857768534, -0.08605875870375215, 0.3324519244252263, 0.014277717116738808],
        [0.2895574369050755, 0.1094120367389521, -0.2334579666143783, 0.45859411071183576, -0.03340292195612482, -0.18611488545142055, 0.40158808985003736, 0.335288968332504, -0.3405867450606367, -0.08539935723314102, -0.13534035734723454, -0.6205314824194255, -0.4429401619786058, 0.3011139949815606, -0.5379569193754152, 0.30465525643110253, 0.14030993165994204, 0.36258694309133654, 0.2145373797261815, 0.07498498997621326, -0.4324530774688801, -0.3286489033067833, 0.5667164692446627, 0.1447636406413772, 0.5422185612527602, 0.4089258905299314, 0.40617750549030573, -0.7267811667808712, 0.3516694489491435, -0.30418104038503935],
        [0.20222180340125934, 0.2831776309749603, 0.060166348373850945, -0.5855255552561192, -0.03447793629134796, 0.32445088725002036, 0.1546497277615667, 0.324723999385197, -0.4562959708036036, -0.09816065239612798, 0.020915161109898647, -0.17459557476707283, 0.1394657999015317, 0.18384009162983622, 0.36973363809298176, -0.4381809208188648, -0.5703897438970137, 0.33352422835436446, -0.18797849165466013, 0.631859160342295, 0.3514560200448847, 0.3087307753663644, -0.2515569296419355, 0.03944009267676457, -0.41258704221456, 0.44633263448637195, 0.5732361908918623, 0.39444138036023885, -0.26512571654485284, -0.6018352066208573],
        [-0.5206829905051273, -0.23135859613942492, -0.24296092603616903, 0.5067548607658765, -0.10564890045897368, -0.24048658200075512, -0.7772497674708043, 0.44406441914299977, -0.25431847316375034, 0.14323570082190917, -0.356622688062133, -0.24078911517925972, 0.10355571659093331, -0.001453627978651284, -0.22707022532228102, 0.4682172800208123, -0.37166534546550756, 0.0759457827772767, -0.5096957244960226, 0.5755751510073313, -0.013887151280500318, 0.3251546398415122, 0.3213560243315437, 0.1385799433465439, 0.2375563487573703, -0.4303408021654781, -0.151821997432602, -0.25028100177204743, 0.1457395195025717, 0.776309709064163],
        [0.42836252552949206, -0.33718197585321724, 0.21548035377577868, -0.40507662797645944, 0.2014274832905996, -0.5433793884340921, 0.1224415250293831, 0.5393306791753718, 0.27416686032695486, 0.082632023074415, -0.7884658902824764, 0.352516410343092, -0.3215340918790108, 0.3063978302657008, -0.35842337232209986, 0.15918686812857288, -0.5066182271884826, 0.24318494071384883, -0.07990729625099985, -0.34223427859471983, 0.026389823884251817, -0.012190771423593136, -0.38440465561717074, 0.4422050016374801, 0.5004188286541862, -0.48797366693918576, -0.5257294178775168, 0.27044826965888685, 0.06374658128407093, -0.21055537254768195],
        [-0.07229172521248685, -0.012619021504288216, -0.10306990613044381, 0.5773822518003995, 0.06888051451486416, 0.43713082352039045, 0.5885415309525811, 0.15509576744315207, -0.0646716677963939, -0.4195382156489882, 0.0077740925641710396, 0.25114301460843375, 0.045871547106996174, -0.08119450771007011, 0.8255692518586322, -0.10746168444798904, -0.7233908867213177, -0.28733213848659256, -0.07042257148949574, -0.33736998430157605, -0.31615772012747434, 0.637471243102823, 0.3342620958158797, 0.10193483134353173, 0.22375768368727963, 0.25939635951333456, 0.2895429558698939, 0.0938692733504595, -0.35688342388508215, 0.33223137855053053],
        [-0.18699662934090575, -0.25626959260136895, 0.21645569641934304, -0.5729028966371135, -0.1757924340162676, -0.3096075782754243, 0.07831552044106763, 0.15162561197553526, -0.5420221467353463, -0.3045924843328466, 0.4368657815598125, -0.21463743674331837, -0.4578505782102571, -0.3066597950800175, 0.27053121874282693, 0.20836974921463403, 0.13800460199956427, 0.36587732428809083, 0.04237344159534795, 0.11961652698091832, 0.07333226939939147, 0.30418372479105804, 0.8086105436243229, -0.1881215194116193, 0.3288548599042146, 0.2429985863774975, -0.36775767269543636, -0.5799500101784082, -0.7581937239986651, -0.02363706621763853],
        [-0.18164178957187238, -0.3975578037882955, 0.9031749527859909, 0.06435313172171045, -0.18373217556008753, 0.12856849436939927, 0.03605582300233018, -0.22177090943159183, 0.46766398866629866, -0.45862241453424646, 0.6090704190704241, -0.16871814723754863, -0.05282949041805468, -0.23775525925864419, 0.1458537535172106, 0.3601499062837886, -0.3548351717298724, 0.11465124307727872, -0.7408734746734618, -0.17028472651884238, 0.016211503505893607, 0.08555954360280565, -0.19327077449197183, 0.3477159638225413, 0.1405951388246403, 0.6741091274493876, 0.18351925802796182, 0.28709379999081447, 0.09649713320812849, 0.1770619974289314],
        [-0.2959998782373478, -0.31893488942623544, 0.2884344740408862, 0.12777785918551032, -0.3298828917178556, -0.01296814707209483, -0.026207430454604275, -0.3195494668334498, -0.13831150022629682, -0.06202930628131616, 0.5038326313361795, 0.06812820721374047, -0.3883804678776764, 0.42117399995432425, 0.6719523175060682, -0.7829119058233104, -0.2545728223200528, 0.030432611272681168, 0.46105781013008984, 0.3455033529988476, 0.38043039410177476, 0.015592560744472711, -0.0782236623864884, 0.10723363542970979, -0.0785484717132918, -0.5242356949446266, -0.3076345938849563, -0.5447340695866476, 0.20827160167719058, -0.24714630791611464],
        [0.39091730874319836, -0.14301948453718222, -0.416573974498724, 0.21058636576321915, -0.042392695980575545, 0.9692299560410524, 0.18067532655955904, 0.07048923752150876, -0.25753083434238133, -0.02811434559196349, 0.4084048583145683, 0.25263554314386394, 0.24018893308181855, -0.45088121570201556, -0.37543681788595623, -0.21472728196743884, -0.20185399884279412, 0.6453208405376091, 0.25181311449736976, -0.34569454269251476, 0.376170751494547, -0.19323458373162783, -0.09873617008670921, -0.11693468261985994, -0.12211990315128496, -0.5205620314235212, -0.3819412010822847, -0.024201460578551548, -0.43322487076976357, 0.40659980395686357],
        [0.32490256897373954, 0.273641936177235, 0.6409145677667029, 0.010478884705160063, -0.13968486757812731, 0.36348706825807253, -0.47939360842532897, 0.5215045445963201, -0.08475159525065415, -0.38274255200218354, -0.24647385601789726, 0.09939948553816708, 0.24046412030140712, -0.05198426665156987, -0.050031793748498476, 0.01728344868408335, 0.6783139651058665, 0.22122649826282775, -0.15006430849891333, 0.4093345419333876, -0.3604899816439195, 0.527653545494235, 0.1341756137913044, 0.2921984039295986, -0.4290151283670982, -0.48997286041670407, 0.090580797885915, -0.14809464302004724, -0.007510073366799333, 0.21560238869439494],
        [0.20386338576133167, 0.49707514715466306, 0.3049937683144083, 0.5062407667254119, -0.9414667369063229, 0.013418269930532703, -0.5051597908533171, 0.3924810115481096, 0.19273242642462857, -0.2537293164221322, 0.48713589276149327, 0.4290184531975732, -0.6419506493670214, -0.2592152788761851, 0.0038551191121315442, -0.1300980835925416, -0.6166597563107101, -0.36683498615168486, -0.41225121218445687, 0.2231510516544806, 0.08715996651143887, -0.21546515642668754, -0.014515945995269355, -0.9197293583873759, -0.17423640730171053, 0.3751523690314758, 0.0875330631809718, -0.36273892066117197, -0.38622720112210185, -0.22233035439369653],
        [0.8140328127660865, 0.2446917807402485, 0.7860284456563504, 0.18734273423462533, 0.16666056758952214, 0.22948096689199932, -0.1792347287266782, -0.16358616668219433, -0.3989444091550533, 0.272957753954343, -0.08143602516667217, 0.049539361244016714, -0.02326210498902423, -0.1404812384357955, 0.11718385884214445, 0.112366644401973, -0.1595835299923443, -0.44416703842723465, 0.9084248633577152, 0.3743265373824697, 0.7640412871510154, 0.35743439721802656, 0.06527304586232732, 0.42585937544467023, 0.809885878410352, 0.4000640530709614, -0.26865180542075917, -0.17160132630425895, 0.5267642382760309, 0.02882298134604211],
        [0.339038897179861, 0.5061272784823421, 0.2722285063723555, -0.08024349582890891, 0.035515754410313086, 0.29566436303920507, -0.1984798774986795, -0.37025124191924835, -0.012655290497039076, -0.30838044519764707, -0.8855288593872315, -0.43679212531806566, -0.034416560576147615, -0.23338149640589623, 0.2532464780575538, -0.7065134108451461, -0.2794681789552189, -0.41001645838043077, -0.033598119177321834, 0.09514136754983767, -0.44522949863169964, -0.5680023381620815, -0.325754877478974, 0.43204808140388473, 0.13389718193679792, -0.22126061393205954, 0.044064658248676225, 0.06399776648419692, -0.0759510558039012, 0.29874829315486817],
    ])

    
    def __init__(self):
        rest_h = [self.CEC2017_C26_h1]
        rest_g = [self.CEC2017_C26_g1]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        M = self.select_matrix(D)
        z = generate_z_y(x, self.o[:D], 'matrix_multiply', M)
        term1 = np.sum(z**2) / 4000
        term2 = 1 - np.prod(np.cos(z / np.sqrt(np.arange(1, D + 1))))
        f_x = term1 - term2 + 1
        return f_x

    @staticmethod
    def select_matrix(D):
        if D == 10:
            return CEC2017_C26.M10
        elif D == 30:
            return CEC2017_C26.M30
        else:
            raise ValueError("Dimensión no soportada")
    
    @staticmethod
    def CEC2017_C26_g1(x):
        M = CEC2017_C26.select_matrix(D)
        z = generate_z_y(x, CEC2017_C26.o[:D], 'matrix_multiply', M)
        data_sum = np.sum(z**2)
        g = -np.sum(np.sign(np.abs(z) - (data_sum - z**2) - 1))
        return g + 1

    @staticmethod
    def CEC2017_C26_h1(x):
        M = CEC2017_C26.select_matrix(D)
        z = generate_z_y(x, CEC2017_C26.o[:D], 'matrix_multiply', M)
        return np.sum(z**2) - 4 * D

class CEC2017_C27(Problem):
    SUPERIOR = np.array([100] * D)
    INFERIOR = np.array([-100] * D)
    
    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    M10 = np.array([
        [-1.4750691585532323, -0.5745205005115123, -0.005699772438594958, 0.6648210730157429, -0.1041634598061256, -0.8978855297957111, -0.901994204541452, -0.6065324100090661, -0.4063251172471228, 0.15528244331830426],
        [0.5592150245095672, 0.04993662795408019, 0.4215715110001431, 0.8658026703900705, 0.6947904462259192, -0.18507116388982225, -0.022188704511750743, -0.649218872652057, 0.07356091714854926, -0.7961176305125455],
        [0.6352998982037079, 0.5943504059660697, 1.103253878964802, -1.1285189770235082, 0.7046494430751651, 0.2755757486743495, -1.0399669162892367, 0.11685698852943777, -0.32902335058747467, 0.07790036419589119],
        [-0.35941283248531275, 0.37082704554158386, -0.5271046483443762, -0.26665593788738984, -0.5141977194125844, 0.5821194001685648, -0.047299261268575435, -0.46312553098784154, -0.10196330326631606, -0.9522639457792393],
        [-0.5839720120889139, 1.7714876607340784, 0.013650083503154053, 0.3212225620402597, 0.7904281214026975, 0.4093923866971973, 0.33744753474799605, 0.5942128150118153, -0.15480530100758425, -0.5237685825508689],
        [-0.17838596502167076, 0.24992500534286521, -0.17316389205861768, -0.005036558084014708, -0.17668981043919074, 0.282386956005954, -1.0946510657454087, 0.45147932173029537, 1.0574055589046905, -0.0074876994077884285],
        [-0.5913243068007854, -0.27049755413083576, -0.3130389318979534, 0.6376303913429255, 1.2741644739500224, 0.7811212288227438, 0.1820711612625297, -0.05528506550771772, 0.27980292347560093, 0.055727088016825216],
        [-0.20277428932485703, 1.0079304172848664, 0.01437318812037941, 0.14803052734314798, 0.45096233182274637, -0.5822593030942272, 0.452115990237956, -0.8708036252941136, 0.4357530932226235, 0.3651693399025321],
        [-0.9026689569470502, 0.17486172336358063, -0.27450550855066735, -0.3661547399904748, 0.6032348252987877, -0.762354545526245, 0.9197863043444101, -0.06739961818174695, 0.5329960368512198, -0.9498570741645186],
        [0.3809013727921987, 0.8270471805962801, -0.9297598191669905, -0.5709424218088751, 1.0158877843868521, -0.39993664335293944, -0.7407173804723235, 0.40730997988162376, -0.3708088890828746, -0.193514070829618],
    ])
    M30 = np.array([
        [-0.5159828783208829, -0.461752601502956, -0.47478430536873406, 0.30906472546822983, 0.0821092546309288, 0.12399425682320928, -0.27213943183862804, -0.6066294974432846, 0.777839341246011, -0.05737011470108, -0.09789520372128557, 0.17520766757008754, 0.15816790642936068, 0.11980961854461003, -0.468153550081146, -0.3620869598650572, -0.4886255076540601, 0.23469980700329732, 0.6450256970330783, 0.49857302334610387, 0.06300037478185166, 0.5766729714557522, 0.0934670738279128, -0.0882071137775379, 0.8805338407901566, 0.37503612382206475, 0.48038544171877795, 0.6074904320527752, -0.06333768975160145, -0.44730035615863784],
        [0.1880754930560265, -0.2720272048289167, 0.1869512122668153, 0.0438983891578362, -0.23549495408004903, -0.6163739419294972, 0.060500463921530634, 0.2676085722425896, 0.5259478346689614, 0.7720494183015834, 0.21960696988918912, 0.15824113495025177, 0.2970151280048526, -0.20379644304513045, 0.641572164969781, -0.418148640182776, 0.22926624189809053, 0.0612419752999645, 0.06791073974691907, -0.032319295885730404, 0.26292640093486397, -0.6480198792924795, 0.2810103744453979, 0.14392792999580045, -0.004528918141343957, -0.005930953273363987, 0.13708107902261224, 0.4968959791866978, -0.10313184784018095, -0.0894528902124122],
        [0.08677860222719772, -0.13415840828119555, 0.5277280418242739, 0.7478122408419924, -0.3125793907217645, 0.38174655051775797, 0.019187525091114474, -0.02240431729236165, -0.5672989058308923, 0.5492354632829972, 0.03655749312790477, -0.39925649810781727, 0.3782977840936688, -0.2512456032672451, -0.3288950029473213, 0.046264440515645315, -0.17471382325041543, -0.650841654577202, -0.26557166002512683, 0.1268686931172478, -0.7752632273386695, 0.3580039025191851, -0.12818030147444026, 0.32101908684569186, 0.15687161215857892, 0.13220017059437858, -0.49611842100609715, -0.16172585090258718, -0.21068271845999856, 0.06731164664251577],
        [-0.0725281242535927, 0.03923363692533671, -0.08451736708855691, 0.911569016239978, 0.27124084181504265, 0.10678488576778121, 0.35154106042529, -0.10959240726719924, -0.3567424184683352, -0.05139206973406582, -0.6458723265904243, -0.17894980229733576, -0.07928189820709317, -0.5534977733755848, -0.3566608623377477, -0.8775717680937246, 0.1069956028157045, -0.2962152465741139, 0.28338354399572724, -0.5383563973668849, 0.2703419660432148, -0.16167942534080176, 0.5163599860818278, -0.5075463963316947, -0.42222755988115773, -0.1523082265251643, 0.3179043033149148, 0.15263148427625017, 0.3186760724944154, -0.007851425697908351],
        [-0.31085059906248025, 0.10773533790008274, 0.21073657512338226, -0.10389714926279825, 0.5006811426159044, 0.6623146979279007, 0.18396874003818742, 0.4617016641762331, -0.5207289159776659, -0.459362028051465, 0.2248991081068287, 0.5680604512423484, 0.3580388165911977, -0.5972146208123865, -0.10433733437648485, -0.014334357116532304, 0.2136845387221096, 0.02439187568807852, 0.23838451766550403, 0.8003915687344867, 0.17872570272597937, -0.5990516448807318, 0.07468653669771103, -0.11529657547119215, -0.08040488050924052, -0.15763218727718675, 0.045919794915371376, 0.3255337153852049, 0.031667282607729774, -0.3317721297284485],
        [0.2882048920773465, -0.14256137622938297, -0.019521164467690172, 0.07084318546010558, -0.09866229014877709, -0.05483664131209329, 0.24968096019471414, -0.6727823205366663, 0.4586423492380458, 0.3840739208227191, 0.10221117432596505, 0.6214137152153121, -0.35242425225098173, -0.5147009154991066, -0.2432463255125819, 0.41179287638035006, -0.315762865887315, -0.3291344064387964, 0.1265193422046716, 0.4787872505741223, -0.14613755535479894, -0.26570943449791184, -0.005485711613561428, 0.49740982236653974, -0.7456385848841535, 0.23704600300129444, 0.3151189427848705, -0.8387615933341264, -0.3854546723830116, -0.022971162158202607],
        [-0.14020032347982048, -0.4683963350040242, -0.05914086143651759, -0.11713500626369226, -0.5481583954724735, 0.4149081840406875, -0.4826214863595243, 0.22391503154961157, -0.09275195276145468, 0.1934587155705878, -0.6390135722335628, 0.36082151781342514, 0.7102948755837191, 0.6954746868245145, 0.2404309981725236, 0.12588166150775848, -0.21052278602763508, 0.044744177933926085, 0.5293182558732803, 0.004181320427426083, -0.06761409605410526, -0.21107664286819583, 0.05833511988247723, 0.0032020184528783885, -0.3345616807067034, 0.5524538826202322, -0.3721275561601629, -0.2637795025196129, -0.12107475788566177, 0.3432266282645529],
        [-0.7154165286229367, 0.31528103197398066, 0.01647640590023225, 0.39882899107397285, -0.14415437963892944, -0.2500593216791629, -0.16311945583262297, 0.5067356779768416, -0.1590560467883433, -0.18667036572780393, 0.12909690348449493, -0.5777050366627182, 0.38790818556587925, -0.03455420420866631, 0.2521998313698651, 0.2522275885761841, 0.25097650987815523, 0.21256365493018475, 0.4406863450775138, -0.07819611927891953, 0.07587133068400234, 0.2632134257544718, -0.6415440320038228, 0.05124995001626026, -0.1767414436297925, -0.24246914260979086, -0.338571847289742, 0.21483495449255388, -0.3229255888333219, -0.07199864307599385],
        [-0.39160242358042946, -0.16134530371710776, 0.46555336270706227, -0.3394623581586844, 0.5031305235512509, 0.7314391012509215, 0.1266883508642425, 0.44419263204459114, -0.2808593742641189, 0.5417972586231993, 0.1843965718350277, -0.35788259443761905, -0.8193905513057221, -0.10780914617362286, -0.39656004845784765, -0.27761678053703087, -0.09398645818794296, 0.43928559595807837, 0.20775315827831287, -0.6077885105664197, -0.5023029903313124, -0.1333465715662987, -0.47768154310538624, 0.17087315244251583, 0.45435187275830496, 0.510020353660775, 0.0949749764287343, 0.019739974727221665, -0.008828707869123292, 0.2232835385643469],
        [-0.6610737817430957, 0.21235972545049517, 0.30368026193672504, 0.20764504955380048, -0.13615718991195438, 0.03281183661376963, 0.4514937186351503, -0.054869371231186403, 0.21071412408577866, -0.09345912666162204, -0.1659068934720344, 0.41299528263039714, 0.45405139507149, 0.22801776609787025, -0.642380501557519, -0.319853912356299, 0.719252468933344, -0.3522194712129756, -0.565583771287912, 0.3341465443900812, 0.6068260177923867, -0.025589002436567265, -0.26337562864346536, 0.00690392328041875, 0.027780261823982532, 0.07485393534252438, 0.5057436307208727, -0.36674580232138426, -0.36471257533260526, 0.7928234991686849],
        [0.8065523814719902, -0.36943762380588585, -0.21311920492789346, 0.41778489674363434, 0.35019288619015626, -0.18998622317609343, -0.23301566911104613, 0.31711875996214256, 0.1370340917183983, -0.3749346254952983, -0.3373056707458486, -0.16046636870617761, -0.9643655176269585, 0.24705778517160132, 0.03645246961244829, 0.13329625551075858, -0.05149119011253189, -0.40643463965352095, -0.16682553579856557, 0.573086397804961, -0.03650358221526426, -0.16833618368872252, -0.3525798849882409, -0.5853101515028365, -0.3610762766963322, 0.25968848482361473, -0.37031314191744324, 0.3193025496915025, 0.027769492121745343, 0.15253502525765555],
        [0.6792405488658713, -0.1847238459840437, -0.10861991134489622, -0.07451629609744548, 0.6175402630727483, -0.6113744458428834, -0.21621742412280864, 0.08673952213390404, -0.14078090723005743, -0.007111751610328079, -0.01919782209027585, 0.06937788854645449, 0.3699711008032469, -0.481850510930375, -0.18977606138728748, -0.05232535633300299, 0.06177395554944698, 0.18012204824330977, -0.11491007222387056, 0.11009868194124217, 0.12117014396089262, -0.06295978132108862, -0.46989939575632095, -0.6982186412661279, -0.021149392450073034, -0.0035629159757058493, -0.29364472575765915, -0.7979812199908445, 0.27280828924008893, 0.006898655227301029],
        [-0.04316062688718403, 0.574420520356522, 0.37533524133818885, 0.15959679574442548, 0.14843422189720235, -0.43304577030751057, 0.325579640829939, -0.34368983825305516, -0.20653147477911787, 0.06368473049219464, 0.3804075259632366, -0.014595794565488557, 0.3850372654425368, 0.12731034254568774, -0.29045275181788877, -0.06237910945564258, -0.40428656430234206, 0.34902577104237026, 0.25702327316526513, 0.2594988367217502, -0.8364188970267952, -0.14109747191434935, 0.17775836804212827, -0.0500392460663695, -0.5124173168738126, 0.20853742504417522, -0.13983479709984473, 0.2170661192391326, -0.027320657589434444, 0.591969011112866],
        [0.5783213302832911, -0.1545603277394636, 0.42051821643793336, 0.10676674457110082, 0.3792453413707366, 0.4815177522812151, -0.1866608777464108, -0.3433656572428487, 0.06489966446424802, 0.40125367716201266, 0.4157713116814852, -0.28374383836537775, 0.3784348692469739, -0.13105506522915678, -0.2309261097981483, 0.2754540704209427, -0.3875060957299661, 0.009502706750420975, 0.27630216298925897, -0.48928819931944995, 0.26759686911936764, -0.4809468998639298, 0.34670144998754526, -0.25254702115250655, -0.15295804897116805, -0.5675911915936362, 0.7620147204347847, -0.45262292056251574, -0.5786079834494645, -0.06323848557037004],
        [-0.34283350701149484, -0.6730636348570841, 0.4040560678784033, -0.599052465082982, -0.7782280087706768, -0.13476955308265137, 0.5604033818496315, -0.20871972306828296, -0.06885428916336744, 0.13117770459667655, 0.25037270345265106, 0.2622538342689601, -0.1431350704326102, -0.2533509573406501, -0.440743862212319, 0.0382534413200026, 0.25271315612534456, 0.1705531546405306, 0.5798203435504045, 0.29874459826759076, -0.310298539084251, 0.2901520296222533, -0.5535259310794999, -0.3514414711167972, 0.3219512330377871, 0.2517175000672037, 0.6782092133186561, -0.22640629174595972, 0.2203653570108618, 0.48304043867717905],
        [0.5135248018314362, -0.006235840069804793, -0.04838540262927399, -0.6721917286548158, 0.34404985747693145, 0.23521675246662052, 0.07953622556706605, -0.06122689574769502, 0.7980864010179608, -0.22068286594611244, 0.3413333711714845, -0.1260520344820353, 0.4063762808634639, -0.12222110867497038, -0.5006738406258504, -0.32605974725293285, -0.4073742230890023, -0.9775655388978536, 0.13296528634549526, 0.192416656460478, 0.27953096426311635, 0.43124275149536223, 0.0314306666362861, 0.6300802493299325, -0.36366018754884005, -0.27314682030401294, -0.35866117345430376, -0.0623746894117953, 0.31657772278189067, 0.21376637178644892],
        [-0.10884321719699523, 0.07686025056311094, -0.10582938903651766, -0.1472760627542356, -0.08747458615172049, 0.12867576853006965, 0.7795987520136758, -0.2660343089151356, 0.7165441120793062, 0.34228742207933, -0.5618887260707238, -0.46996310211928066, 0.24891926708010514, 0.13467100131340617, 0.3969258970894423, 0.6293270433141338, -0.07754649559429216, 0.1442840208339526, -0.2270049675065653, 0.0739791203118698, 0.13682962377700583, 0.7243877652758502, 0.14778082865760023, -0.2698638862808016, 0.1307624490101824, -0.0626325286247561, -0.38964188857768534, -0.08605875870375215, 0.3324519244252263, 0.014277717116738808],
        [0.2895574369050755, 0.1094120367389521, -0.2334579666143783, 0.45859411071183576, -0.03340292195612482, -0.18611488545142055, 0.40158808985003736, 0.335288968332504, -0.3405867450606367, -0.08539935723314102, -0.13534035734723454, -0.6205314824194255, -0.4429401619786058, 0.3011139949815606, -0.5379569193754152, 0.30465525643110253, 0.14030993165994204, 0.36258694309133654, 0.2145373797261815, 0.07498498997621326, -0.4324530774688801, -0.3286489033067833, 0.5667164692446627, 0.1447636406413772, 0.5422185612527602, 0.4089258905299314, 0.40617750549030573, -0.7267811667808712, 0.3516694489491435, -0.30418104038503935],
        [0.20222180340125934, 0.2831776309749603, 0.060166348373850945, -0.5855255552561192, -0.03447793629134796, 0.32445088725002036, 0.1546497277615667, 0.324723999385197, -0.4562959708036036, -0.09816065239612798, 0.020915161109898647, -0.17459557476707283, 0.1394657999015317, 0.18384009162983622, 0.36973363809298176, -0.4381809208188648, -0.5703897438970137, 0.33352422835436446, -0.18797849165466013, 0.631859160342295, 0.3514560200448847, 0.3087307753663644, -0.2515569296419355, 0.03944009267676457, -0.41258704221456, 0.44633263448637195, 0.5732361908918623, 0.39444138036023885, -0.26512571654485284, -0.6018352066208573],
        [-0.5206829905051273, -0.23135859613942492, -0.24296092603616903, 0.5067548607658765, -0.10564890045897368, -0.24048658200075512, -0.7772497674708043, 0.44406441914299977, -0.25431847316375034, 0.14323570082190917, -0.356622688062133, -0.24078911517925972, 0.10355571659093331, -0.001453627978651284, -0.22707022532228102, 0.4682172800208123, -0.37166534546550756, 0.0759457827772767, -0.5096957244960226, 0.5755751510073313, -0.013887151280500318, 0.3251546398415122, 0.3213560243315437, 0.1385799433465439, 0.2375563487573703, -0.4303408021654781, -0.151821997432602, -0.25028100177204743, 0.1457395195025717, 0.776309709064163],
        [0.42836252552949206, -0.33718197585321724, 0.21548035377577868, -0.40507662797645944, 0.2014274832905996, -0.5433793884340921, 0.1224415250293831, 0.5393306791753718, 0.27416686032695486, 0.082632023074415, -0.7884658902824764, 0.352516410343092, -0.3215340918790108, 0.3063978302657008, -0.35842337232209986, 0.15918686812857288, -0.5066182271884826, 0.24318494071384883, -0.07990729625099985, -0.34223427859471983, 0.026389823884251817, -0.012190771423593136, -0.38440465561717074, 0.4422050016374801, 0.5004188286541862, -0.48797366693918576, -0.5257294178775168, 0.27044826965888685, 0.06374658128407093, -0.21055537254768195],
        [-0.07229172521248685, -0.012619021504288216, -0.10306990613044381, 0.5773822518003995, 0.06888051451486416, 0.43713082352039045, 0.5885415309525811, 0.15509576744315207, -0.0646716677963939, -0.4195382156489882, 0.0077740925641710396, 0.25114301460843375, 0.045871547106996174, -0.08119450771007011, 0.8255692518586322, -0.10746168444798904, -0.7233908867213177, -0.28733213848659256, -0.07042257148949574, -0.33736998430157605, -0.31615772012747434, 0.637471243102823, 0.3342620958158797, 0.10193483134353173, 0.22375768368727963, 0.25939635951333456, 0.2895429558698939, 0.0938692733504595, -0.35688342388508215, 0.33223137855053053],
        [-0.18699662934090575, -0.25626959260136895, 0.21645569641934304, -0.5729028966371135, -0.1757924340162676, -0.3096075782754243, 0.07831552044106763, 0.15162561197553526, -0.5420221467353463, -0.3045924843328466, 0.4368657815598125, -0.21463743674331837, -0.4578505782102571, -0.3066597950800175, 0.27053121874282693, 0.20836974921463403, 0.13800460199956427, 0.36587732428809083, 0.04237344159534795, 0.11961652698091832, 0.07333226939939147, 0.30418372479105804, 0.8086105436243229, -0.1881215194116193, 0.3288548599042146, 0.2429985863774975, -0.36775767269543636, -0.5799500101784082, -0.7581937239986651, -0.02363706621763853],
        [-0.18164178957187238, -0.3975578037882955, 0.9031749527859909, 0.06435313172171045, -0.18373217556008753, 0.12856849436939927, 0.03605582300233018, -0.22177090943159183, 0.46766398866629866, -0.45862241453424646, 0.6090704190704241, -0.16871814723754863, -0.05282949041805468, -0.23775525925864419, 0.1458537535172106, 0.3601499062837886, -0.3548351717298724, 0.11465124307727872, -0.7408734746734618, -0.17028472651884238, 0.016211503505893607, 0.08555954360280565, -0.19327077449197183, 0.3477159638225413, 0.1405951388246403, 0.6741091274493876, 0.18351925802796182, 0.28709379999081447, 0.09649713320812849, 0.1770619974289314],
        [-0.2959998782373478, -0.31893488942623544, 0.2884344740408862, 0.12777785918551032, -0.3298828917178556, -0.01296814707209483, -0.026207430454604275, -0.3195494668334498, -0.13831150022629682, -0.06202930628131616, 0.5038326313361795, 0.06812820721374047, -0.3883804678776764, 0.42117399995432425, 0.6719523175060682, -0.7829119058233104, -0.2545728223200528, 0.030432611272681168, 0.46105781013008984, 0.3455033529988476, 0.38043039410177476, 0.015592560744472711, -0.0782236623864884, 0.10723363542970979, -0.0785484717132918, -0.5242356949446266, -0.3076345938849563, -0.5447340695866476, 0.20827160167719058, -0.24714630791611464],
        [0.39091730874319836, -0.14301948453718222, -0.416573974498724, 0.21058636576321915, -0.042392695980575545, 0.9692299560410524, 0.18067532655955904, 0.07048923752150876, -0.25753083434238133, -0.02811434559196349, 0.4084048583145683, 0.25263554314386394, 0.24018893308181855, -0.45088121570201556, -0.37543681788595623, -0.21472728196743884, -0.20185399884279412, 0.6453208405376091, 0.25181311449736976, -0.34569454269251476, 0.376170751494547, -0.19323458373162783, -0.09873617008670921, -0.11693468261985994, -0.12211990315128496, -0.5205620314235212, -0.3819412010822847, -0.024201460578551548, -0.43322487076976357, 0.40659980395686357],
        [0.32490256897373954, 0.273641936177235, 0.6409145677667029, 0.010478884705160063, -0.13968486757812731, 0.36348706825807253, -0.47939360842532897, 0.5215045445963201, -0.08475159525065415, -0.38274255200218354, -0.24647385601789726, 0.09939948553816708, 0.24046412030140712, -0.05198426665156987, -0.050031793748498476, 0.01728344868408335, 0.6783139651058665, 0.22122649826282775, -0.15006430849891333, 0.4093345419333876, -0.3604899816439195, 0.527653545494235, 0.1341756137913044, 0.2921984039295986, -0.4290151283670982, -0.48997286041670407, 0.090580797885915, -0.14809464302004724, -0.007510073366799333, 0.21560238869439494],
        [0.20386338576133167, 0.49707514715466306, 0.3049937683144083, 0.5062407667254119, -0.9414667369063229, 0.013418269930532703, -0.5051597908533171, 0.3924810115481096, 0.19273242642462857, -0.2537293164221322, 0.48713589276149327, 0.4290184531975732, -0.6419506493670214, -0.2592152788761851, 0.0038551191121315442, -0.1300980835925416, -0.6166597563107101, -0.36683498615168486, -0.41225121218445687, 0.2231510516544806, 0.08715996651143887, -0.21546515642668754, -0.014515945995269355, -0.9197293583873759, -0.17423640730171053, 0.3751523690314758, 0.0875330631809718, -0.36273892066117197, -0.38622720112210185, -0.22233035439369653],
        [0.8140328127660865, 0.2446917807402485, 0.7860284456563504, 0.18734273423462533, 0.16666056758952214, 0.22948096689199932, -0.1792347287266782, -0.16358616668219433, -0.3989444091550533, 0.272957753954343, -0.08143602516667217, 0.049539361244016714, -0.02326210498902423, -0.1404812384357955, 0.11718385884214445, 0.112366644401973, -0.1595835299923443, -0.44416703842723465, 0.9084248633577152, 0.3743265373824697, 0.7640412871510154, 0.35743439721802656, 0.06527304586232732, 0.42585937544467023, 0.809885878410352, 0.4000640530709614, -0.26865180542075917, -0.17160132630425895, 0.5267642382760309, 0.02882298134604211],
        [0.339038897179861, 0.5061272784823421, 0.2722285063723555, -0.08024349582890891, 0.035515754410313086, 0.29566436303920507, -0.1984798774986795, -0.37025124191924835, -0.012655290497039076, -0.30838044519764707, -0.8855288593872315, -0.43679212531806566, -0.034416560576147615, -0.23338149640589623, 0.2532464780575538, -0.7065134108451461, -0.2794681789552189, -0.41001645838043077, -0.033598119177321834, 0.09514136754983767, -0.44522949863169964, -0.5680023381620815, -0.325754877478974, 0.43204808140388473, 0.13389718193679792, -0.22126061393205954, 0.044064658248676225, 0.06399776648419692, -0.0759510558039012, 0.29874829315486817],
    ])


    def __init__(self):
        rest_h = [self.CEC2017_C27_h1]
        rest_g = [self.CEC2017_C27_g1, self.CEC2017_C27_g2]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        M = self.select_matrix(D)
        z = generate_z_y(x, self.o[:D], 'matrix_multiply', M)
        z = np.where(np.abs(z) < 0.5, z, 0.5 * np.round(2 * z))
        f_x = np.sum(z**2 - 10 * np.cos(2 * np.pi * z) + 10)
        return f_x
    
    @staticmethod
    def select_matrix(D):
        if D == 10:
            return CEC2017_C27.M10
        elif D == 30:
            return CEC2017_C27.M30
        else:
            raise ValueError("Dimensión no soportada")
    
    @staticmethod
    def CEC2017_C27_g1(x):
        M = CEC2017_C27.select_matrix(D)
        z = generate_z_y(x, CEC2017_C27.o[:D], 'matrix_multiply', M)
        return 1 - np.sum(np.abs(z))
    
    @staticmethod
    def CEC2017_C27_g2(x):
        M = CEC2017_C27.select_matrix(D)
        z = generate_z_y(x, CEC2017_C27.o[:D], 'matrix_multiply', M)
        return np.sum(z**2) - 100 * D
    
    @staticmethod
    def CEC2017_C27_h1(x):
        M = CEC2017_C27.select_matrix(D)
        z = generate_z_y(x, CEC2017_C27.o[:D], 'matrix_multiply', M)
        sum1 = np.sum(100 * (z[:-1]**2 - z[1:]**2))
        multi = np.prod(np.sin((z - 1) * np.pi)**2)
        return sum1 + multi

class CEC2017_C28(Problem):
    SUPERIOR = np.array([50] * D)
    INFERIOR = np.array([-50] * D)

    o = np.array([
        -28.572876762843592,     -16.020692917610326,     -34.26735013531116,     -45.81811210019825,     -18.079781146775243,
        25.725679048043332,     24.71656391468659,     11.215719489129484,     -12.136617112504744,     -0.9155066608648426,
        23.405309685666367,     -31.46470652849852,     -9.06629948907689,     5.735014631024718,     15.684166985022358,
        -21.58247350619379,     -43.37023138836762,     3.353632175083135,     31.145333372275815,     -29.903950910062715,
        25.432689218671413,     -18.67392971714501,     19.749230950200896,     -24.427524021542226,     30.311237701994003,
        7.076420612654921,     -12.416416702879438,     31.724833079820385,     -35.954704233854685,     -34.30051214977381,
        -5.9501902906060025,     41.63390336826525,     17.880178744710136,     3.6479735089184686,     10.70598804447733,
        34.17760167012331,     23.693053658446743,     24.64509163313538,     34.380647111988964,     -36.11374658788622,
        28.479536099789854,     -2.8437285416851736,     28.299856687594684,     21.01032318515989,     1.8454631264885109,
        15.163578553120118,     -5.468721733268467,     39.686700656645954,     11.713552353181925,     -49.411074064536145,
        20.73509620007701,     48.02637624118276,     -42.79755115251193,     -26.78821569678397,     26.485761855232326,
        30.412375264745478,     37.74266451808542,     -46.26394065126072,     -18.39456148465146,     -22.6840915345336,
        37.51905241902762,     7.85553615152498,     19.2681228044723,     -42.0256108559632,     48.96307472528622,
        24.612810952743516,     40.58018495772593,     44.023668523295484,     -45.31879981068779,     -12.550216143748003,
        13.795953243048906,     -2.560425301742562,     -40.837884746803496,     -3.0298821975606955,     25.90618078359762,
        -29.640447098043065,     -20.3656094067829,     -10.325012084775423,     45.27341821167336,     -9.8401862971605,
        -11.111510188972318,     -18.23645637792799,     -48.790684200485124,     -32.30855108017815,     49.06478956075986,
        -9.465411990247873,     -17.02629695297359,     48.4447469425739,     -44.03309804392174,     -7.477364041826121,
        13.3178878551537,     46.97544920209245,     23.824664552440993,     27.203921579109263,     26.77428516659927,
        14.661678487900176,     4.063552233376214,     -3.1061167265637906,     -21.226342098590976,     49.80461843217766,
    ])
    M10 = np.array([
        [-1.4750691585532323, -0.5745205005115123, -0.005699772438594958, 0.6648210730157429, -0.1041634598061256, -0.8978855297957111, -0.901994204541452, -0.6065324100090661, -0.4063251172471228, 0.15528244331830426],
        [0.5592150245095672, 0.04993662795408019, 0.4215715110001431, 0.8658026703900705, 0.6947904462259192, -0.18507116388982225, -0.022188704511750743, -0.649218872652057, 0.07356091714854926, -0.7961176305125455],
        [0.6352998982037079, 0.5943504059660697, 1.103253878964802, -1.1285189770235082, 0.7046494430751651, 0.2755757486743495, -1.0399669162892367, 0.11685698852943777, -0.32902335058747467, 0.07790036419589119],
        [-0.35941283248531275, 0.37082704554158386, -0.5271046483443762, -0.26665593788738984, -0.5141977194125844, 0.5821194001685648, -0.047299261268575435, -0.46312553098784154, -0.10196330326631606, -0.9522639457792393],
        [-0.5839720120889139, 1.7714876607340784, 0.013650083503154053, 0.3212225620402597, 0.7904281214026975, 0.4093923866971973, 0.33744753474799605, 0.5942128150118153, -0.15480530100758425, -0.5237685825508689],
        [-0.17838596502167076, 0.24992500534286521, -0.17316389205861768, -0.005036558084014708, -0.17668981043919074, 0.282386956005954, -1.0946510657454087, 0.45147932173029537, 1.0574055589046905, -0.0074876994077884285],
        [-0.5913243068007854, -0.27049755413083576, -0.3130389318979534, 0.6376303913429255, 1.2741644739500224, 0.7811212288227438, 0.1820711612625297, -0.05528506550771772, 0.27980292347560093, 0.055727088016825216],
        [-0.20277428932485703, 1.0079304172848664, 0.01437318812037941, 0.14803052734314798, 0.45096233182274637, -0.5822593030942272, 0.452115990237956, -0.8708036252941136, 0.4357530932226235, 0.3651693399025321],
        [-0.9026689569470502, 0.17486172336358063, -0.27450550855066735, -0.3661547399904748, 0.6032348252987877, -0.762354545526245, 0.9197863043444101, -0.06739961818174695, 0.5329960368512198, -0.9498570741645186],
        [0.3809013727921987, 0.8270471805962801, -0.9297598191669905, -0.5709424218088751, 1.0158877843868521, -0.39993664335293944, -0.7407173804723235, 0.40730997988162376, -0.3708088890828746, -0.193514070829618],
    ])
    M30 = np.array([
        [-0.5159828783208829, -0.461752601502956, -0.47478430536873406, 0.30906472546822983, 0.0821092546309288, 0.12399425682320928, -0.27213943183862804, -0.6066294974432846, 0.777839341246011, -0.05737011470108, -0.09789520372128557, 0.17520766757008754, 0.15816790642936068, 0.11980961854461003, -0.468153550081146, -0.3620869598650572, -0.4886255076540601, 0.23469980700329732, 0.6450256970330783, 0.49857302334610387, 0.06300037478185166, 0.5766729714557522, 0.0934670738279128, -0.0882071137775379, 0.8805338407901566, 0.37503612382206475, 0.48038544171877795, 0.6074904320527752, -0.06333768975160145, -0.44730035615863784],
        [0.1880754930560265, -0.2720272048289167, 0.1869512122668153, 0.0438983891578362, -0.23549495408004903, -0.6163739419294972, 0.060500463921530634, 0.2676085722425896, 0.5259478346689614, 0.7720494183015834, 0.21960696988918912, 0.15824113495025177, 0.2970151280048526, -0.20379644304513045, 0.641572164969781, -0.418148640182776, 0.22926624189809053, 0.0612419752999645, 0.06791073974691907, -0.032319295885730404, 0.26292640093486397, -0.6480198792924795, 0.2810103744453979, 0.14392792999580045, -0.004528918141343957, -0.005930953273363987, 0.13708107902261224, 0.4968959791866978, -0.10313184784018095, -0.0894528902124122],
        [0.08677860222719772, -0.13415840828119555, 0.5277280418242739, 0.7478122408419924, -0.3125793907217645, 0.38174655051775797, 0.019187525091114474, -0.02240431729236165, -0.5672989058308923, 0.5492354632829972, 0.03655749312790477, -0.39925649810781727, 0.3782977840936688, -0.2512456032672451, -0.3288950029473213, 0.046264440515645315, -0.17471382325041543, -0.650841654577202, -0.26557166002512683, 0.1268686931172478, -0.7752632273386695, 0.3580039025191851, -0.12818030147444026, 0.32101908684569186, 0.15687161215857892, 0.13220017059437858, -0.49611842100609715, -0.16172585090258718, -0.21068271845999856, 0.06731164664251577],
        [-0.0725281242535927, 0.03923363692533671, -0.08451736708855691, 0.911569016239978, 0.27124084181504265, 0.10678488576778121, 0.35154106042529, -0.10959240726719924, -0.3567424184683352, -0.05139206973406582, -0.6458723265904243, -0.17894980229733576, -0.07928189820709317, -0.5534977733755848, -0.3566608623377477, -0.8775717680937246, 0.1069956028157045, -0.2962152465741139, 0.28338354399572724, -0.5383563973668849, 0.2703419660432148, -0.16167942534080176, 0.5163599860818278, -0.5075463963316947, -0.42222755988115773, -0.1523082265251643, 0.3179043033149148, 0.15263148427625017, 0.3186760724944154, -0.007851425697908351],
        [-0.31085059906248025, 0.10773533790008274, 0.21073657512338226, -0.10389714926279825, 0.5006811426159044, 0.6623146979279007, 0.18396874003818742, 0.4617016641762331, -0.5207289159776659, -0.459362028051465, 0.2248991081068287, 0.5680604512423484, 0.3580388165911977, -0.5972146208123865, -0.10433733437648485, -0.014334357116532304, 0.2136845387221096, 0.02439187568807852, 0.23838451766550403, 0.8003915687344867, 0.17872570272597937, -0.5990516448807318, 0.07468653669771103, -0.11529657547119215, -0.08040488050924052, -0.15763218727718675, 0.045919794915371376, 0.3255337153852049, 0.031667282607729774, -0.3317721297284485],
        [0.2882048920773465, -0.14256137622938297, -0.019521164467690172, 0.07084318546010558, -0.09866229014877709, -0.05483664131209329, 0.24968096019471414, -0.6727823205366663, 0.4586423492380458, 0.3840739208227191, 0.10221117432596505, 0.6214137152153121, -0.35242425225098173, -0.5147009154991066, -0.2432463255125819, 0.41179287638035006, -0.315762865887315, -0.3291344064387964, 0.1265193422046716, 0.4787872505741223, -0.14613755535479894, -0.26570943449791184, -0.005485711613561428, 0.49740982236653974, -0.7456385848841535, 0.23704600300129444, 0.3151189427848705, -0.8387615933341264, -0.3854546723830116, -0.022971162158202607],
        [-0.14020032347982048, -0.4683963350040242, -0.05914086143651759, -0.11713500626369226, -0.5481583954724735, 0.4149081840406875, -0.4826214863595243, 0.22391503154961157, -0.09275195276145468, 0.1934587155705878, -0.6390135722335628, 0.36082151781342514, 0.7102948755837191, 0.6954746868245145, 0.2404309981725236, 0.12588166150775848, -0.21052278602763508, 0.044744177933926085, 0.5293182558732803, 0.004181320427426083, -0.06761409605410526, -0.21107664286819583, 0.05833511988247723, 0.0032020184528783885, -0.3345616807067034, 0.5524538826202322, -0.3721275561601629, -0.2637795025196129, -0.12107475788566177, 0.3432266282645529],
        [-0.7154165286229367, 0.31528103197398066, 0.01647640590023225, 0.39882899107397285, -0.14415437963892944, -0.2500593216791629, -0.16311945583262297, 0.5067356779768416, -0.1590560467883433, -0.18667036572780393, 0.12909690348449493, -0.5777050366627182, 0.38790818556587925, -0.03455420420866631, 0.2521998313698651, 0.2522275885761841, 0.25097650987815523, 0.21256365493018475, 0.4406863450775138, -0.07819611927891953, 0.07587133068400234, 0.2632134257544718, -0.6415440320038228, 0.05124995001626026, -0.1767414436297925, -0.24246914260979086, -0.338571847289742, 0.21483495449255388, -0.3229255888333219, -0.07199864307599385],
        [-0.39160242358042946, -0.16134530371710776, 0.46555336270706227, -0.3394623581586844, 0.5031305235512509, 0.7314391012509215, 0.1266883508642425, 0.44419263204459114, -0.2808593742641189, 0.5417972586231993, 0.1843965718350277, -0.35788259443761905, -0.8193905513057221, -0.10780914617362286, -0.39656004845784765, -0.27761678053703087, -0.09398645818794296, 0.43928559595807837, 0.20775315827831287, -0.6077885105664197, -0.5023029903313124, -0.1333465715662987, -0.47768154310538624, 0.17087315244251583, 0.45435187275830496, 0.510020353660775, 0.0949749764287343, 0.019739974727221665, -0.008828707869123292, 0.2232835385643469],
        [-0.6610737817430957, 0.21235972545049517, 0.30368026193672504, 0.20764504955380048, -0.13615718991195438, 0.03281183661376963, 0.4514937186351503, -0.054869371231186403, 0.21071412408577866, -0.09345912666162204, -0.1659068934720344, 0.41299528263039714, 0.45405139507149, 0.22801776609787025, -0.642380501557519, -0.319853912356299, 0.719252468933344, -0.3522194712129756, -0.565583771287912, 0.3341465443900812, 0.6068260177923867, -0.025589002436567265, -0.26337562864346536, 0.00690392328041875, 0.027780261823982532, 0.07485393534252438, 0.5057436307208727, -0.36674580232138426, -0.36471257533260526, 0.7928234991686849],
        [0.8065523814719902, -0.36943762380588585, -0.21311920492789346, 0.41778489674363434, 0.35019288619015626, -0.18998622317609343, -0.23301566911104613, 0.31711875996214256, 0.1370340917183983, -0.3749346254952983, -0.3373056707458486, -0.16046636870617761, -0.9643655176269585, 0.24705778517160132, 0.03645246961244829, 0.13329625551075858, -0.05149119011253189, -0.40643463965352095, -0.16682553579856557, 0.573086397804961, -0.03650358221526426, -0.16833618368872252, -0.3525798849882409, -0.5853101515028365, -0.3610762766963322, 0.25968848482361473, -0.37031314191744324, 0.3193025496915025, 0.027769492121745343, 0.15253502525765555],
        [0.6792405488658713, -0.1847238459840437, -0.10861991134489622, -0.07451629609744548, 0.6175402630727483, -0.6113744458428834, -0.21621742412280864, 0.08673952213390404, -0.14078090723005743, -0.007111751610328079, -0.01919782209027585, 0.06937788854645449, 0.3699711008032469, -0.481850510930375, -0.18977606138728748, -0.05232535633300299, 0.06177395554944698, 0.18012204824330977, -0.11491007222387056, 0.11009868194124217, 0.12117014396089262, -0.06295978132108862, -0.46989939575632095, -0.6982186412661279, -0.021149392450073034, -0.0035629159757058493, -0.29364472575765915, -0.7979812199908445, 0.27280828924008893, 0.006898655227301029],
        [-0.04316062688718403, 0.574420520356522, 0.37533524133818885, 0.15959679574442548, 0.14843422189720235, -0.43304577030751057, 0.325579640829939, -0.34368983825305516, -0.20653147477911787, 0.06368473049219464, 0.3804075259632366, -0.014595794565488557, 0.3850372654425368, 0.12731034254568774, -0.29045275181788877, -0.06237910945564258, -0.40428656430234206, 0.34902577104237026, 0.25702327316526513, 0.2594988367217502, -0.8364188970267952, -0.14109747191434935, 0.17775836804212827, -0.0500392460663695, -0.5124173168738126, 0.20853742504417522, -0.13983479709984473, 0.2170661192391326, -0.027320657589434444, 0.591969011112866],
        [0.5783213302832911, -0.1545603277394636, 0.42051821643793336, 0.10676674457110082, 0.3792453413707366, 0.4815177522812151, -0.1866608777464108, -0.3433656572428487, 0.06489966446424802, 0.40125367716201266, 0.4157713116814852, -0.28374383836537775, 0.3784348692469739, -0.13105506522915678, -0.2309261097981483, 0.2754540704209427, -0.3875060957299661, 0.009502706750420975, 0.27630216298925897, -0.48928819931944995, 0.26759686911936764, -0.4809468998639298, 0.34670144998754526, -0.25254702115250655, -0.15295804897116805, -0.5675911915936362, 0.7620147204347847, -0.45262292056251574, -0.5786079834494645, -0.06323848557037004],
        [-0.34283350701149484, -0.6730636348570841, 0.4040560678784033, -0.599052465082982, -0.7782280087706768, -0.13476955308265137, 0.5604033818496315, -0.20871972306828296, -0.06885428916336744, 0.13117770459667655, 0.25037270345265106, 0.2622538342689601, -0.1431350704326102, -0.2533509573406501, -0.440743862212319, 0.0382534413200026, 0.25271315612534456, 0.1705531546405306, 0.5798203435504045, 0.29874459826759076, -0.310298539084251, 0.2901520296222533, -0.5535259310794999, -0.3514414711167972, 0.3219512330377871, 0.2517175000672037, 0.6782092133186561, -0.22640629174595972, 0.2203653570108618, 0.48304043867717905],
        [0.5135248018314362, -0.006235840069804793, -0.04838540262927399, -0.6721917286548158, 0.34404985747693145, 0.23521675246662052, 0.07953622556706605, -0.06122689574769502, 0.7980864010179608, -0.22068286594611244, 0.3413333711714845, -0.1260520344820353, 0.4063762808634639, -0.12222110867497038, -0.5006738406258504, -0.32605974725293285, -0.4073742230890023, -0.9775655388978536, 0.13296528634549526, 0.192416656460478, 0.27953096426311635, 0.43124275149536223, 0.0314306666362861, 0.6300802493299325, -0.36366018754884005, -0.27314682030401294, -0.35866117345430376, -0.0623746894117953, 0.31657772278189067, 0.21376637178644892],
        [-0.10884321719699523, 0.07686025056311094, -0.10582938903651766, -0.1472760627542356, -0.08747458615172049, 0.12867576853006965, 0.7795987520136758, -0.2660343089151356, 0.7165441120793062, 0.34228742207933, -0.5618887260707238, -0.46996310211928066, 0.24891926708010514, 0.13467100131340617, 0.3969258970894423, 0.6293270433141338, -0.07754649559429216, 0.1442840208339526, -0.2270049675065653, 0.0739791203118698, 0.13682962377700583, 0.7243877652758502, 0.14778082865760023, -0.2698638862808016, 0.1307624490101824, -0.0626325286247561, -0.38964188857768534, -0.08605875870375215, 0.3324519244252263, 0.014277717116738808],
        [0.2895574369050755, 0.1094120367389521, -0.2334579666143783, 0.45859411071183576, -0.03340292195612482, -0.18611488545142055, 0.40158808985003736, 0.335288968332504, -0.3405867450606367, -0.08539935723314102, -0.13534035734723454, -0.6205314824194255, -0.4429401619786058, 0.3011139949815606, -0.5379569193754152, 0.30465525643110253, 0.14030993165994204, 0.36258694309133654, 0.2145373797261815, 0.07498498997621326, -0.4324530774688801, -0.3286489033067833, 0.5667164692446627, 0.1447636406413772, 0.5422185612527602, 0.4089258905299314, 0.40617750549030573, -0.7267811667808712, 0.3516694489491435, -0.30418104038503935],
        [0.20222180340125934, 0.2831776309749603, 0.060166348373850945, -0.5855255552561192, -0.03447793629134796, 0.32445088725002036, 0.1546497277615667, 0.324723999385197, -0.4562959708036036, -0.09816065239612798, 0.020915161109898647, -0.17459557476707283, 0.1394657999015317, 0.18384009162983622, 0.36973363809298176, -0.4381809208188648, -0.5703897438970137, 0.33352422835436446, -0.18797849165466013, 0.631859160342295, 0.3514560200448847, 0.3087307753663644, -0.2515569296419355, 0.03944009267676457, -0.41258704221456, 0.44633263448637195, 0.5732361908918623, 0.39444138036023885, -0.26512571654485284, -0.6018352066208573],
        [-0.5206829905051273, -0.23135859613942492, -0.24296092603616903, 0.5067548607658765, -0.10564890045897368, -0.24048658200075512, -0.7772497674708043, 0.44406441914299977, -0.25431847316375034, 0.14323570082190917, -0.356622688062133, -0.24078911517925972, 0.10355571659093331, -0.001453627978651284, -0.22707022532228102, 0.4682172800208123, -0.37166534546550756, 0.0759457827772767, -0.5096957244960226, 0.5755751510073313, -0.013887151280500318, 0.3251546398415122, 0.3213560243315437, 0.1385799433465439, 0.2375563487573703, -0.4303408021654781, -0.151821997432602, -0.25028100177204743, 0.1457395195025717, 0.776309709064163],
        [0.42836252552949206, -0.33718197585321724, 0.21548035377577868, -0.40507662797645944, 0.2014274832905996, -0.5433793884340921, 0.1224415250293831, 0.5393306791753718, 0.27416686032695486, 0.082632023074415, -0.7884658902824764, 0.352516410343092, -0.3215340918790108, 0.3063978302657008, -0.35842337232209986, 0.15918686812857288, -0.5066182271884826, 0.24318494071384883, -0.07990729625099985, -0.34223427859471983, 0.026389823884251817, -0.012190771423593136, -0.38440465561717074, 0.4422050016374801, 0.5004188286541862, -0.48797366693918576, -0.5257294178775168, 0.27044826965888685, 0.06374658128407093, -0.21055537254768195],
        [-0.07229172521248685, -0.012619021504288216, -0.10306990613044381, 0.5773822518003995, 0.06888051451486416, 0.43713082352039045, 0.5885415309525811, 0.15509576744315207, -0.0646716677963939, -0.4195382156489882, 0.0077740925641710396, 0.25114301460843375, 0.045871547106996174, -0.08119450771007011, 0.8255692518586322, -0.10746168444798904, -0.7233908867213177, -0.28733213848659256, -0.07042257148949574, -0.33736998430157605, -0.31615772012747434, 0.637471243102823, 0.3342620958158797, 0.10193483134353173, 0.22375768368727963, 0.25939635951333456, 0.2895429558698939, 0.0938692733504595, -0.35688342388508215, 0.33223137855053053],
        [-0.18699662934090575, -0.25626959260136895, 0.21645569641934304, -0.5729028966371135, -0.1757924340162676, -0.3096075782754243, 0.07831552044106763, 0.15162561197553526, -0.5420221467353463, -0.3045924843328466, 0.4368657815598125, -0.21463743674331837, -0.4578505782102571, -0.3066597950800175, 0.27053121874282693, 0.20836974921463403, 0.13800460199956427, 0.36587732428809083, 0.04237344159534795, 0.11961652698091832, 0.07333226939939147, 0.30418372479105804, 0.8086105436243229, -0.1881215194116193, 0.3288548599042146, 0.2429985863774975, -0.36775767269543636, -0.5799500101784082, -0.7581937239986651, -0.02363706621763853],
        [-0.18164178957187238, -0.3975578037882955, 0.9031749527859909, 0.06435313172171045, -0.18373217556008753, 0.12856849436939927, 0.03605582300233018, -0.22177090943159183, 0.46766398866629866, -0.45862241453424646, 0.6090704190704241, -0.16871814723754863, -0.05282949041805468, -0.23775525925864419, 0.1458537535172106, 0.3601499062837886, -0.3548351717298724, 0.11465124307727872, -0.7408734746734618, -0.17028472651884238, 0.016211503505893607, 0.08555954360280565, -0.19327077449197183, 0.3477159638225413, 0.1405951388246403, 0.6741091274493876, 0.18351925802796182, 0.28709379999081447, 0.09649713320812849, 0.1770619974289314],
        [-0.2959998782373478, -0.31893488942623544, 0.2884344740408862, 0.12777785918551032, -0.3298828917178556, -0.01296814707209483, -0.026207430454604275, -0.3195494668334498, -0.13831150022629682, -0.06202930628131616, 0.5038326313361795, 0.06812820721374047, -0.3883804678776764, 0.42117399995432425, 0.6719523175060682, -0.7829119058233104, -0.2545728223200528, 0.030432611272681168, 0.46105781013008984, 0.3455033529988476, 0.38043039410177476, 0.015592560744472711, -0.0782236623864884, 0.10723363542970979, -0.0785484717132918, -0.5242356949446266, -0.3076345938849563, -0.5447340695866476, 0.20827160167719058, -0.24714630791611464],
        [0.39091730874319836, -0.14301948453718222, -0.416573974498724, 0.21058636576321915, -0.042392695980575545, 0.9692299560410524, 0.18067532655955904, 0.07048923752150876, -0.25753083434238133, -0.02811434559196349, 0.4084048583145683, 0.25263554314386394, 0.24018893308181855, -0.45088121570201556, -0.37543681788595623, -0.21472728196743884, -0.20185399884279412, 0.6453208405376091, 0.25181311449736976, -0.34569454269251476, 0.376170751494547, -0.19323458373162783, -0.09873617008670921, -0.11693468261985994, -0.12211990315128496, -0.5205620314235212, -0.3819412010822847, -0.024201460578551548, -0.43322487076976357, 0.40659980395686357],
        [0.32490256897373954, 0.273641936177235, 0.6409145677667029, 0.010478884705160063, -0.13968486757812731, 0.36348706825807253, -0.47939360842532897, 0.5215045445963201, -0.08475159525065415, -0.38274255200218354, -0.24647385601789726, 0.09939948553816708, 0.24046412030140712, -0.05198426665156987, -0.050031793748498476, 0.01728344868408335, 0.6783139651058665, 0.22122649826282775, -0.15006430849891333, 0.4093345419333876, -0.3604899816439195, 0.527653545494235, 0.1341756137913044, 0.2921984039295986, -0.4290151283670982, -0.48997286041670407, 0.090580797885915, -0.14809464302004724, -0.007510073366799333, 0.21560238869439494],
        [0.20386338576133167, 0.49707514715466306, 0.3049937683144083, 0.5062407667254119, -0.9414667369063229, 0.013418269930532703, -0.5051597908533171, 0.3924810115481096, 0.19273242642462857, -0.2537293164221322, 0.48713589276149327, 0.4290184531975732, -0.6419506493670214, -0.2592152788761851, 0.0038551191121315442, -0.1300980835925416, -0.6166597563107101, -0.36683498615168486, -0.41225121218445687, 0.2231510516544806, 0.08715996651143887, -0.21546515642668754, -0.014515945995269355, -0.9197293583873759, -0.17423640730171053, 0.3751523690314758, 0.0875330631809718, -0.36273892066117197, -0.38622720112210185, -0.22233035439369653],
        [0.8140328127660865, 0.2446917807402485, 0.7860284456563504, 0.18734273423462533, 0.16666056758952214, 0.22948096689199932, -0.1792347287266782, -0.16358616668219433, -0.3989444091550533, 0.272957753954343, -0.08143602516667217, 0.049539361244016714, -0.02326210498902423, -0.1404812384357955, 0.11718385884214445, 0.112366644401973, -0.1595835299923443, -0.44416703842723465, 0.9084248633577152, 0.3743265373824697, 0.7640412871510154, 0.35743439721802656, 0.06527304586232732, 0.42585937544467023, 0.809885878410352, 0.4000640530709614, -0.26865180542075917, -0.17160132630425895, 0.5267642382760309, 0.02882298134604211],
        [0.339038897179861, 0.5061272784823421, 0.2722285063723555, -0.08024349582890891, 0.035515754410313086, 0.29566436303920507, -0.1984798774986795, -0.37025124191924835, -0.012655290497039076, -0.30838044519764707, -0.8855288593872315, -0.43679212531806566, -0.034416560576147615, -0.23338149640589623, 0.2532464780575538, -0.7065134108451461, -0.2794681789552189, -0.41001645838043077, -0.033598119177321834, 0.09514136754983767, -0.44522949863169964, -0.5680023381620815, -0.325754877478974, 0.43204808140388473, 0.13389718193679792, -0.22126061393205954, 0.044064658248676225, 0.06399776648419692, -0.0759510558039012, 0.29874829315486817],
    ])

    def __init__(self):
        rest_h = []
        rest_g = [self.CEC2017_C28_g1, self.CEC2017_C28_g2]
        super().__init__(ProblemType.CONSTRAINED, self.SUPERIOR, self.INFERIOR, rest_g, rest_h)

    def fitness(self, x: np.array) -> float:
        M = self.select_matrix(D)
        z = generate_z_y(x, self.o[:D], 'matrix_multiply', M)
        f_x = np.sum(np.abs(z)**0.5 + 2 * np.sin(z**3))
        return f_x
    
    @staticmethod
    def select_matrix(D):
        if D == 10:
            return CEC2017_C28.M10
        elif D == 30:
            return CEC2017_C28.M30
        else:
            raise ValueError("Dimensión no soportada")
    
    @staticmethod
    def CEC2017_C28_g1(x):
        M = CEC2017_C28.select_matrix(D)
        z = generate_z_y(x, CEC2017_C28.o[:D], 'matrix_multiply', M)
        return np.sum(-10 * np.exp(-0.2 * np.sqrt(z[:-1]**2 + z[1:]**2))) + (D - 1) * 10 / np.exp(-5)
    
    @staticmethod
    def CEC2017_C28_g2(x):
        M = CEC2017_C28.select_matrix(D)
        z = generate_z_y(x, CEC2017_C28.o[:D], 'matrix_multiply', M)
        return np.sum(np.sin(2 * z)**2) - 0.5 * D
